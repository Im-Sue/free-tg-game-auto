import{a as H,b as Y}from"./chunk-JVLSBRR5.js";import{a as v,b as K}from"./chunk-5IXTSGAM.js";import{b as g}from"./chunk-RC3QMLDN.js";import{b as I,c as D}from"./chunk-JINEVGIZ.js";import{b as N,c as U}from"./chunk-46NSFYB3.js";import{f as k,i as V}from"./chunk-FFQESTX4.js";import{b as _,c as ce,d as ae,e as le,f as z,g as ue,h as G}from"./chunk-KRHB66KZ.js";import{f as x}from"./chunk-4RHFH7IF.js";import{d as R}from"./chunk-LPTRVNVL.js";import{a as C}from"./chunk-5JJQQHKZ.js";import{a as xe,ab as re,hb as P,y as F}from"./chunk-ZPOCIBPN.js";import{a as oe,b as ge}from"./chunk-A7LNVEYU.js";import{f as ee,h as ke}from"./chunk-2YWUVAR3.js";import{Pa as we,Qa as q,Ra as te,Sa as w,_b as se,hb as ne,m as j,na as E,pb as L}from"./chunk-M54COW6Q.js";import{a as y}from"./chunk-CXUPEGDW.js";import{f as h,m as i,o as m}from"./chunk-ICCOEXX5.js";i();m();var Z=h(y()),$=h(F()),Ce=h(j());i();m();var B=h(y()),S=h(j()),d=h(F()),X=h(xe());i();m();var ie=h(y());function O(t,o,e){let n=ie.default.useRef({});return(!("value"in n.current)||e(n.current.condition,o))&&(n.current.value=t(),n.current.condition=o),n.current.value}ke();i();m();var fe=h(y()),Q=h(F());i();m();var J={},Me=async t=>{let o=(await import("./web3.min-OOB6NOJW.js")).default,e=new o(new o.providers.HttpProvider(t));return J[t]=e,e},me=async t=>J[t]?J[t]:Me(t);var M=(t="")=>{let o=(0,Q.useSelector)(x),{isRpcMode:e}=(0,Q.useSelector)(R),{rpcUrl:n}=o;return(0,fe.useCallback)(async()=>e?await me(t||n):{},[t,n,e])};ge();we();L();i();m();i();m();var pe=h(F());var de=h(y());var Be=t=>{let[o]=U(N.showNftAmount),e=V(t),n=v(),r=I(),s=D(r),a=(0,pe.useSelector)(P);return(0,de.useMemo)(()=>{let{walletAccountsWidthBalance:l}=K({walletAccounts:[e],showNftAmount:o,rpcData:null,selectedCurrency:s,assetsMap:n,hiddenSmallAsset:a});return l[0]},[e,o,s,n])},Se=Be;i();m();L();var Fe=6,he=(t,o=Fe)=>{if(!Number(t))return"0";let e=t?.toString();return(t.split(".")[1]||"")?.length>o?ne(e,o&&Number(o)):e},Ae=(t,o)=>{let{rpcUrl:e,chainId:n,account:r,existAccounts:s,isDeleted:a}=o;return Array.isArray(t)?t.filter(l=>{let c=!0;return n&&(c=c&&l.chainId===n),r&&(c=c&&l.account===r),Array.isArray(s)&&!!s?.length&&(c=c&&s?.includes(l.account)),a!==void 0&&(c=c&&(l.isDeleted||!1)===a),l.address||(c=c&&l.rpcUrl===e),c}):[]},We=(t,o={})=>{let{symbol:e,usdToThisRate:n,chainTokenPrice:r,chainTokenBalance:s}=o;return Array.isArray(t)?t.map(a=>{let l,c,{chainId:u,decimals:f}=a,A=e;a.address?(l=r?.[u]?.[a.address]||0,c=s?.[a.account]?.[u]?.[a.address]||0):(l=r?.[u]?.price||0,c=s?.[a.account]?.[u]?.balance||0),c=he(c&&te(c,10**f));let p=he(q(c,q(l,n)));return{price:l,balance:c,...a,moneySymbol:A,marketValue:p}}):[]};var b=(t,o,e=!0)=>{let{chainId:n,rpcUrl:r}=(0,d.useSelector)(x),s=(0,d.useSelector)(_),a=(0,d.useSelector)(ce),l=(0,d.useSelector)(ae),{symbol:c,usdToThisRate:u}=(0,d.useSelector)(re),f=H(),A=Y(void 0,E),p=(0,B.useMemo)(()=>Ae(s,{chainId:n,rpcUrl:r,existAccounts:A,account:e?f:void 0,isDeleted:o?void 0:!1}),[n,f,A,s]);return(0,B.useMemo)(()=>t?p:We(p,{symbol:c,usdToThisRate:u,chainTokenPrice:a,chainTokenBalance:l}),[c,p,u,a,l,t])},sn=(t,o)=>{let e=b(o);return(0,B.useMemo)(()=>e.find(n=>n.address===(t||void 0))||{},[t,e])};var Pe=t=>{let o=M(t);return C(async e=>{let n=await o(),r=new n.eth.Contract(X.default,e),s=await r.methods.symbol().call(),a=await r.methods.decimals().call();return{name:await r.methods.name().call(),symbol:s,decimals:a}},[o])},Re=()=>{let t=M(),o=g();return C(async(e,n,r)=>{let s,a=r||await t(),l=n||o;return e?s=await new a.eth.Contract(X.default,e).methods.balanceOf(l).call():s=await a.eth.getBalance(l,"latest"),s},[t,o])},Ie=()=>C(async(t,o)=>{let e=o;typeof o=="string"&&(e=[o]);try{let{data:n}=await ee(oe.getCoinPrice,{tokenAddresses:e,chainId:typeof t=="string"?Number.parseInt(t,16):t});return n}catch{return[]}},[]),rn=()=>{let t=M(),o=(0,d.useDispatch)();return C(async({chainId:e,injectWeb3:n,wallets:r=[]})=>{let s=n||await t(),a=new s.BatchRequest;r.forEach(l=>{a.add(s.eth.getBalance.request(l,"latest",(c,u)=>{c||o(G({chainId:e,balance:u,account:l}))}))}),a.execute()})},De=()=>{let t=(0,d.useDispatch)(),o=g(),e=Ie(),n=Re();return C(async({chainId:r,address:s,injectAccount:a,injectWeb3:l})=>{let[c,u]=await Promise.all([e(r,s),n(s,a,l)]);return c?.length&&t(ue({chainId:r,price:c[0].price})),t(G({chainId:r,balance:u,address:s,account:a||o})),!0},[n,o])},cn=()=>{let t=g(),{chainId:o}=(0,d.useSelector)(x),e=b(!0,!1,!1);return O(()=>({chainId:o,chainTokens:e}),{chainId:o,account:t,needPollChainTokens:e},(n,r)=>!(0,S.isEqual)(n,r))},Ne=18,Ue=()=>{let t=(0,d.useDispatch)(),o=(0,d.useSelector)(_),e=g();return C((n,r,s)=>{if(!n&&!e&&!s?.account)return!1;let{rpcUrl:a}=s,l=o.find(u=>{let f=u.chainId===n&&u.address===r&&u.account===(s?.account||e);return r||(f=f&&u.rpcUrl===a),f});if(l){if(l.isDeleted===!0){let u={...l,...s,chainId:n,address:r,isDeleted:!1};return t(z(u)),!0}return!1}let c={chainId:n,address:r,isDeleted:!1,account:e,decimals:Ne};return s&&typeof s=="object"&&Object.assign(c,s),t(le(c)),!0},[o,e])},an=t=>{let o=M(t),e=Ue(),n=Pe(t),r=De();return async(s,a)=>{let l=await n(a);if(e(s,a,l)){let u=await o();await r(s,a,u)}}},ve=(t={})=>{let o=k(t);return O(()=>o.reduce((e,n)=>{if(n.keyringIdentityType===se.MNEMONIC)e.push(n);else{let r=n.walletIdentities.filter(s=>Boolean(s.account[E]));r.length&&e.push({...n,walletIdentities:r})}return e},[]),o,(e,n)=>!(0,S.isEqual)(e,n))},ln=(t={})=>{let o=ve(t),e=b(!1,!1,!1);return(0,B.useMemo)(()=>{let n=(0,S.groupBy)(e||[],"account");return o?.map(r=>{let s="",a=r.walletIdentities?.map(c=>{let u=c?.account?.[E],{balance:f,symbol:A}=n[u]?.filter(({address:p})=>!p)[0]||{};return s=A,{...c,balance:f,symbol:A}}),l=a.reduce((c,u)=>w(c,u.balance),0);return{...r,marketValue:l,marketValueSymbol:s,walletIdentities:a}})||[]},[e,o])},un=()=>{let t=(0,d.useDispatch)(),o=b(!0,!1,!1);return e=>{o?.filter(({chainId:n,rpcUrl:r,address:s})=>!s&&n===e.chainId&&r===e.rpcUrl)?.forEach(({chainId:n,account:r})=>{t(z({chainId:n,account:r,...e}))})}};L();var Ke=t=>{let o=k(t),[e]=U(N.showNftAmount),n=I(),r=D(n),{isRpcMode:s}=(0,$.useSelector)(R),a=b(!1,!1,!1),l=(0,Ce.groupBy)(a||[],"account"),c=(0,$.useSelector)(P),u=v(),f=(0,Z.useMemo)(()=>o.map(p=>{let{walletIdentities:W}=p,{walletAccountsWidthBalance:Te,walletAsset:be,platformAsset:ye}=K({walletAccounts:W,showNftAmount:e,rpcData:s?{chainTokensAccountMap:l}:null,selectedCurrency:r,assetsMap:u,hiddenSmallAsset:c});return{...p,walletAsset:be,platformAsset:ye,walletIdentities:Te}}),[o,e,l,s,r,u]);return[(0,Z.useMemo)(()=>f?.reduce((p,W)=>({walletAsset:w(p.walletAsset,W.walletAsset==="--"?"0":W.walletAsset),platformAsset:w(p.platformAsset,W.platformAsset==="--"?"0":W.platformAsset),rpcModeCoinSymbol:p.rpcModeCoinSymbol||W?.rpcModeCoinSymbol}),{walletAsset:"0",platformAsset:"0",rpcModeCoinSymbol:""}),[f]),f]},Ee=Ke;export{Se as a,O as b,Me as c,me as d,M as e,b as f,sn as g,Pe as h,Re as i,Ie as j,rn as k,De as l,cn as m,Ue as n,an as o,ve as p,ln as q,un as r,Ee as s};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-6GFVKSAR.js.map
