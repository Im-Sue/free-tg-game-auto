import{a as Jt}from"./chunk-ADIQBHVU.js";import{e as bt}from"./chunk-UIABO6UG.js";import"./chunk-KJFAD5C4.js";import"./chunk-BFVA6OLJ.js";import{a as Rt}from"./chunk-RC3QMLDN.js";import"./chunk-JINEVGIZ.js";import"./chunk-SRU2IM3A.js";import"./chunk-46NSFYB3.js";import"./chunk-FFQESTX4.js";import{a as R}from"./chunk-OCZAVPFZ.js";import"./chunk-P6SDUFQ6.js";import"./chunk-5TNZ4MQV.js";import"./chunk-R7VTXTCL.js";import"./chunk-LBYCQPAD.js";import{c as Lt}from"./chunk-R2QKPEWB.js";import"./chunk-LF2PURXZ.js";import"./chunk-JEZIPKDY.js";import{g as xt}from"./chunk-SR2BDP3A.js";import"./chunk-CFT6B56M.js";import"./chunk-WK32FAZW.js";import"./chunk-WMUTUJYX.js";import"./chunk-B23OWGFX.js";import"./chunk-OSWXWF4A.js";import"./chunk-Q7FJER56.js";import"./chunk-RBTIRMSE.js";import"./chunk-7GZ2ZCGI.js";import"./chunk-WTP3OIOS.js";import"./chunk-D66ZH3O3.js";import"./chunk-HISWVX7W.js";import{a as Kt}from"./chunk-PYJPOVV7.js";import{b as Et}from"./chunk-AO6MUSOH.js";import{a as gt}from"./chunk-I435LZHT.js";import{t as ft,x as T}from"./chunk-SJIW4WAV.js";import"./chunk-SLDECH2O.js";import"./chunk-5JJQQHKZ.js";import"./chunk-URG4MCPH.js";import{Pa as Qt,ab as jt,y as Wt}from"./chunk-ZPOCIBPN.js";import"./chunk-CA5MYYD6.js";import"./chunk-RZ7GFYMN.js";import{a as Ie}from"./chunk-IOCZ22XI.js";import"./chunk-EJY3MW2I.js";import"./chunk-3VRAVMMN.js";import"./chunk-YJ45QIWT.js";import"./chunk-WR62TYUO.js";import{d as Gt,f as he}from"./chunk-2G2AXMFT.js";import"./chunk-XGFQCNHX.js";import"./chunk-JLA5HXVC.js";import"./chunk-I4WIGQLD.js";import"./chunk-ZNGQ6IUR.js";import"./chunk-JERFAOJH.js";import"./chunk-JXZFOFB5.js";import{a as yt}from"./chunk-LYNLETTP.js";import"./chunk-FQ4XEVKF.js";import{c as E}from"./chunk-VMYDP774.js";import{a as pt,b as Ae}from"./chunk-A7LNVEYU.js";import{f as ut,h as Ne}from"./chunk-2YWUVAR3.js";import"./chunk-VA2HGDZT.js";import"./chunk-AKPDCNMH.js";import{Qa as Bt,Ra as Zt,S as J,Sa as dt,jb as qt,la as Ut,pb as Vt}from"./chunk-M54COW6Q.js";import"./chunk-PWWHYQAY.js";import{B as wt,G as Dt,M as Q,b as St,e as kt,o as G,r as Mt,y as Z}from"./chunk-RIJWHGTU.js";import{I as Y,u as It,v as t}from"./chunk-K4MPEKC5.js";import"./chunk-X6USBUO5.js";import"./chunk-674MHQJQ.js";import{L as W,R as _t,X as f,c as Ct}from"./chunk-XIGC6FD5.js";import{a as k}from"./chunk-CXUPEGDW.js";import"./chunk-363VDWOO.js";import"./chunk-7B5WANGL.js";import"./chunk-4P4FGPYZ.js";import"./chunk-YGNOWOE7.js";import"./chunk-RYJHESAH.js";import"./chunk-DOQ5NSSP.js";import"./chunk-VULQOB2N.js";import{f as g,m as o,o as n}from"./chunk-ICCOEXX5.js";o();n();var nt=g(k()),pe=g(Ie());Y();Ut();var fe=g(Ct());o();n();var Pt={container:"_container_8wg37_1",headerIcon:"_headerIcon_8wg37_8"};o();n();var r=g(k());Y();Vt();var ue=g(Wt());o();n();var y=g(k());Y();o();n();var v=g(k());Y();o();n();var w={nftContain:"_nftContain_19spt_1",detail:"_detail_19spt_4",detailLeft:"_detailLeft_19spt_12",img:"_img_19spt_22",tokenAltImg:"_tokenAltImg_19spt_33",altImgFont:"_altImgFont_19spt_44",content:"_content_19spt_51",badge:"_badge_19spt_55",currency:"_currency_19spt_63"};var te=({item:e,getUSDtoCurrency:l})=>{let d=yt(),i=e.protocolType===1,s=i?`${ft(e.tokenAmount)} ${e.tokenSymbol}`:e.collectionName,_=()=>{let p={fontSize:"16px",lineHeight:"20px"};return i?(e.tokenSymbol.length>4&&(p={fontSize:"12px",lineHeight:"16px"}),v.default.createElement("div",{className:w.tokenAltImg},v.default.createElement("div",{className:w.altImgFont,style:p},e.tokenSymbol))):v.default.createElement("div",{className:w.img},v.default.createElement("img",{src:`${d}/cdn/assets/imgs/241/C82F2BF8460AC236.png`,alt:"nft-img"}))};return v.default.createElement("div",{className:w.nftContain},v.default.createElement("div",{className:w.detail},v.default.createElement("div",{className:w.detailLeft},e.logo?v.default.createElement("div",{className:w.img},v.default.createElement("img",{src:e.logo,alt:"nft-img"})):_(),v.default.createElement(E.FlexBox,{direction:E.DIRECTION.vertical,className:w.content},v.default.createElement(T.Text,{ellipsis:{tooltip:!0},style:{flex:1}},s),e.protocolName&&v.default.createElement(kt,{type:kt.TYPE.rect,className:w.badge},e.protocolName))),v.default.createElement(T.Text,{size:T.SIZE.xs,className:w.currency},e.usdAmount?l(e.usdAmount):t("extension_defi_card_text_unknown_value")),v.default.createElement("div",null)))};o();n();var L={detailDialog:"_detailDialog_10fh7_1",container:"_container_10fh7_4",footer:"_footer_10fh7_9",alertIcon:"_alertIcon_10fh7_18",loading:"_loading_10fh7_25",error:"_error_10fh7_29",empty:"_empty_10fh7_33",unknown:"_unknown_10fh7_37"};var ee=({visible:e,closeCallback:l,detail:d,detailLoading:i,getUSDtoCurrency:s,detailUTXO:_,fetchDetail:p})=>{let{protocolAssetList:b,assetUnknown:c=[]}=d,D=c.join(t("extension_wallet_text_punctuation_mark"));return y.default.createElement(G.Action,{onClose:()=>{l()},visible:e,maskClosable:!0,noTopRadius:!1,windowClass:L.detailDialog,alignBottom:!0},i&&y.default.createElement("div",{className:L.loading},y.default.createElement(_t.Circle,null)),!i&&b&&y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:L.container},c.length>0&&y.default.createElement("div",{className:L.unknown},y.default.createElement(St,{desc:t("extension_defi_popup_alert_utxo_not_decode_yet",{asset:D}),type:St.TYPE.warn,closable:!1})),b.length>0?b.map(C=>y.default.createElement(y.default.Fragment,null,y.default.createElement(te,{getUSDtoCurrency:s,key:C.protocolId,item:C}))):y.default.createElement(Z.State,{type:c.length>0?Z.State.TYPE.noRecord:Z.State.TYPE.noResult,title:c.length>0?t("extension_defi_popup_emptystate_btn_nodata"):t("extension_defi_toast_error_no_inscriptions"),className:L.empty})),b.length>0&&y.default.createElement("div",{className:L.footer},y.default.createElement(Et,{size:Et.SIZE.xs,className:`okds-information-circle-fill ${L.alertIcon}`}),y.default.createElement("div",null,t("extension_defi_bot_tips_show_300_assets")))),!i&&!b&&y.default.createElement("div",{className:L.container},y.default.createElement(Z.State,{type:Z.State.TYPE.noNetwork,className:L.error,title:t("extension_defi_popup_emptystate_title_data_loading_fail"),buttonText:t("extension_defi_popup_emptystate_btn_reload"),onButtonClick:()=>{p(_.txHash,_.vout,_.status)}})))};o();n();Y();var Ce=({isUnSpend:e=!1,onConfirm:l=()=>{}})=>async()=>{if(e){let i=G.warn({alignBottom:!1,title:t("wallet_extension_footer_btn_unfreeze"),text:t("wallet_extension_bot_text_confirm_unoccupy"),cancelText:t("wallet_extension_bot_btn_reconsider"),confirmText:t("wallet_extension_btn_general_confirm"),onCancel:()=>{i.destroy()},onConfirm:async()=>{await l()}})}else await l()},oe=Ce;o();n();var S={main:"_main_15b0d_1",scrollArea:"_scrollArea_15b0d_8",item:"_item_15b0d_12",select:"_select_15b0d_16",content:"_content_15b0d_20",itemTitle:"_itemTitle_15b0d_23",itemSubTitle:"_itemSubTitle_15b0d_30",circle:"_circle_15b0d_36",checkIcon:"_checkIcon_15b0d_37",empty:"_empty_15b0d_52",loading:"_loading_15b0d_55",nftPortal:"_nftPortal_15b0d_60",internalPortal:"_internalPortal_15b0d_64"};o();n();he();Ne();Ae();var re=g(Wt());Ut();var Ot=g(k()),ne={utxoList:[],totalUtxoNum:0,canTransferAmount:0};function Se(e){let d=R().get("coinId"),i=bt(d||J,{withPrice:!0,withPriceChangePercent24h:!1}),s=Rt(i?.localType),_=(0,re.useSelector)(Qt),b=xt()[e],c=e?b:s,D=(0,Ot.useCallback)(async()=>{let I={coinId:i?.coinId,utxoRequests:[{address:c,utxoType:12}]};try{let{data:N}=await ut(pt.getBTCUTXO,I);return N.length===1?N[0]:ne}catch{return ne}},[c,i]),C=(0,Ot.useCallback)(async(I,N,U)=>{let A=i?.chainId;if(!A&&A!==0)return{};let P={txHash:I,address:c,status:U,vout:N,chainId:A};try{let{data:M}=await ut(pt.getUTXOAsset,P);return M}catch{return{}}},[i]);return{fetchUTXO:D,fetchUTXOAsset:C,manageUTXO:async({utxoList:I=[],spentStatus:N})=>{let U=i?.chainId,A=await Gt().getRequestHeaders({walletId:_,needSign:!0,currency:"usd"}),P={address:c,spentStatus:N,chainId:U};I&&(P.utxoList=I);try{return await ut(pt.manageUTXO,P,{headers:A})}catch{return{}}}}}var Tt=Se;o();n();var zt=g(k()),ie=g(Ct());o();n();var Ft={root:"_root_15vei_1",item:"_item_15vei_6",more:"_more_15vei_14",arrow:"_arrow_15vei_22"};function ke({onClick:e}){return zt.default.createElement("div",{className:Ft.root,onClick:e},zt.default.createElement(W,{className:(0,ie.default)("okx-wallet-plugin-arrow-small-right",Ft.arrow)}))}var se=ke;o();n();o();n();var x=g(k());Ut();var ae=(e,l)=>{let i=R().get("coinId"),s=bt(i||J,{withPrice:!0,withPriceChangePercent24h:!1}),[_,p]=(0,x.useState)({address:"",canTransferAmount:"",utxoList:[],totalUtxoNum:0}),[b,c]=(0,x.useState)(!0),[D,C]=(0,x.useState)({}),[j,I]=(0,x.useState)(!1),{fetchUTXO:N,fetchUTXOAsset:U}=Tt(l),A=(0,x.useCallback)(async()=>{c(!0);let m=await N();return c(!1),m},[N]),P=(0,x.useCallback)(async()=>{if(!s?.coinId&&s?.coinId!==0)return;let m=await A();p(m)},[A]),M=(0,x.useCallback)(async(m,F,B)=>{I(!0);let z=await U(m,F,B);C(z),I(!1)},[U]),O=(0,x.useMemo)(()=>(_?.utxoList||[]).filter(m=>m.utxoStatusType===e),[_,e]),ht=(0,x.useMemo)(()=>O.reduce((m,F)=>m+F.coinAmount,0),[O]),st=(0,x.useMemo)(()=>O.every(m=>m.select),[O]),Nt=(0,x.useMemo)(()=>O.filter(m=>m.select),[O]),at=m=>{let F=(_?.utxoList||[]).map(B=>B.utxoStatusType===e?{...B,select:m}:{...B});p({..._,utxoList:F})},lt=({txHash:m,vout:F})=>{let B=(_?.utxoList||[]).map(z=>z.txHash===m&&z.vout===F?{...z,select:!z.select}:z);p({..._,utxoList:B})};return(0,x.useEffect)(()=>{(async()=>await P())()},[s?.coinId]),{utxoData:_,activeList:O,activeAmount:ht,loading:b,selectList:Nt,isSelectAll:st,selectUtxo:lt,handleSelectAll:at,fetchAndSetData:P,detail:D,fetchDetail:M,detailLoading:j,coin:s}};o();n();var et=g(k());Y();o();n();var tt={header:"_header_y50y8_1",title:"_title_y50y8_11",amount:"_amount_y50y8_14",unfreeze:"_unfreeze_y50y8_21",text:"_text_y50y8_26",divider:"_divider_y50y8_29",icon:"_icon_y50y8_32",currency:"_currency_y50y8_36",background:"_background_y50y8_43"};var le=({amount:e="",currencyAmount:l="",symbol:d="",activeTab:i})=>{let s=yt();return et.default.createElement("div",{className:tt.header},et.default.createElement("img",{alt:"UTXO",src:`${s}/cdn/assets/imgs/241/46CBAC7179F5F752.png`,className:tt.background}),et.default.createElement(T.Text,{className:tt.title,size:T.SIZE.sm},i===1?t("wallet_extension_card_input_total_amount"):t("wallet_extension_card_input_total_unavailable")),et.default.createElement("div",{className:tt.amount},`${e} ${d}`),et.default.createElement("div",{className:tt.currency},l))};o();n();var h=g(k());Y();Vt();var Xt=g(Ct());o();n();var $={footerContain:"_footerContain_19y6a_1",footer:"_footer_19y6a_1",tip:"_tip_19y6a_8",footerIcon:"_footerIcon_19y6a_15",leftBtn:"_leftBtn_19y6a_22",rightBtn:"_rightBtn_19y6a_25"};var me=({selectList:e=[],handleConfirm:l,handleSelectAll:d,divDecimal:i,activeTab:s,isSelectAll:_,utxoData:p,symbol:b})=>{let c=e.length,D=p?.utxoList?.length===0,C=p?.totalUtxoNum,j=(0,h.useMemo)(()=>e.reduce((U,A)=>dt(U,A.coinAmount),0),[e]),I=(0,h.useMemo)(()=>s===1?c===0?t("wallet_extension_footer_btn_frozen"):t("wallet_extension_footer_btn_frozen_value",{value:c}):c===0?t("wallet_extension_footer_btn_unfreeze"):t("wallet_extension_footer_btn_unfreeze_value",{value:c}),[s,c]),N=()=>s===2&&c!==0?h.default.createElement("div",{className:$.tip},h.default.createElement(W,{className:(0,Xt.default)("okds-information-circle-fill",$.footerIcon)}),h.default.createElement("div",null,t("extension_investutxo_bot_textarea_desc_potential_risk",{extension_investutxo_bot_textarea_desc_potential_risk:c,numToken:`${i(j)} ${b}`}))):C>300?h.default.createElement("div",{className:$.tip},h.default.createElement(W,{className:(0,Xt.default)("okds-information-circle-fill",$.footerIcon)}),h.default.createElement("div",null,C<=1e3?t("extension_defi_bot_tips_300_utxo_variable_unlock",{num:C}):t("extension_defi_bot_tips_300_utxo_unlock"))):null;return h.default.createElement(gt.FooterActions,{className:$.footerContain},h.default.createElement("div",{className:$.footer},N(),h.default.createElement(E.FlexBox,null,h.default.createElement(f,{category:f.CATEGORY.outline,type:f.TYPE.secondary,size:f.SIZE.lg,disabled:D,onClick:()=>{d(!_)},className:$.leftBtn},_?t("extension_defi_mid_btn_cancel"):t("extension_investutxo_bot_btn_select_all")),h.default.createElement(f,{size:f.SIZE.lg,type:f.TYPE.highlight,category:f.CATEGORY.fill,disabled:c===0,onClick:l,className:$.rightBtn},I))))};o();n();Y();var H=g(k());o();n();var vt={main:"_main_100s5_1",header:"_header_100s5_5",banner:"_banner_100s5_9",subContent:"_subContent_100s5_16"};var ce=({visible:e,close:l,token:d})=>{let i=H.default.createElement("div",{className:vt.main},H.default.createElement(T.Text,{strong:700,className:vt.header},t("extension_defi_toast_title_manage_utxos")),H.default.createElement(T.Text,{className:vt.subContent},t("extension_defi_toast_text_utxo_usage",{token:d})),H.default.createElement(gt.FooterActions,{style:{backgroundColor:"var(--okd-dialog-window-background)"},affixStyle:{position:"absolute",bottom:0,left:0}},H.default.createElement(f,{block:!0,type:f.TYPE.highlight,size:f.SIZE.lg,onClick:()=>{l()}},t("wallet_extension_btn_general_gotit"))));return H.default.createElement(G.Action,{onClose:()=>{l()},visible:e,title:H.default.createElement(H.default.Fragment,null),alignBottom:!0,maskClosable:!0,topStyle:{border:"none",padding:"12px"},windowStyle:{overflow:"hidden"},noTopRadius:!1,renderContent:()=>i})};o();n();var it=g(k());Y();o();n();var rt={btnWrapper:"_btnWrapper_14mei_1",confirmBtn:"_confirmBtn_14mei_5",tipContent:"_tipContent_14mei_8",closeBtn:"_closeBtn_14mei_11"};var _e=({tipData:e,handleConfirm:l,symbol:d})=>it.default.createElement(G.Tip,{visible:e.visible,titleCenter:!0,title:t("extension_investutxo_mid_text_successfully_unlock"),closeClassName:rt.closeBtn,renderFooter:()=>it.default.createElement("div",{className:rt.btnWrapper},it.default.createElement(f,{size:f.SIZE.lg,type:f.TYPE.highlight,category:f.CATEGORY.fill,onClick:l,className:rt.confirmBtn},t("extension_defi_modal_btn_ok")))},it.default.createElement(T.Text,{type:T.TYPE.secondary,size:T.SIZE.sm,className:rt.tipContent,align:T.ALIGN.center},t("extension_investutxo_mid_textarea_released_and_get_token",{num:e.valuelessNftNum,num1:e?.freedBtcAmount,symbol:d})));var de=({baseCoin:e,addressType:l})=>{let[d,i]=(0,r.useState)(!1),[s,_]=(0,r.useState)(2),[p,b]=r.default.useState({visible:!1,valuelessNftNum:0,freedBtcAmount:""}),[c,D]=r.default.useState(!1),[C,j]=r.default.useState({txHash:"",vout:0,status:0}),{utxoData:I,loading:N,fetchAndSetData:U,selectList:A,isSelectAll:P,selectUtxo:M,handleSelectAll:O,detail:ht,fetchDetail:st,detailLoading:Nt,activeList:at,activeAmount:lt,coin:m}=ae(s,l);(0,r.useEffect)(()=>{It.get("manageUTXOAlert")||!m?.symbol||(D(!0),It.set("manageUTXOAlert",!0))},[m]);let{manageUTXO:F}=Tt(l),B=(0,ue.useSelector)(jt),z=s===2,ye=a=>{j({txHash:a.txHash,vout:a.vout,status:a.status}),st(a.txHash,a.vout,a.status),i(!0)},Yt=a=>{let X=m?.decimals||8;return Zt(a,10**X)},mt=a=>{let X=Yt(a);return ft(X)},ge=oe({isUnSpend:z,onConfirm:async()=>{let X={utxoList:A.map(({txHash:V,vout:At,coinAmount:ve})=>({txHash:V,vout:At,coinAmount:ve})),spentStatus:s===1?0:1},{code:K,msg:ct}=await F(X);await U();let Ht=A.reduce((V,At)=>dt(V,At.coinAmount),0);if(K===0){let V=s===1?"extension_defi_mid_toast_frozen_success":"extension_defi_mid_toast_unfreeze_successful";Dt.success({title:t(V,{value:mt(Ht),token:e.symbol})})}else{let V=s===1?"wallet_extension_top_toast_frozen_failed":"wallet_extension_top_toast_unfreeze_failed";Dt.error({title:ct||t(V)})}}}),xe=async a=>{_(a)},$t=a=>{let X=Yt(a),K=m?.currencyPrice||0,ct=m?.currencySymbol||"$";return Lt(Bt(qt(X),K),{symbol:ct,isFixedUp:!0})},be=a=>{let X=B?.symbol||"$",K=B?.usdToThisRate||1;return Lt(Bt(a,K),{symbol:X,isFixedUp:!0})},Te=()=>N?r.default.createElement("div",{className:S.scrollArea},r.default.createElement("div",{className:S.loading},r.default.createElement(_t.Circle,null))):at.length===0?r.default.createElement(Z.State,{className:S.empty,title:s===2?t("wallet_extension_mid_text_utxo_available"):t("wallet_extension_mid_text_noutxo_now")}):r.default.createElement("div",{className:S.scrollArea},r.default.createElement(le,{amount:mt(lt),currencyAmount:$t(lt),symbol:e.symbol,activeTab:s}),r.default.createElement("div",{className:S.list},(at||[]).map(a=>r.default.createElement(E.FlexBox,{className:S.item,align:E.ALIGN.center,key:`${a.txHash}${a.vout}`},r.default.createElement("div",{className:S.select,onClick:()=>M(a)},r.default.createElement(Mt.Circle,{checked:a.select})),r.default.createElement(E.FlexBox,{className:S.content,direction:E.DIRECTION.vertical},r.default.createElement("div",{className:S.itemTitle},`${mt(a.coinAmount)} ${e.symbol}`),r.default.createElement("div",{className:S.itemSubTitle},$t(a.coinAmount))),r.default.createElement(se,{onClick:()=>ye(a)})))));return r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:S.main},r.default.createElement(Q,{activeId:s,style:{height:"auto"},size:Q.SIZE.sm,category:Q.CATEGORY.outline,hideContent:!0,type:Q.NEW_TYPE.highlight,onChange:xe},r.default.createElement(Q.TabPane,{tab:t("wallet_extension_top_tab_unavailable"),id:2}),r.default.createElement(Q.TabPane,{tab:t("wallet_extension_top_tab_available"),id:1})),Te()),r.default.createElement(me,{selectList:A,utxoData:I,activeTab:s,handleConfirm:ge,divDecimal:mt,handleSelectAll:O,isSelectAll:P,symbol:e.symbol}),r.default.createElement(ee,{visible:d,closeCallback:i,detail:ht,getUSDtoCurrency:be,detailLoading:Nt,detailUTXO:C,fetchDetail:st}),r.default.createElement(ce,{visible:c,close:()=>D(!1),token:m?.symbol}),r.default.createElement(_e,{tipData:p,handleConfirm:()=>b({...p,visible:!1}),symbol:e.symbol}))};var we=()=>{let e=(0,pe.useHistory)(),l=R(),d=l.get("addressType"),i=l.get("coinId"),_=xt()[d],{baseCoin:p={}}=Jt(i||J,!0),b=()=>{e.go(-1)};return nt.default.createElement("div",{className:Pt.container},nt.default.createElement(Kt,{title:t("wallet_extension_header_title_manage_utxo"),onBack:b,closeable:!1},nt.default.createElement(wt,{placement:wt.DIRECTION.bottom,title:p.symbol?t("extension_defi_popup_tooltips_text_utxo_usage",{token:p.symbol}):""},nt.default.createElement(W,{className:(0,fe.default)("okds-information-circle",Pt.headerIcon)}))),nt.default.createElement(de,{addressType:d,baseCoin:p,looker:_,coinId:i}))},Hr=we;export{Hr as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=ManageUtxo-GF7NRQRZ.js.map
