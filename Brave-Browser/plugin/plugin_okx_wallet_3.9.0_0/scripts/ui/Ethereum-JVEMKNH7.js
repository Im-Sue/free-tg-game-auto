import{a as _e,b as Ie,c as S,d as Ee,e as ge}from"./chunk-WUTQBPLS.js";import{h as Pe}from"./chunk-BJANYOX5.js";import"./chunk-UYALNF4Q.js";import"./chunk-JPV5PNQX.js";import{a as xe}from"./chunk-TQIDOAVN.js";import{a as Ce}from"./chunk-BOWCSZLW.js";import"./chunk-4FZQLD6G.js";import"./chunk-LHVA7Q62.js";import"./chunk-LHNVUV3G.js";import{b as ue}from"./chunk-NR5M2562.js";import"./chunk-FSXW45U6.js";import"./chunk-6UR6D26Y.js";import"./chunk-DQUBHXFU.js";import"./chunk-PCZ7TQOH.js";import"./chunk-OXTQMA4W.js";import"./chunk-RMPNHDVC.js";import"./chunk-YWELIV7Q.js";import{j as Te}from"./chunk-53Z372L4.js";import"./chunk-EHDEZCO2.js";import"./chunk-TFCBP6UV.js";import{d as fe,f as it}from"./chunk-FORV77D5.js";import{a as le}from"./chunk-5NV3TIKF.js";import"./chunk-DCMAUS7C.js";import"./chunk-QIJYKINJ.js";import{a as B}from"./chunk-D4V7ONZY.js";import{a as ae,b as se,d as ie}from"./chunk-3QCQMWWZ.js";import"./chunk-TQEP4B6B.js";import"./chunk-E6PQQLEO.js";import"./chunk-R7R6LTH6.js";import"./chunk-TAZU4KSU.js";import"./chunk-W327NRHO.js";import"./chunk-DZDHGH5B.js";import{c as ne}from"./chunk-UKFSUXAE.js";import"./chunk-U3CLRNWK.js";import"./chunk-M4STRGDO.js";import"./chunk-GYUX3JJ3.js";import{a as de}from"./chunk-H43TVLNI.js";import"./chunk-SG4LXTVB.js";import"./chunk-M4JNKF23.js";import"./chunk-3EYFKVOU.js";import"./chunk-QUUI62AZ.js";import{a as me}from"./chunk-SIKYZQW4.js";import"./chunk-MCRNCTJS.js";import{d as st,e as ce,g as pe}from"./chunk-YZAK46Y6.js";import"./chunk-VX7CI7XT.js";import"./chunk-D6HSNWGS.js";import{a as ee,e as L}from"./chunk-7ODXCTBK.js";import"./chunk-GZMWLE4V.js";import{b as at}from"./chunk-C54I6GL3.js";import"./chunk-ZJICRI36.js";import"./chunk-BIBDTDJA.js";import"./chunk-ADIQBHVU.js";import"./chunk-TPVT7ZCY.js";import"./chunk-A6HNAUBV.js";import"./chunk-6GFVKSAR.js";import"./chunk-JVLSBRR5.js";import"./chunk-5IXTSGAM.js";import"./chunk-OR2KMY5L.js";import"./chunk-FFJ36R7T.js";import{a as Ct}from"./chunk-NVCWAHOV.js";import"./chunk-RFEJLMRV.js";import{g as te}from"./chunk-UIABO6UG.js";import"./chunk-KJFAD5C4.js";import"./chunk-BFVA6OLJ.js";import"./chunk-ON3J2WQV.js";import"./chunk-RC3QMLDN.js";import"./chunk-JINEVGIZ.js";import"./chunk-SRU2IM3A.js";import"./chunk-46NSFYB3.js";import{m as rt}from"./chunk-FFQESTX4.js";import"./chunk-OCZAVPFZ.js";import"./chunk-P6SDUFQ6.js";import"./chunk-5TNZ4MQV.js";import"./chunk-6YBNTFOQ.js";import"./chunk-XGXABYQN.js";import"./chunk-KKTPGZSO.js";import"./chunk-ESKOSV75.js";import"./chunk-ZDQ5EBGN.js";import"./chunk-2KEW2T4M.js";import"./chunk-R7VTXTCL.js";import"./chunk-LBYCQPAD.js";import{a as Kt}from"./chunk-7O3XK67L.js";import"./chunk-OMKW26U3.js";import"./chunk-3P5YDD2R.js";import{l as Mt}from"./chunk-KZR43RPO.js";import"./chunk-CWTKVHHS.js";import"./chunk-PRHPRTXY.js";import{b as Xt}from"./chunk-IGCT3RWS.js";import"./chunk-SQ5W4RLM.js";import"./chunk-I27PVEIN.js";import"./chunk-Y2PED5BF.js";import{e as qt,g as Qt,m as Jt}from"./chunk-RUSRHRGO.js";import"./chunk-IZ5XPPXG.js";import"./chunk-6PN4BR3D.js";import"./chunk-EWK7ZFVN.js";import{a as Yt,b as Vt}from"./chunk-A23SHFFL.js";import"./chunk-VZ3BFZKL.js";import"./chunk-T6Z2C3RK.js";import"./chunk-R2QYIBE7.js";import"./chunk-KT53NMHD.js";import"./chunk-64STH2HN.js";import{h as nt,j as oe,k as re,p as Tt}from"./chunk-EKQH7XTV.js";import"./chunk-R2QKPEWB.js";import"./chunk-RMA2FZOE.js";import"./chunk-KRHB66KZ.js";import"./chunk-4RHFH7IF.js";import"./chunk-LPTRVNVL.js";import"./chunk-PH2A2GR3.js";import"./chunk-2LLM6N6U.js";import"./chunk-LF2PURXZ.js";import"./chunk-JEZIPKDY.js";import{a as ot}from"./chunk-SR2BDP3A.js";import{f as $t}from"./chunk-CFT6B56M.js";import"./chunk-WK32FAZW.js";import"./chunk-WMUTUJYX.js";import"./chunk-B23OWGFX.js";import"./chunk-OSWXWF4A.js";import"./chunk-Q7FJER56.js";import"./chunk-RBTIRMSE.js";import"./chunk-7GZ2ZCGI.js";import{C as Rt}from"./chunk-WTP3OIOS.js";import"./chunk-D66ZH3O3.js";import"./chunk-X764QIVO.js";import"./chunk-HISWVX7W.js";import{a as Zt}from"./chunk-PYJPOVV7.js";import"./chunk-AO6MUSOH.js";import{a as zt}from"./chunk-I435LZHT.js";import"./chunk-SJIW4WAV.js";import"./chunk-SLDECH2O.js";import{a as et,j as Wt,o as Ht}from"./chunk-5JJQQHKZ.js";import{a as Ut}from"./chunk-URG4MCPH.js";import{y as $,zb as Dt}from"./chunk-ZPOCIBPN.js";import{O as vt,T as Bt,Y as dt,_ as Ot,d as Gt,m as tt}from"./chunk-CA5MYYD6.js";import"./chunk-RZ7GFYMN.js";import{a as mo}from"./chunk-IOCZ22XI.js";import{k as Y,o as jt}from"./chunk-EJY3MW2I.js";import"./chunk-3VRAVMMN.js";import"./chunk-YJ45QIWT.js";import"./chunk-WR62TYUO.js";import{d as Ft,f as oo}from"./chunk-2G2AXMFT.js";import"./chunk-XGFQCNHX.js";import"./chunk-7JF42X5G.js";import{a as y,b as _}from"./chunk-4JZ3HIS7.js";import"./chunk-JLA5HXVC.js";import"./chunk-I4WIGQLD.js";import"./chunk-ZNGQ6IUR.js";import"./chunk-JERFAOJH.js";import"./chunk-JXZFOFB5.js";import"./chunk-LYNLETTP.js";import"./chunk-FQ4XEVKF.js";import{c as Lt}from"./chunk-VMYDP774.js";import{a as St,b as io}from"./chunk-A7LNVEYU.js";import{f as wt,h as no}from"./chunk-2YWUVAR3.js";import"./chunk-VA2HGDZT.js";import"./chunk-AKPDCNMH.js";import{$b as bt,Bb as ao,Fb as kt,Kb as so,Pa as ro,Sa as ut,Ta as yt,Xa as Z,Ya as ht,Za as At,m as pt,na as ft,pb as Nt,yb as v}from"./chunk-M54COW6Q.js";import"./chunk-PWWHYQAY.js";import{H as G,b as lt}from"./chunk-RIJWHGTU.js";import{I as j,v as T}from"./chunk-K4MPEKC5.js";import"./chunk-X6USBUO5.js";import"./chunk-674MHQJQ.js";import"./chunk-XIGC6FD5.js";import{a as W}from"./chunk-CXUPEGDW.js";import"./chunk-QAWZYDPQ.js";import"./chunk-PYTKRRY4.js";import"./chunk-363VDWOO.js";import"./chunk-7B5WANGL.js";import"./chunk-4P4FGPYZ.js";import"./chunk-Y47SQ3XQ.js";import"./chunk-YGNOWOE7.js";import"./chunk-N4GKTC7Y.js";import"./chunk-2BD64J7Y.js";import"./chunk-RYJHESAH.js";import"./chunk-DOQ5NSSP.js";import"./chunk-VULQOB2N.js";import{f as P,m as i,o as m}from"./chunk-ICCOEXX5.js";i();m();var D=P(W());ao();i();m();var Q=P(W()),Ae=P($()),Ne=P(mo());i();m();var Fe=P($()),mt=P(pt());var co=t=>{let o=(0,Fe.useSelector)(Dt),e=t?.image;return(0,mt.isArray)(e)?t.image=e[0]:(0,mt.isObject)(e)&&(t.image=null),{token:t,provider:o}},we=co;i();m();j();var ye=P($());jt();var po=(t={},o={},e=!0)=>{let r=(0,ye.useDispatch)(),a=t.address,u=ot(),c=Ie(),s=B(),l={actionType:L.ACTION_TYPE.CANCEL,async onClick(){s({all_confirmation:"cancel",trade:"add_token"}),await c(a,!1),await Y(r)},btnText:T("wallet_dapp_connection_btn_reject")},n={actionType:L.ACTION_TYPE.CONFIRM,disabled:!e,async onClick(){try{s({all_confirmation:"confirm",trade:"add_token"});let f=await nt(o.type,u),C={...t,contractAddress:a,blockChain:f.shortName,localType:o.type};await Xt(C),await c(a,!0),await Y(r)}catch(f){G.error(f?.data?.originalError?.msg||T("wallet_extenshion_toast_add_failed"))}}};return[l,n]},he=po;var lo=({unapproved:t})=>{let o=(0,Ae.useSelector)(Vt),{token:e,provider:r}=we(t),[a,u]=(0,Q.useState)(!0),c=ot();Wt(async()=>{let l=await nt(r.type,c);u(!!l)});let s=he(e,r,a);return!e||o!==Yt.addToken?Q.default.createElement(Ne.Redirect,{to:Ut}):Q.default.createElement(xe,{token:e,provider:r,supported:a,buttonGroup:s})},ke=lo;i();m();var Ge=P(W());var J=P($());jt();j();i();m();var O=P(W());oo();i();m();var Se=()=>(0,O.useCallback)(async(o,e)=>{await Ft().updateReportTimestamp(o,e)},[]);var fo=()=>{let t=Se();return(0,O.useCallback)(async e=>{await t(e,"CAN_CONFIRM")},[t])},Me=(t,o)=>{let e=fo(),r=(0,O.useRef)(!1);(0,O.useEffect)(()=>{!o&&!r.current&&(r.current=!0,e(t))},[t,o,e])},Re=()=>{let t=Se();return(0,O.useCallback)(async e=>{await t(e,"CLICK_CONFIRM")},[t])};i();m();var Le=P(pt());var be=({isMev:t,mevInfo:o,unapproved:e,modifiedData:r,customGasInfo:a,updateData:u,gasReturnActivity:c})=>{let{nonce:s,updateGasInfo:l}=u,n=(0,Le.cloneDeep)(e),{supportEip1559:f,gasLimitInfo:C={},gasLimit:x,maxFeePerGas:E,gasPrice:g,maxPriorityFeePerGas:F}=a;if(r&&n.txParams&&(n.txParams.data=r),f?(delete n?.txParams.gasPrice,n.txParams.maxFeePerGas=_(E),n.txParams.maxPriorityFeePerGas=_(F),n.txParams.type=tt.FEE_MARKET):(delete n?.txParams.maxFeePerGas,delete n?.txParams.maxPriorityFeePerGas,delete n?.txParams.type,n.txParams.gasPrice=_(g)),l){let N=Object.entries(l).reduce((I,[w,h])=>(I[w]=_(h),I),{});n.txParams={...n.txParams,...N}}return n.txParams.gas=_(x),n.txParams.nonce=_(s),n.gasLimitInfo=C||{},n.mev=t?o.name:"",n.activityId=c?.activityId,n.gasType=a.gasType,e?.txParams?.data||(n.isBaseCoinTransfer=!0),n};var uo=(t,o)=>{let e=(0,J.useSelector)(a=>re(a,t)),r=(0,J.useSelector)(a=>oe(a,t)??o??!1);return{mevInfo:e,isMev:r}},To=({unapproved:t})=>{let o=(0,J.useDispatch)(),e=S(),r=it(t),{id:a,txParams:u={},extParams:c={}}=t,{from:s,to:l,value:n}=u,{coinId:f,chainName:C}=e,x=_e(t.origin,s)||{},{isMev:E,mevInfo:g}=uo(a,c?.isMev),F=Re(),N=et((M,R)=>{o(Tt.setIsMev({isMev:M,id:a})),o(Tt.setMevInfo({mevInfo:R,id:a}))});Me();let I=B(x?.walletId),w=et(async()=>{I({trade:"contract_interaction",all_confirmation:"cancel",network:C,dapp_url:t.origin}),Rt(),await o(Jt({id:a})),await Y(o)}),h=le(),k=et(async({modifiedData:M,customGasInfo:R,gasReturnActivity:H,reportGasReturnActivityDataInConfirm:V})=>{let{gasPrice:ct}=R;if(F(a),await at({callback:w,walletId:x?.walletId})){I({all_confirmation:"confirm",trade:"contract_interaction",network:C,dapp_url:t.origin});let q=await h({to:l,from:s,coinId:f,gasPrice:ct,userGasInfo:R,amount:y(n||0),baseCoinAmountUse:y(n||0)});V(),await o(Qt(be({isMev:E,mevInfo:g,unapproved:t,updateData:q,modifiedData:M,customGasInfo:R,gasReturnActivity:H}))).then(K=>{let{serverTxId:b}=K||{};Mt({tx_id:b})}).catch(K=>{try{let b=K?.data?.originalError;qt(b.code)&&(H?.clear(),G.error({title:b?.msg||T("wallet_home_toast_network_error"),duration:3}))}catch(b){console.log(b)}}),await Y(o)}});return Ge.default.createElement(ue,{needMev:!0,coinId:f,openMev:E,onConfirmReplace:!0,dappInfo:r,txParams:u,txType:t?.type,walletId:x?.walletId,isShowBlockSwapMevTooltip:c?.isShowBlockSwapMevTooltip,onMevChange:N,onCancel:w,onConfirm:k})},ve=To;i();m();j();var d=P(W());i();m();var Pt=P(pt()),Be=P(W());Nt();var Co=({unapproved:t,walletAccount:o,customGasInfo:e={}})=>{let{params:r}=t,{walletId:a}=o,u=S(),{coinId:c}=u,s=te(c,a)?.coinAmountInt,{gasType:l,isNetworkFeeLoading:n,networkFee:f,getLimit:C}=e,{minGasFee:x}=ae(e),E=se(e),g=(0,Be.useMemo)(()=>{if((0,Pt.isNil)(s))return r;let h=s,k=[];return r.forEach(M=>{h=yt(h,f),Z(h,0)&&k.push(M)}),k},[s,r,f]),F=n&&At(C,0),N={level:l||Bt.STANDARD,loading:n,coinId:u?.coinId,networkFee:F?void 0:x,maxNetworkFee:F?void 0:f,estimateFailed:E},I=n||g.length&&g.length===r.length,w=(0,Pt.isNil)(s)||ht(s,f);return{isNetworkFeeLoading:n,estimateFailed:E,networkFeeProps:N,canApproveTxs:g,isSufficientGas:w,canApproveAll:I}},Oe=Co;i();m();j();var Po=t=>{for(let o=0;o<t.length;o++){let e=t[o],r=e();if(r)return r}return null},_o=({walletAccount:t,canApproveTxs:o,canApproveAll:e,isSufficientGas:r})=>{let a=rt(t.walletId),u=()=>a?{type:lt.TYPE.error,message:T("wallet_extension_function_alert_wallet_unsupported")}:null,c=S(),s=Te({baseCoin:c,isSufficientGas:r});return Po([u,s,()=>e?null:{type:lt.TYPE.warn,message:T("wallet_extension_function_alert_available_balance",{gasToken:c.symbol,num:o.length})}])},De=_o;i();m();var He=P(W());j();Nt();ro();io();so();no();var We=100,xo=({unapproved:t,walletAccount:o,isSufficientGas:e,canApproveTxs:r,customGasInfo:a,isNetworkFeeLoading:u})=>{let{id:c}=t,{walletId:s,address:l}=o,n=rt(s),f=B(s),{coinId:C}=S(),x=Pe(),E=Ce(),g=(0,He.useCallback)(async()=>{f({trade:"sendEvmInscriptions",all_confirmation:"cancel"}),await x({id:c})},[x,f,c]),F={onClick:g,actionType:L.ACTION_TYPE.CANCEL,btnText:T("wallet_dapp_connection_btn_reject")},N=n||u,{gasPrice:I,supportEip1559:w,gasLimitInfo:h={},gasLimit:k,maxFeePerGas:M,maxPriorityFeePerGas:R,networkFee:H}=a,V=ne({fromAddr:r[0]?.txParams?.from,walletId:s,localType:ft}),ct=async()=>{try{let q=r.length,K=r[0],{from:b,to:Ve,value:qe}=K.txParams;if(f({trade:"sendEvmInscriptions",all_confirmation:"confirm"}),!await at({callback:g,walletId:s}))return;let{data:Ke}=await $t({checkTypes:[dt.OVERWRITTEN],coinId:C,from:b,to:Ve,amount:y(qe||0),gasPrice:I}),je=Ke.find(({checkType:U})=>U===dt.OVERWRITTEN)||{},{newNonce:Qe,toastType:Je,pendingNum:Xe}=je;if(Je===Ot.FAILED){G.error(T("wallet_extension_function_toast_failed_single")),await Ct(1500),await x({id:c});return}let _t=ut(Xe,q);if(Z(_t,We)){G.error(T("wallet_extension_function_toast_pending",{TotalNum:_t,ExceededNum:We}));return}let xt=[],It=[];for(let U=0;U<r.length;U++){let z=r[U],{txParams:p}=z,{from:ze,to:Ze}=p;p.nonce=kt(_(ut(Qe,U))),w?(delete z.gasPrice,p.maxFeePerGas=_(M),p.maxPriorityFeePerGas=_(R),p.type=tt.FEE_MARKET):(delete p.maxFeePerGas,delete p.maxPriorityFeePerGas,delete p.type,p.gasPrice=_(I)),p.gas=_(k),p.gasLimit=_(k),p.gasLimitInfo=h,p.gasType=a.gasType;let $e=Kt(z.txParams),Et=await V({params:$e}),gt=await ee(ft,Et),to={...p,value:y(p.value),gas:k,gasPrice:y(w?p.maxFeePerGas:p.gasPrice),priorityFee:y(w?p.maxPriorityFeePerGas:0),nonce:y(p.nonce),repeatTxType:Gt.CONFIRMING,oldTxHash:"",inscriptionType:1},eo={extJson:JSON.stringify(to),signedTx:Et,coinId:C,coinAmount:y(p.value||0),fromAdr:ze,toAdr:Ze,serviceCharge:H,txHash:gt,txSource:bt.DAPP,inputData:p.data,accountId:s,txType:1,walletType:o?.serverWalletType};It.push(eo),xt.push({id:z.id,txHash:gt})}await wt(St.postSendEvmInscriptions,{txList:It}),await E({id:c,result:xt})}catch(q){G.error(q.msg||T("wallet_home_toast_network_error")),await Ct(1500),await E({id:c,error:"Failed"})}},X={disabled:N,actionType:L.ACTION_TYPE.CONFIRM,onClick:ct};return N?[F,X]:(e||(X={actionType:L.ACTION_TYPE.FILL_UP,txId:c,coinId:C,walletId:s,address:l,receiveOnly:e}),[F,X])},Ue=xo;var Io=({unapproved:t})=>{let{coinId:o}=S(),{txParams:e={}}=t?.params?.[0],{from:r,to:a,data:u,value:c}=e,{walletId:s}=t,l=de(t),n=B(s),f=it(t),[C,x]=(0,d.useState)({}),E=(0,d.useCallback)(V=>{x(V)},[]),{networkFeeProps:g,canApproveTxs:F,canApproveAll:N,isSufficientGas:I,isNetworkFeeLoading:w}=Oe({unapproved:t,walletAccount:l,customGasInfo:C}),h=Ue({unapproved:t,walletAccount:l,canApproveTxs:F,customGasInfo:C,isSufficientGas:I,isNetworkFeeLoading:w}),k=De({walletAccount:l,canApproveTxs:F,canApproveAll:N,isSufficientGas:I}),[M,{setTrue:R,setFalse:H}]=Ht(!1);return d.default.createElement(Lt.Container,null,d.default.createElement(Zt,{title:T("wallet_extension_function_title_bulk_signing"),closeable:!1,backable:!1}),d.default.createElement(st,null,d.default.createElement(fe,{...f})),d.default.createElement(st,null,d.default.createElement(me,{onClick:R,...g})),d.default.createElement(st,{bordered:!1},d.default.createElement(ce,{title:T("wallet_extension_network_address_title_walletused"),address:l.address,walletId:l.walletId,onCopyCallback:()=>{n({trade:"sendEvmInscriptions",all_confirmation:"wallet_used_address"})}})),d.default.createElement(zt,{placeholder:!0,offsetBottom:0,borderTop:!0},d.default.createElement(pe,{...k}),d.default.createElement(L,{buttonGroup:h})),d.default.createElement(ie,{visible:M,coinId:o,address:r,inputData:u,tokenAddress:a,value:y(c),onBack:H,onClose:null,onGasChange:E}))},Ye=Io;var Xn=(0,D.memo)(({unapproved:t})=>{switch(t.method){case vt.SEND_EVM_INSCRIPTIONS:return D.default.createElement(Ye,{unapproved:t});default:break}switch(t.type){case v.ETH_SIGN:case v.PERSONAL_SIGN:case v.ETH_SIGN_TYPED_DATA:case v.ETH_GET_ENCRYPTION_PUBLIC_KEY:case v.ETH_DECRYPT:return D.default.createElement(Ee,{unapproved:t});case v.WATCH_ASSET:return D.default.createElement(ke,{unapproved:t});case v.ADD_ETHEREUM_CHAIN:return D.default.createElement(ge,{unapproved:t});default:return D.default.createElement(ve,{unapproved:t})}});export{Xn as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Ethereum-JVEMKNH7.js.map
