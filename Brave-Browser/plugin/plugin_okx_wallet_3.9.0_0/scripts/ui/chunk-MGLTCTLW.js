import{i as B,q as Se,s as Ie}from"./chunk-DWXABMGH.js";import{Ba as ge,L as K,T as Ht,Z as pe,g as ie,ga as _,i as tt,ia as yt,k as It,lb as k,mb as at,nb as dt,ob as mt,pb as ut,qa as F,ra as D,s as Gt,sa as Te,va as Vt,wa as fe,y as vt}from"./chunk-J5Z72UTY.js";import{Ia as se,Kb as ue,M as re,Sa as Ct,Z as oe,eb as _t,gc as ce,hb as h,jc as le,kb as b,kc as he,lb as Mt,mb as Bt,nb as Nt,oc as et,pb as ne,qb as ae,qc as nt,rb as de,rc as Ut,sb as xt,sc as P,tb as me,tc as R,wa as Pt,xa as Ft,ya as Rt}from"./chunk-OR2KMY5L.js";import{G as Z}from"./chunk-RIJWHGTU.js";import{C as M,I as ee,a as Zt,b as te,j,u as v,z as Dt}from"./chunk-K4MPEKC5.js";import{a as $e}from"./chunk-CXUPEGDW.js";import{f as We,h as s,m as E,o as O}from"./chunk-ICCOEXX5.js";E();O();ee();E();O();var di={Failed:"-1",Waiting:"1",Pending:"2",Succeed:"3"},ct={ESTIMATE:1,EXCEED_ESTIMATE:2,UNTIMED:3,TIMEOUT:4},mi={FromIsBtcChain:1,FromIsNotBtcChain:2,FromIsEthChainFacetCoin:3},U={SINGLE_TIPS:1,GAS:2,BRIDGE:3},it={SINGLE:1,CROSS_FROM_SWAP:2,CROSS_BRIDGE_SWAP:3,CROSS_TO_SWAP:4};E();O();var Ot={SUCCESS:"success",FAIL:"fail",REJECT:"reject",TXHASH:"txhash",APPROVE:"approve",CONNECT:"connect",APP_STATUS:"appStatus",CLOSE:"close"},qe=Object.values(Ot),$t=class{constructor(){s(this,"toast",!0);s(this,"setToast",t=>{this.toast=t});s(this,"chainList",[]);s(this,"setChainList",t=>{this.chainList=t});s(this,"quote",{});s(this,"updateQuote",t=>{this.quote={...this.quote,...t}});s(this,"portal","");s(this,"setPortal",t=>{this.portal=t||""});s(this,"swapParams",{});s(this,"setSwapParams",({fromAmount:t,...e})=>{this.swapParams={...e,fromAmount:yt(t)?t:"1"}});s(this,"status","");s(this,"reset",()=>{this.to={},this.from={},this.events={},this.swapParams={}});s(this,"on",(t,e)=>{if(!qe.includes(t))return new Error("Not support event!!");if(typeof e!="function")return{};this.events[t]||(this.events[t]=[]);let i=`${t}${this.events[t].length}`;return this.events[t].push({cb:e,eventId:i}),{eventId:i,remove:()=>{this.remove(t,i)}}});s(this,"emit",(t,...e)=>{let i=this.events[t];i&&i.length&&i.forEach(r=>{let{cb:o}=r;o&&o.apply(this,e)})});s(this,"remove",(t,e)=>{let i=this.events[t];i&&e&&i.forEach((r,o)=>{r.eventId===e&&i.splice(o,1)})});s(this,"removeAll",()=>{this.events={}});this.events={}}static init(t){return this.instance||(this.instance=new $t(t)),this.instance}},Et=$t;s(Et,"instance",null);var Ye=new Et,Wt=Ye;E();O();var lt=We($e());function ht({type:p,title:t,exploreUrl:e,onURLClick:i,showClose:r}){let o=e?lt.default.createElement(Ie,{className:"color-959dad",href:e,onClick:i},lt.default.createElement("div",{className:"inline-flex align-items-center"},lt.default.createElement("div",{className:"font-12 color-0569ff font-bold"},_("swaptrade_toast_anchor_view_in_explorer")),lt.default.createElement(Se,{className:"okx-defi-dex-link color-0569ff",size:20}))):void 0,n=5;p==="success"?Z.success({title:t,desc:o,duration:n}):p==="failed"?Z.error({title:t,desc:o,duration:n}):p==="info"?Z.info({title:t,desc:o,duration:n,showClose:r}):p==="expired"?Z.info({title:t,desc:o,duration:n,icon:"okds-clock"}):p==="warn"&&Z.warn({title:t,desc:o,duration:n,showClose:r})}function rt({title:p,exploreUrl:t,onURLClick:e=()=>{}}){ht({type:"success",title:p,exploreUrl:t,onURLClick:e})}function bt({title:p,exploreUrl:t,onURLClick:e=()=>{}}){ht({type:"failed",title:p,exploreUrl:t,onURLClick:e})}function qt({title:p,exploreUrl:t,onURLClick:e=()=>{},showClose:i=!0}){ht({type:"info",title:p,exploreUrl:t,onURLClick:e,showClose:i})}function Ce({title:p,exploreUrl:t,onURLClick:e=()=>{}}){ht({type:"expired",title:p,exploreUrl:t,onURLClick:e})}function _e({title:p,exploreUrl:t,onURLClick:e=()=>{},showClose:i=!0}){ht({type:"warn",title:p,exploreUrl:t,onURLClick:e,showClose:i})}E();O();var ot=class{constructor(t){s(this,"orderId","--");s(this,"chainId","--");s(this,"defiPlatformInfo","--");s(this,"fromAmount","--");s(this,"fromTokenSymbol","--");s(this,"price","--");s(this,"status","--");s(this,"time","--");s(this,"toAmount","--");s(this,"toTokenSymbol","--");s(this,"userWalletAddress","--");s(this,"exploreUrl","--");s(this,"isExchanged",!1);s(this,"swapType","--");s(this,"toChainId","--");It(this),Object.assign(this,t)}get computedFromAmount(){return`${R(this.fromAmount,{needPlaceholder:!0,needBillionMillionUnit:!0})}`}get computedToAmount(){return P(this.toAmount)}get computedToNetWorkPath(){let{fromChainName:t,toChainName:e}=this;return t===e?e:`${t} ${_("swaptrade_order_info_label_network_to")} ${e}`}updateFromJson(t){Object.assign(this,t)}toJSON(){return tt(this)}};var{BigNumber:Yt}=et,ye=20,V=[],d={Pending:"0",Failed:"-1",Succeed:"1",Waiting:"100",SpeedingUp:"-4",Canceling:"-3",Canceled:"-2",PendingWithdrawn:"10",PendingCanRedeem:"11",PendingRedeeming:"12"},{Pending:je,SpeedingUp:Ke,Canceling:Xe,PendingWithdrawn:Je,PendingCanRedeem:Qe,PendingRedeeming:Ze}=d,ti=[je,Ke,Xe,Je,Qe,Ze],c={SingleChain:"1",CrossBridge:"2",CrossChain:"3",FromBridge:"3-1",BridgeTo:"3-2",FromBridgeTo:"3-3",GasStation:"4",GasStationCross:"5",LimitOrder:"6",MemeMode:"7"};var G={from:1,bridge:2,fromSwapTimeout:3},ei={FAIL:"-1",NO_SELECTED:"0",WAITING_FOR_FINAL:"1",WAITING_FOR_TRANSFER:"2",TRANSFER_SUCCEED:"3"},{NO_SELECTED:ii,TRANSFER_SUCCEED:ri}=ei,oi=10,Ee={curPageNum:1,pageSize:oi,total:0},si={[c.SingleChain]:"swaptrade_order_swap_trade_type_swap",[c.CrossBridge]:"swaptrade_order_swap_trade_type_bridge",[c.CrossChain]:"swaptrade_order_swap_trade_type_cross_chain",[c.GasStation]:"swaptrade_dialog_tab_gasstation",[c.GasStationCross]:"swaptrade_dialog_tab_gasstation",[c.LimitOrder]:"swaptrade_dialog_tab_gasstation",[c.MemeMode]:"swaptrade_history_modal_label_meme_mode"};function W({childOrderId:p,status:t,exploreUrl:e,orderFailReason:i,toastGuideUrl:r,fromTokenIcon:o,fromChainLogoUrl:n,fromAmountIn:a,fromTokenSymbol:m,fromChainName:u,toTokenIcon:g,toChainLogoUrl:l,toAmountOut:w,toTokenSymbol:T,toChainName:S,originalTokenSymbol:I,refundAmount:y,refundSymbol:L,refundChain:A,errorCode:f},C,N={}){let x=C==="from",q=x?a:w,st=y?P(y):"",J=x?R(a):P(w,{needBillionMillionUnit:!1});N?.useCurrencyInputFormat&&(J=R(q));let Q=N?.isMemeModeOrder&&N?.assetDelay&&t===d.Succeed?"999999":f;return{key:`${p}${C}`,status:t,exploreUrl:e,orderFailReason:i,toastGuideUrl:r,originalTokenSymbol:I,fromChainName:u,fromTokenSymbol:m,toChainName:S,chainName:x?u:S,chainLogo:x?n:l,symbol:x?m:T,symbolLogo:x?o:g,amount:q==="-1"?"":J,errorCode:Q,refund:{amount:st,symbol:L,chain:A},...N}}var zt=class{constructor(t){s(this,"detail",{data:null,loading:!1,error:!1});s(this,"history",{list:[],loading:!1,loadMore:!1,hasMore:!1,error:null,pageInfo:{...Ee},chainId:-1});s(this,"limitHistory",{...this.history});s(this,"limitDetail",{...this.detail});s(this,"pendingOrders",[]);s(this,"modal",{orderId:"",visible:!1});s(this,"expireTime",0);s(this,"fromStepCountDownTimeGroup",{estimatedTime:0,estimatedTimeTotal:0});s(this,"bridgeStepCountDownTimeGroup",{estimatedTime:0,originEstimatedTime:0});s(this,"timeoutTimestamp",0);s(this,"timer",null);s(this,"timeOutTimer",null);s(this,"detailShowSource","");s(this,"showModal",t=>{let e=typeof t=="string"?t:"";this.modal={visible:!0,orderId:e,defaultOrderId:e},this.setHistoryTab(this.commonStore?.currentTab===h.BRIDGE?h.SWAP:this.commonStore?.currentTab)});s(this,"updateModal",t=>{this.modal.orderId=typeof t=="string"?t:""});s(this,"closeModal",()=>{this.modal.visible=!1,this.setDetailShowSource()});s(this,"setDetailShowSource",(t="")=>{this.detailShowSource=t});s(this,"setDetail",t=>{this.detail={...this.detail,...t}});s(this,"setLimitDetail",t=>{this.limitDetail={...this.limitDetail,...t}});s(this,"getStepCountDownTimeGroup",({estimatedTime:t,originEstimatedTime:e,expireTime:i,extraEstimatedTime:r,extraOriginEstimatedTime:o})=>{let n=Math.min(t,i),a=e||t;return this.computedMainOrderType===c.BridgeTo&&(n=t+Math.min(r,i),a+=o),{estimatedTime:n,estimatedTimeTotal:a}});s(this,"setSwapExpireTime",t=>{let e=!this.computedCurrentHistoryTabIsLimit&&Number(t.estimatedTime),i=Number(t.fromEstimatedTime)||0,r=Number(t.bridgeEstimatedTime)||0,o=Number(t.originFromEstimatedTime)||0,n=Number(t.originBridgeEstimatedTime)||0;this.fromStepCountDownTimeGroup=this.getStepCountDownTimeGroup({expireTime:e,estimatedTime:i,originEstimatedTime:o}),this.bridgeStepCountDownTimeGroup=this.getStepCountDownTimeGroup({expireTime:e,estimatedTime:r,originEstimatedTime:n,extraEstimatedTime:i,extraOriginEstimatedTime:o}),this.expireTime=e,this.expireTime>0&&(this.timer=setInterval(()=>{let a=this.computedStepStatus.bridgeStatus,m=this.computedStepStatus.fromSwapStatus,u=this.detail?.data?.status===d.Canceling,g=l=>l===d.SpeedingUp||l===d.Pending;this.expireTime<1?(clearInterval(this.timer),this.bridgeStepCountDownTimeGroup.estimatedTime=0,this.fromStepCountDownTimeGroup.estimatedTime=0):(this.expireTime-=1,this.fromStepCountDownTimeGroup.estimatedTime>0&&g(m)&&!u&&(this.fromStepCountDownTimeGroup.estimatedTime-=1),this.bridgeStepCountDownTimeGroup.estimatedTime>0&&g(a)&&!u&&(this.bridgeStepCountDownTimeGroup.estimatedTime-=1))},1e3))});s(this,"setSwapTimeout",t=>{this.timeOutTimer&&clearInterval(this.timeOutTimer),this.timeoutTimestamp=Date.now()>t?0:t||0,this.timeoutTimestamp>0&&(this.timeOutTimer=setInterval(()=>{Date.now()>this.timeoutTimestamp&&(this.timeoutTimestamp=0,clearInterval(this.timeOutTimer))},1e3))});s(this,"removePendingOrder",t=>{let e=this.pendingOrders,i=e.findIndex(({orderId:o})=>o===t);i>-1&&e.splice(i,1),this.setPendingOrders([...e])});s(this,"updateDetailByData",t=>{let e=this.detail.data,i=r=>r&&{...r,fromAmountIn:r?.fromAmount,toAmountOut:r?.toAmount};if(e&&t&&t.orderId===e.orderId){let{fromChildOrder:r,bridgeChildOrder:o,toChildOrder:n}=t;this.setDetail({data:Ht(e,{...t,fromChildOrderDetailVo:i(r),bridgeChildOrderDetailVo:i(o),toChildOrderDetailVo:i(n)})})}});s(this,"fetchHistory",ie(function*(e={},i=!1){let r=this.accountStore.computedAccountWalletAddressesArray;if(this.computedIsLimitOrSwapLabel.chainId!==-1&&Object.assign(e,{chainId:this.computedIsLimitOrSwapLabel.chainId}),this.computedIsLimitOrSwapLabel.loading||this.computedIsLimitOrSwapLabel.loadMore||K(r))return;this.setSwapOrLimitHistory(i?{loadMore:!0}:{loading:!0});let o={...e,pageSize:this.history.pageInfo.pageSize,accountId:this.accountStore.computedAccountId},n={...e,pageSize:this.limitHistory.pageInfo.pageSize,accountId:this.accountStore.computedAccountId,statusType:Mt.ALL},a=this.computedCurrentHistoryTabIsLimit?n:o,m=this.computedCurrentHistoryTabIsLimit?xt:ne,[u,g]=yield M(B.get(m,{params:a}));if(this.setSwapOrLimitHistory(i?{loadMore:!1}:{loading:!1}),u){this.setSwapOrLimitHistory({error:u});return}this.setSucResult(g,i)}).bind(this));s(this,"setSucResult",(t,e)=>{let{data:{dataList:i,pageSize:r,totalCount:o,curPageNum:n}}=t,a=e?this.computedIsLimitOrSwapLabel.list.concat(i):i;this.setSwapOrLimitHistory({list:a,pageInfo:{...this.computedIsLimitOrSwapLabel.pageInfo,total:o,pageSize:r,curPageNum:n},hasMore:Number(o)>a.length})});s(this,"updateSwapAndLimitDataList",t=>{this.computedIsLimitOrSwapLabel.list.forEach((e,i)=>{String(e?.orderId)===String(t?.orderId)&&(this.computedIsLimitOrSwapLabel.list[i]={...e,...t})})});s(this,"setChainId",async t=>{this.resetHistoryList(),this.setSwapOrLimitHistory({chainId:t}),await this.fetchHistory()});s(this,"resetHistoryList",()=>{this.setSwapOrLimitHistory({pageInfo:{...Ee},list:[],error:null,loading:!1,loadMore:!1,hasMore:!1,chainId:-1})});s(this,"getLocalPriceFee",(t,e)=>{let{symbol:i,usdToThisRate:r}=this.commonStore.nowCurrencyUnit||{};if(t&&e&&r){let o=et.mul(et.mul(t,e),r);return`(${Ut(o,i)})`}return""});s(this,"emitOrder",t=>{if(t){let{status:e,orderId:i}=t;e===d.Succeed||e===b.SUCCEED?Wt.emit(Ot.SUCCESS,{status:0,data:tt(t),message:Dt("transaction success")}):(e===d.Failed||e===b.FAILED)&&Wt.emit(Ot.FAIL,{data:{orderId:i},status:-1,message:Dt("transaction fail")})}});s(this,"onSocket",(t,e=!0)=>{(t?.type==="1"||t?.type==="3")&&t?.dexData&&t.dexData.type!=="approve"&&t.dexData.type!=="register"&&(this.updateSwapAndLimitDataList(t.dexData),this.updateSwapAndLimitDetail(t.dexData),this.updateLimitOuterOrderList(t.dexData),this.updatePendingOrdersByData(t.dexData),this.emitOrder(t.dexData),this.toastSwapAndLimitOrder(e,t.dexData))});s(this,"updateSwapAndLimitDetail",t=>{t.swapTradeType!==c.LimitOrder?this.updateDetailByData(t):this.updateLimitDetailByData(t)});s(this,"updateLimitOuterOrderList",t=>{this.commonStore?.computedCurrentTabIsLimit&&this.rootStore.limitOrderListStore.updateLimitOuterListData(t)});s(this,"toastSwapAndLimitOrder",(t,e)=>{t&&!this.commonStore?.computedCurrentTabIsLimit?this.toastOrder(e):t&&this.commonStore?.computedCurrentTabIsLimit&&this.toastLimitOrder(e)});s(this,"onSocketError",async()=>{let{computedAccountId:t}=this.accountStore,{visible:e,orderId:i}=this.modal;if(!e){let[r]=await M(this.updatePendingOrders(t));r&&te.error("history detail onSocketError",{error:r})}e&&i&&await M(this.updateDetail(i,!0))});s(this,"historyTab","");s(this,"setHistoryTab",t=>{this.historyTab=t});It(this,{},{autoBind:!0}),this.rootStore=t,this.commonStore=t.commonStore,this.accountStore=t.accountStore,this.fromToStore=t.fromToStore,this.tokenModalStore=t.tokenModalStore}get computedHistoryList(){return this.history.list.map(t=>new ot(tt(t)))}get computedLimitHistoryList(){return this.limitHistory.list.map(t=>new ot(tt(t)))}get computedTimeGroup(){let t=this.computedCurrentHistoryTabIsLimit?this.computedLimitHistoryList:this.computedHistoryList,e=this.computedCurrentHistoryTabIsLimit?"createTime":"time";return t.reduce((i,r)=>{let o=i.find(n=>n.time===j(r?.[e],{format:"yyyyMMdd"}));return o?o.list.push(r):i.push({time:j(r?.[e],{format:"yyyyMMdd"}),list:[r]}),i},[])}get noData(){return this.computedCurrentHistoryTabIsLimit?!this.computedLimitHistoryList.length:!this.computedHistoryList.length}setHistory(t){this.history={...this.history,...t}}setLimitHistory(t){this.limitHistory={...this.limitHistory,...t}}setPendingOrders(t){this.pendingOrders=t}fetchDetail(t){return this.computedCurrentHistoryTabIsLimit?B.get(me,{params:{orderId:t}}).then(({data:e})=>e):B.get(ae,{params:{orderId:t}}).then(({data:e})=>e)}fetchPendingOrders(t){return B.post(de,{accountId:t}).then(({data:e})=>e)}async updatePendingOrders(t){if(Zt())return;let e;if(this.commonStore?.computedCurrentTabIsLimit){let[,i]=await M(B.get(xt,{params:{accountId:this.accountStore.computedAccountId,chainId:"",pageNum:1,pageSize:10,statusType:Mt.PENDING}}));e=i?.data?.dataList}else{let[,i]=await M(this.fetchPendingOrders(t));e=i}Array.isArray(e)?this.setPendingOrders(e):this.setPendingOrders([])}updatePendingOrdersByData(t){if(!t)return;let e=this.pendingOrders,i=e.findIndex(({orderId:n})=>n===t.orderId),r=i>-1,o=t.swapTradeType===c.LimitOrder?t.status===b.PENDING:ti.includes(t.status);o?(r&&e.splice(i,1),e.push(t)):!o&&r&&e.splice(i,1),this.setPendingOrders([...e])}async updateDetail(t,e){e||this.setLimitOrSwapDetail({data:null,loading:!0,error:!1});let[i,r]=await M(this.fetchDetail(t));clearInterval(this.timer),i||!r?this.setLimitOrSwapDetail({data:null,error:!0}):(this.setLimitOrSwapDetail({data:r,error:!1}),this.setSwapExpireTime(r),this.setSwapTimeout(Number(r.timeoutTimestamp))),this.setLimitOrSwapDetail({loading:!1})}setLimitOrSwapDetail(t){this.computedCurrentHistoryTabIsLimit?this.setLimitDetail(t):this.setDetail(t)}updateLimitDetailByData(t){let e=this.limitDetail.data,i={data:Ht({},e,{...t})};this.setLimitDetail(i)}get computedIsLimitOrSwapLabel(){return this.computedCurrentHistoryTabIsLimit?this.limitHistory:this.history}setSwapOrLimitHistory(t){this.computedCurrentHistoryTabIsLimit?this.setLimitHistory(t):this.setHistory(t)}get computedIsSingleChain(){return[c.SingleChain,c.GasStation,c.MemeMode].includes(vt(this,"detail.data.swapTradeType",""))}get computedIsGasStation(){return[c.GasStation,c.GasStationCross].includes(vt(this,"detail.data.swapTradeType",""))}get computedMainOrderType(){let t=this.detail.data,e="";if(!t)return e;let{swapTradeType:i,hiddenFromOrder:r,toChildOrderDetailVo:o}=t;return i!==c.CrossChain?e=i:r==="1"?e=c.BridgeTo:o?e=c.FromBridgeTo:e=c.FromBridge,e}get computedStepStatus(){let t=this.detail.data,e=r=>r?[d.Waiting,d.Pending].includes(r)?d.Pending:r:"",i=this.computedMainOrderType===c.BridgeTo?e(t?.bridgeChildOrderDetailVo?.status||""):t?.bridgeChildOrderDetailVo?.status||"";return[c.BridgeTo,c.CrossBridge].includes(this.computedMainOrderType)&&[d.Failed,d.Canceled].includes(t?.status)&&(i=t?.status),{fromSwapStatus:e(t?.fromChildOrderDetailVo?.status||""),bridgeStatus:i,toSwapStatus:t?.toChildOrderDetailVo?.status||""}}get computedRatio(){let t=this.detail?.data;if(!t)return{fromRatio:0,bridgeRatio:0};let{status:e}=t,i=this.computedStepStatus.bridgeStatus,r=this.computedStepStatus.fromSwapStatus;if(e===d.Succeed||e===d.Canceled||e===d.Failed&&this.computedMainOrderType===c.BridgeTo)return{fromRatio:1,bridgeRatio:1};let n=(this.fromStepCountDownTimeGroup.estimatedTimeTotal-this.fromStepCountDownTimeGroup.estimatedTime)/this.fromStepCountDownTimeGroup.estimatedTimeTotal;n=n>.8||this.fromStepCountDownTimeGroup.estimatedTimeTotal===0?.8:n;let a=(this.bridgeStepCountDownTimeGroup.estimatedTimeTotal-this.bridgeStepCountDownTimeGroup.estimatedTime)/this.bridgeStepCountDownTimeGroup.estimatedTimeTotal;return a=a>.8||this.bridgeStepCountDownTimeGroup.estimatedTimeTotal===0?.8:a,r!==d.Pending&&r!==d.SpeedingUp&&r!==d.Canceling&&(n=1),this.computedMainOrderType===c.FromBridgeTo&&i!==d.Pending&&i!==d.SpeedingUp&&i!==d.Canceling&&(a=0),i===d.Succeed&&(a=1),{fromRatio:n,bridgeRatio:a}}get computedFoldTipToast(){let t=this.detail?.data;if(!t)return{foldTipType:""};let{bridgeChildOrderDetailVo:e}=t,i=[],r=[],o=!1,n=!1,a=0,m=this.fromStepCountDownTimeGroup.estimatedTime,u=this.bridgeStepCountDownTimeGroup.estimatedTime,g=this.computedMainOrderType===c.FromBridge;this.computedSubOrders.forEach((S,I)=>{(S.tipType===G.from||S.tipType===G.bridge)&&i.push(S),S.errorCode!=="0"&&I<this.computedSubOrders.length-1&&r.push(S)});let l=-1;i.length>0&&(l=i[0]?.tipType),l===G.bridge&&(a=u),l===G.from&&(a=m),g&&l===G.bridge&&(a=0),l===G.from?n=m===0:l===G.bridge&&(n=u===0);let w={...e,refund:{amount:e?.refundAmount?P(e.refundAmount):"",symbol:e?.refundSymbol,chain:e?.refundChain}},T=l===G.bridge?w:i?.[0];return r.length>0&&(T=r[r.length-1],o=!0),{foldTipType:l,currentProcessIsTimeOut:n,tipCountDownTime:a,filterProcessItem:T,needShowErrorTip:o}}get computedSubOrders(){let t=this.detail.data;if(!t)return[];let{fromChildOrderDetailVo:e,bridgeChildOrderDetailVo:i}=t,{toChildOrderDetailVo:r,status:o,assetDelay:n}=t,a=this.computedStepStatus.bridgeStatus,m=this.computedStepStatus.fromSwapStatus,u=this.computedMainOrderType===c.BridgeTo,g=this.computedMainOrderType===c.FromBridgeTo,l=this.computedMainOrderType===c.FromBridge,w=a===d.Pending||a===d.SpeedingUp||this.computedMainOrderType===c.CrossBridge&&o!==d.Failed&&o!==d.Canceled&&o!==d.Succeed||u&&a===d.Waiting?G.bridge:0,T=m===d.Pending||m===d.SpeedingUp?G.from:0,S={bridgeInfo:i?.bridgeOrderInfoVo,dexBridgeShadowTokenPair:i?.dexBridgeShadowTokenPairInfoVo,dexBridgeShadowTokenPairChainId:i?.toChainId,tipInfo:{toTokenSymbol:e?.toTokenSymbol},bridgeTipInfo:{bridgeName:i?.bridgeOrderInfoVo?.bridgeName||"",toChainName:i?.toChainName||""}};e={...e,status:this.computedStepStatus.fromSwapStatus};let I=i?.status;if(i={...i,status:this.computedStepStatus.bridgeStatus},this.computedIsSingleChain||this.computedMainOrderType===c.GasStationCross){let y=!1;this.timeoutTimestamp?y=!this.expireTime&&e.status===d.Pending:y=e.status===d.Pending;let L=this.computedMainOrderType===c.MemeMode;return[W(e,"from",{isFromStart:!0,hasTimeoutTips:y,timeoutType:U.SINGLE_TIPS}),W(e,"to",{...S,hiddenExploreUrl:!0,subOrderType:it.SINGLE,isMemeModeOrder:L,assetDelay:n})]}else if(this.computedMainOrderType===c.CrossBridge){let y=this.expireTime<1&&(i.status===d.Waiting||i.status===d.Pending);return[W(e,"to",{...S,tipType:w,useCurrencyInputFormat:!0,hasTimeoutTips:y,timeoutType:U[i.status===d.Pending?"BRIDGE":"GAS"]}),W(i,"to",{...S,officialBridgeTime:i?.officialBridgeTime,subOrderType:it.CROSS_BRIDGE_SWAP})]}else if([c.BridgeTo,c.FromBridge,c.FromBridgeTo].includes(this.computedMainOrderType)){let y=this.expireTime<1&&r?.status===d.Pending,L=!this.fromStepCountDownTimeGroup.estimatedTime&&(e.status===d.Pending||I===d.Waiting),A=!1,f;u&&!this.bridgeStepCountDownTimeGroup.estimatedTime?I===d.Waiting?(A=!0,f=U.GAS):I===d.Pending&&(A=!0,f=U.BRIDGE):g&&e?.status===d.Succeed&&!this.bridgeStepCountDownTimeGroup.estimatedTime&&(i.status===d.Waiting?(A=!0,f=U.GAS):i.status===d.Pending&&(A=!0,f=U.BRIDGE));let C=[W(e,"from",{isFromStart:!0,ratio:this.computedRatio.fromRatio,showProgressBar:!0,tipType:T,hasTimeoutTips:L,timeoutType:U.SINGLE_TIPS,...S}),W(e,"to",{ratio:this.computedRatio.bridgeRatio,tipType:l&&L?0:w,showProgressBar:g||u,countDownTime:!u&&this.fromStepCountDownTimeGroup.estimatedTime,hasTimeoutTips:A,timeoutType:l?U.SINGLE_TIPS:f,...S,subOrderType:it.CROSS_FROM_SWAP}),W(i,"to",{...S,countDownTime:this.bridgeStepCountDownTimeGroup.estimatedTime,hasTimeoutTips:l?!1:y,timeoutType:U.SINGLE_TIPS,subOrderType:it.CROSS_BRIDGE_SWAP})];return u&&C.shift(),(u||g)&&C.push(W(r,"to",{subOrderType:it.CROSS_TO_SWAP})),C}return[]}get computedDataDetail(){return this.computedCurrentHistoryTabIsLimit?this.limitDetail:this.detail}get computedLimitOrderInfo(){if(!this.limitDetail?.data)return null;let{swapTradeType:t,createTime:e,fromChildOrderDetailVO:i,price:r,transactionPrice:o,surplus:n,surplusUsdValue:a,totalGasFee:m,totalGasFeeUsdValue:u,transactionTime:g,exploreUrl:l,expireTime:w,userWalletAddress:T,failureReason:S,status:I,dealWarnTag:y,remainTime:L,timeoutToast:A}=this.limitDetail?.data,{fromTokenSymbol:f,toTokenSymbol:C,fromAmount:N,toAmount:x,fromChainLogoUrl:q,toChainLogoUrl:st,fromTokenIcon:J,toTokenIcon:Q,fromChainName:wt,failureReason:At}=i,kt=[b.CANCELLED,b.EXPIRED,b.SUCCEED,b.FAILED].includes(I),Y=S||At,z=R(N),pt=F(x),Tt={fromAmount:1,fromSymbol:f,toAmount:F(o),toSymbol:C},ft={fromAmount:1,fromSymbol:C,toAmount:F(Yt(1).div(o).toString()),toSymbol:f},gt={fromAmount:1,fromSymbol:f,toAmount:F(r),toSymbol:C},St={fromAmount:1,fromSymbol:C,toAmount:F(Yt(1).div(r).toString()),toSymbol:f};return{type:t,typeKey:"swaptrade_orders_text_limit_order",status:I,isSuccess:I===b.SUCCEED,isFailed:I===b.FAILED,isSupplyFailed:I===b.FAILED&&Y===Nt.NO_SUPPLY,isOtherFailed:I===b.FAILED&&Y!==Nt.NO_SUPPLY&&!!Y,fromTokenGroupLabel:`${ut("-",z)} ${f}`,fromTokenGroupLabelEquation:`${ut("-",z)} ${k(f)}`,toTokenGroupLabel:`${ut("+",pt)} ${C}`,toTokenGroupLabelEquation:`${ut("+",pt)} ${k(C)}`,fromChainLogoUrl:q,fromTokenIcon:J,toChainLogoUrl:st,toTokenIcon:Q,createTime:e?j(e,{format:"yyyyMMddHHmmss"}):"",expireTime:w?j(w,{format:"yyyyMMddHHmmss"}):"",txTime:g?j(g,{format:"yyyyMMddHHmmss"}):"",networksName:wt,networksLogo:q,price:at(gt),reversePrice:at(St),priceEquation:dt(gt),reversePriceEquation:dt(St),execPrice:o?at(Tt):_t,reverseExecPrice:at(ft),execPriceEquation:o?dt(Tt):_t,reverseExecPriceEquation:dt(ft),fee:m?mt({amount:F(m),symbol:f,extra:this.getLocalPriceFee(1,u,!0)}):_t,surplus:n?mt({amount:F(n),symbol:C,extra:this.getLocalPriceFee(1,a,!0)}):"",originAddress:T,formatAddress:`${T.substr(0,6)}...${T.substr(T.length-4)}`,exploreUrl:l,fromTokenSymbol:f,failureReason:Y,dealWarnTag:y,remainTime:L,timeoutToast:A,showSwapAgainBtn:kt}}get computedLimitFromToInfo(){let t=this.limitDetail?.data;if(!t)return null;let{fromChildOrderDetailVO:e,userWalletAddress:i,swapTradeType:r}=t,{fromChainId:o,fromTokenContractAddress:n,toChainId:a,toTokenContractAddress:m}=e;return{apiRequestParams:{fromChainId:o,toChainId:a,userWalletAddress:i,swapTradeType:r},locationParams:{from:{chainId:o,tokenContractAddress:n},to:{chainId:a,tokenContractAddress:m}}}}get computedSwapFromToInfo(){let t=this.detail?.data;if(!t)return null;let{fromChainId:e,fromTokenAddress:i,toChainId:r,toTokenAddress:o,swapTradeType:n,from:a}=t;return{apiRequestParams:{fromChainId:e,toChainId:r,userWalletAddress:a,swapTradeType:n},locationParams:{from:{chainId:e,tokenContractAddress:i},to:{chainId:r,tokenContractAddress:o},inputAmount:this.computedIfSwapFailedAmount||re}}}get computedFromToInfo(){return this.computedCurrentHistoryTabIsLimit?this.computedLimitFromToInfo:this.computedSwapFromToInfo}getForRefuelFromPrice(t){return t&&!nt(t)?P(t):"--"}getReceiveTokenPrice(t){return t&&!nt(t)?P(t):"--"}getExplorerUrl(t){return this.computedIsSingleChain?t?.exploreUrl:""}getOrderFinnishedTime(t,e,i){return[d.Succeed].includes(i)?Te(e-t):"--"}getIsIntentOrder(t){return t!==oe&&t}getFormattedNetworkFee(t){return t?P(t):""}getFormattedOtherFees(t){return t?P(t):""}getOtherFees(t,e){return t&&e?.fromTokenSymbol?`${t} ${e.fromTokenSymbol}`:""}getBridgeFee(t,e){return t?`${t} ${e?.toTokenSymbol}`:""}getBridgeFeeUsd(t,e,i){return fe(t(e).toString(),i)}getEstimateBridgeFeeAmount(t,e){return t?`${P(t)} ${e}`:""}getEstimateBridgeFeeAmountUsd(t,e,i){return t?Ut(i(t).toString(),e):""}getToSwapFee(t,e,i,r){return t?mt({amount:t,symbol:e,extra:this.getLocalPriceFee(i,r)}):""}getFromToPrice(t){return t&&!nt(t)&&t!=="-1"?P(Yt("1").div(t).toString(10)):"--"}getToFromPrice(t){return t&&!nt(t)&&t!=="-1"?P(t):"--"}getGasToken(t,e,i,r,o){return!t||t===ii?null:{amount:e,symbol:i,status:t,exploreUrl:r,logoUrl:o}}get computedOrderInfo(){if(!this.detail.data)return null;let{swapTradeType:t,time:e,fromChainName:i,fromChainLogoUrl:r,fromChildOrderDetailVo:o,toChainName:n,toChainLogoUrl:a,networkFee:m,nativeTokenSymbol:u,otherFees:g,from:l,forRefuelFromAmount:w,fromTokenSymbol:T,toTokenSymbol:S,bridgeChildOrderDetailVo:I,receiveTokenStatus:y,receiveTokenExploreUrl:L,receiveTokenAmount:A,receiveTokenSymbol:f,abnormalStatus:C,hiddenFromOrder:N,bridgeFee:x,bridgeFeeUsd:q,estimateBridgeFeeAmount:st,estimateBridgeFeeAmountUsd:J,toSwapFee:Q,toChainNativeTokenSymbol:wt,hiddenOtherFee:At,toChildOrderDetailVo:kt,price:Y,receiveWalletAddress:z,gasStationActivityReward:pt,fromGasTokenPriceUsd:Tt,toGasTokenPriceUsd:ft,receiveTokenLogoUrl:gt,errorCode:St,status:Lt,orderCompletionTime:we,orderId:Ae,specialOrderType:ke,mevInfo:Le,fromSwapMevInfo:De,toSwapMevInfo:Pe,intentCode:Fe,assetDelay:Re,assetDelayTime:Me,isMemeTimeOut:Be,totalSlippage:Ne}=this.detail.data,{currencyConversion:jt,computedNowCurrencySymbol:Kt}=this.commonStore,Xt=[{chainName:i,chainLogo:r}];this.computedIsSingleChain||Xt.push({chainName:n,chainLogo:a});let Jt=this.getFormattedNetworkFee(m),xe=this.getFormattedOtherFees(g),Ue=Vt(x),Ge=Vt(Q),Qt=t===c.MemeMode,ve=[d.Succeed,d.Failed,d.Canceled].includes(Lt),He=![c.GasStation,c.GasStationCross].includes(t),Ve=ve&&He&&!Qt;return{isSingleChain:this.computedIsSingleChain,type:t,typeKey:si[t],time:j(e,{format:"yyyyMMddHHmmss"}),networks:Xt,assetDelay:Re,assetDelayTime:Me,isMemeTimeOut:Be,isMemeModeOrder:Qt,networkFee:Jt?mt({amount:Jt,symbol:u,extra:this.getLocalPriceFee(m,this.computedIsGasStation?"":Tt)}):"--",otherFees:this.getOtherFees(xe,I),bridgeFee:this.getBridgeFee(Ue,I),bridgeName:I?.bridgeOrderInfoVo?.bridgeName,bridgeFeeUsd:this.getBridgeFeeUsd(jt,q,Kt),estimateBridgeFeeAmount:this.getEstimateBridgeFeeAmount(st,u),estimateBridgeFeeAmountUsd:this.getEstimateBridgeFeeAmountUsd(J,Kt,jt),toSwapFee:this.getToSwapFee(Ge,wt,Q,ft),fromToPrice:this.getFromToPrice(Y),toFromPrice:this.getToFromPrice(Y),from:l,receiveWalletAddress:z,fromSymbol:T,toSymbol:S,omittedFrom:`${l.substr(0,6)}...${l.substr(l.length-4)}`,omittedTo:`${z.substr(0,6)}...${z.substr(z.length-4)}`,gasToken:this.getGasToken(y,A,f,L,gt),abnormalStatus:C,hiddenFromOrder:N,hiddenOtherFee:At,hasToChildOrderDetailVo:!!kt,forRefuelFromPrice:this.getForRefuelFromPrice(w),receiveTokenPrice:this.getReceiveTokenPrice(A),receiveTokenStatus:y,gasStationActivityReward:pt,exploreUrl:this.getExplorerUrl(o),errorCode:St,orderFinishedTime:this.getOrderFinnishedTime(e,we,Lt),status:Lt,showSwapAgainBtn:Ve,orderId:Ae,fromChainName:i,specialOrderType:ke,mevInfo:Le,fromSwapMevInfo:De,toSwapMevInfo:Pe,isIntentOrder:this.getIsIntentOrder(Fe),totalSlippage:Ne}}get computedPendingOrdersCount(){return this.pendingOrders.filter(e=>e.status!==d.PendingCanRedeem).length}get computedOrdersHasFacetSwap(){let t=this.pendingOrders.find(e=>e.status==d.PendingCanRedeem);return{showTip:!!t,data:t||{}}}get computedPendingTimingStatus(){return this.timeoutTimestamp?this.expireTime!==0&&this.timeoutTimestamp?ct.ESTIMATE:!this.expireTime&&this.timeoutTimestamp?ct.EXCEED_ESTIMATE:!this.expireTime&&!this.timeoutTimestamp?ct.TIMEOUT:1:ct.TIMEOUT}toastOrder(t){if(t){let{status:e,orderId:i,fromAmount:r,fromTokenSymbol:o,toAmount:n,toTokenSymbol:a,fromChildOrder:m,receiveTokenStatus:u,type:g,swapTradeType:l,isMemeTimeOut:w,exploreUrl:T,assetDelay:S}=t,I=`${i}_${e}`;if(se()||V.includes(I))return;let y=l===c.MemeMode,L=()=>{V.unshift(I),V=V.slice(0,ye)},A=u!==ri;if(e===d.Pending&&m?.status===d.Pending){if(L(),y&&w){_e({title:_("swaptrade_history_modal_error_likely_fail",{num:r,token1:o,token2:a})});return}rt({title:_("wallet_swap_toast_swap_submitted")})}else if(e===d.Succeed&&A){let f=this.computedSubOrders;if(L(),y&&S){rt({title:_("swaptrade_history_modal_tips_swap_update",{num1:r,token1:o,num2:n,token2:a}),exploreUrl:T});return}rt({title:_("swaptrade_toast_swap_success",{fromCount:R(r,{needBillionMillionUnit:!0}),fromToken:k(o),toCount:P(n),toToken:k(a)}),exploreUrl:f[f.length-1]?.exploreUrl})}else if(e===d.Failed&&A){let C=this.computedSubOrders.filter(N=>N.status===d.Failed);L(),bt({title:g==="gasStation"?_("swaptrade_gasstation_toast_refill_failed",{nativeToken:k(a)}):_("wallet_swap_toast_swap_failed"),exploreUrl:C[C.length-1]?.exploreUrl})}else e===d.Canceled&&A&&(rt({title:_("swaptrade_placeorder_toast_transaction_canceled")}),L())}}toastLimitOrder(t){if(t){let{status:e,orderId:i,fromChildOrderDetailVO:r,failureReason:o}=t,{fromAmount:n,fromTokenSymbol:a,toAmount:m,toTokenSymbol:u,failureReason:g,exploreUrl:l}=r,w=`${i}_${e}`;if(V.includes(w))return;let T=()=>{V.unshift(w),V=V.slice(0,ye)};e===b.OPEN?(T(),qt({title:_("swaptrade_orders_notif_limitorder_submitted",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:k(a),receiveValue:F(m),receiveToken:k(u)})})):e===b.SUCCEED?(T(),rt({title:_("swaptrade_orders_notif_limitorder_success",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:a,receiveValue:F(m),receiveToken:u}),exploreUrl:l})):e===b.FAILED&&o?(T(),bt({title:_("swaptrade_orders_notif_limitorder_failed",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:k(a),receiveValue:F(m),receiveToken:k(u)})})):e===b.FAILED&&g?(T(),bt({title:_("swaptrade_orders_notif_limitorder_failed",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:k(a),receiveValue:F(m),receiveToken:k(u)}),exploreUrl:l})):e===b.CANCELLED?(qt({title:_("swaptrade_orders_notif_limitorder_canceled",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:k(a),receiveValue:F(m),receiveToken:k(u)})}),T()):e===b.EXPIRED&&(Ce({title:_("swaptrade_orders_notif_limitorder_expired",{sellValue:R(n,{needBillionMillionUnit:!0}),sellToken:k(a),receiveValue:F(m),receiveToken:k(u)}),exploreUrl:l}),T())}}get computedCurrentHistoryTabIsLimit(){return this.historyTab===h.LIMIT_ORDER}get computedOrigin(){return this.historyTab===h.LIMIT_ORDER?h.LIMIT_ORDER:[c.SingleChain,c.GasStation].includes(this.computedMainOrderType)?h.SWAP:h.BRIDGE}get computedIfSwapFailedAmount(){let t=this.detail?.data;return t?.status===d.Failed&&!this.computedCurrentHistoryTabIsLimit&&yt(t?.fromAmount)?t.fromAmount:""}},qi=zt;E();O();var Xi="",Ji="hide_detail_alert";E();O();ee();E();O();function Oe(p){return![...Object.values(p?.from||{}),...Object.values(p?.to||{})].some(t=>t)}E();O();var hr=(p,t)=>!!p.find(i=>Number(t)===Number(i.chainId)),be=p=>{if(!p)return!1;let{fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r}=p,o=[D(t)&&i,D(e)&&r];return!!pe(o,Boolean)};var ai=()=>({from:{chainId:null,tokenContractAddress:null},to:{chainId:null,tokenContractAddress:null}}),wr={BRIDGE:"bridge",SWAP:"swap"},X=class{constructor(t,e,i={}){s(this,"setTab",t=>{this.tab=t});s(this,"hasFromToToken",t=>this.tab===h.LIMIT_ORDER?!K(t?.data?.fromToken)&&!K(t?.data?.toToken):!K(t?.data?.fromTokenInfo)&&!K(t?.data?.toTokenInfo));s(this,"fetchSingleChainTokens",async({fromTokenAddress:t,toTokenAddress:e,chainId:i})=>{let[r,o]=await M(B.get(ce,{params:{fromTokenAddress:t,toTokenAddress:e,chainId:i}}));return[r,o]});s(this,"generateSingleChainTokenPair",async({walletChainId:t,...e})=>{let r={chainId:D(e.fromChainId)?e.fromChainId:e.toChainId,fromTokenAddress:e.fromTokenAddress,toTokenAddress:e.toTokenAddress};if(D(r.chainId)){let[a,m]=await this.fetchSingleChainTokens(r);if(!a&&this.hasFromToToken(m))return[a,m]}if(D(t)){let[a,m]=await this.fetchSingleChainTokens({chainId:t});if(!a&&this.hasFromToToken(m))return[a,m]}let[o,n]=await this.fetchSingleChainTokens({chainId:Ct});return[o,n]});s(this,"fetchCrossChainTokens",async({fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r})=>{let[o,n]=await M(B.get(ue,{params:{chainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r}}));return[o,n]});s(this,"generateCrossChainTokenPair",async({walletChainId:t,...e})=>{if(D(e.fromChainId)||D(e.toChainId)){let o={...e},{hasFrom:n,hasTo:a}=X.checkTokenParams({chainId:e.fromChainId,tokenContractAddress:e.fromTokenAddress},{chainId:e.toChainId,tokenContractAddress:e.toTokenAddress});ge(e.fromChainId,e.toChainId)&&(n?o={fromChainId:e.fromChainId,fromTokenAddress:e.fromTokenAddress}:a&&(o={toChainId:e.toChainId,toTokenAddress:e.toTokenAddress}));let[m,u]=await this.fetchCrossChainTokens(o);if(!m&&this.hasFromToToken(u))return[m,u]}if(D(t)){let[o,n]=await this.fetchCrossChainTokens({fromChainId:t});if(!o&&this.hasFromToToken(n))return[o,n]}let[i,r]=await this.fetchCrossChainTokens({fromChainId:Ct});return[i,r]});s(this,"fetchLimitOrderRecommendTokens",async({fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r})=>{let[o,n]=await M(B.get(le,{params:{fromChainId:t,toChainId:e,fromTokenAddress:i,toTokenAddress:r}}));return[o,n]});s(this,"generateLimitOrderTokenPair",async({walletChainId:t,...e})=>{let i=D(e.fromChainId),o=D(e.toChainId)?e.fromChainId===e.toChainId:!0;if(i&&o){let[m,u]=await this.fetchLimitOrderRecommendTokens(e);if(!m&&this.hasFromToToken(u))return[m,u]}if(D(t)){let[m,u]=await this.fetchLimitOrderRecommendTokens({fromChainId:t});if(!m&&this.hasFromToToken(u))return[m,u]}let[n,a]=await this.fetchLimitOrderRecommendTokens({fromChainId:Ct,fromTokenAddress:""});return[n,a]});s(this,"getTokenPairByResponseData",t=>this.tab===h.LIMIT_ORDER?{from:t?.fromToken,to:t?.toToken}:{from:t?.fromTokenInfo,to:t?.toTokenInfo});s(this,"generateTokenAndTabConfig",({error:t,data:e})=>{if(t)return{error:t,from:null,to:null,tab:this.tab};let{from:i,to:r}=this.getTokenPairByResponseData(e);return{error:null,from:i,to:r,tab:this.tab}});s(this,"checkInputAmount",t=>{let e=et.BigNumber(t);return!e.isNaN()&&e.isFinite()&&e.gt(0)?e.toString():""});s(this,"generateInitConfigByParams",async({from:t,to:e,inputAmount:i,walletChainId:r})=>{let o=this.checkInputAmount(i),n={fromChainId:t.chainId,toChainId:e.chainId,fromTokenAddress:t.tokenContractAddress,toTokenAddress:e.tokenContractAddress,walletChainId:r};if(this.tab===h.BRIDGE){let[a,m]=await this.generateCrossChainTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:o}}if(this.tab===h.SWAP){let[a,m]=await this.generateSingleChainTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:o}}if(this.tab===h.LIMIT_ORDER){let[a,m]=await this.generateLimitOrderTokenPair(n);return{...this.generateTokenAndTabConfig({error:a,data:m.data}),inputAmount:o}}return{error:new Error("tab is not valid"),from:null,to:null,tab:this.tab,inputAmount:o}});this.setTab(t),this.dexParams=e,this.config=i}makeDexParams(){let{dexParams:t}=this;return Oe(t)?this.readInfoFromLocalStorage():t}async initTokenPair(t){let e=this.makeDexParams(),{from:i,to:r,tab:o,inputAmount:n,error:a}=await this.generateInitConfigByParams({...e,walletChainId:t});return{from:i,to:r,tab:o,inputAmount:n,error:a}}async switchTabAndInitToken(t){let e=this.makeDexParams(),{from:i,to:r,tab:o,inputAmount:n,error:a}=await this.generateInitConfigByParams({...e,tab:t});return{from:i,to:r,tab:o,inputAmount:n,error:a}}readInfoFromLocalStorage(){let t=ai(),e;switch(this.tab){case h.SWAP:e=v.get(Pt);break;case h.BRIDGE:e=v.get(Ft);break;case h.LIMIT_ORDER:e=v.get(Rt)||v.get(Bt)?.LIMIT_ORDER;break;default:break}let i={from:{...t.from,...e?.from},to:{...t.to,...e?.to}};return e?.from?.tokenContractAddress?i:t}writeTabInfoToLocalStorage(t){switch(this.tab){case h.SWAP:v.set(Pt,t);break;case h.BRIDGE:v.set(Ft,t);break;case h.LIMIT_ORDER:v.set(Rt,t);break;default:break}}},$=X;s($,"checkTokenParams",(t,e)=>{let i=be({fromChainId:t?.chainId,toChainId:e?.chainId,fromTokenAddress:t?.tokenContractAddress,toTokenAddress:e?.tokenContractAddress}),r=D(t?.chainId)&&!!t?.tokenContractAddress,o=D(e?.chainId)&&!!e?.tokenContractAddress;return{isValid:i,hasFrom:r,hasTo:o}}),s($,"judgeTabTypeByChainId",async t=>{let[e,i]=await M(B.get(he));if(e)return h.SWAP;let{swap:r=[],bridge:o=[]}=i.data;return r.includes(Gt(t))?h.SWAP:o.includes(Gt(t))?h.BRIDGE:h.SWAP}),s($,"judgeTabTypeByParams",async(t,e)=>{let{isValid:i,hasFrom:r,hasTo:o}=X.checkTokenParams(t,e);if(!i)return h.SWAP;let n=t?.chainId,a=e?.chainId;if(r&&o)return n===a?h.SWAP:h.BRIDGE;let m;return r&&!o&&(m=n),!r&&o&&(m=a),await X.judgeTabTypeByChainId(m)}),s($,"formatDialogParams",t=>({from:{chainId:t?.fromChainId,tokenContractAddress:t?.fromTokenAddress},to:{chainId:t?.toChainId,tokenContractAddress:t?.toTokenAddress}})),s($,"getDialogInitTab",async t=>{let{from:e,to:i}=X.formatDialogParams(t);return await X.judgeTabTypeByParams(e,i)});var Ar=$;export{hr as a,wr as b,Ar as c,di as d,ct as e,mi as f,U as g,it as h,Ot as i,Wt as j,rt as k,bt as l,qt as m,d as n,c as o,G as p,qi as q,Xi as r,Ji as s};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-MGLTCTLW.js.map
