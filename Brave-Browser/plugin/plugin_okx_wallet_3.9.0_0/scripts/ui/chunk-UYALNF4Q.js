import{c as fe}from"./chunk-JPV5PNQX.js";import{a as pe}from"./chunk-LHNVUV3G.js";import{a as me}from"./chunk-SG4LXTVB.js";import{d as C}from"./chunk-6GFVKSAR.js";import{a as oe}from"./chunk-BFVA6OLJ.js";import{b as ie}from"./chunk-RC3QMLDN.js";import{b as ce,c as ue,d as le}from"./chunk-PRHPRTXY.js";import{a as ne}from"./chunk-EWK7ZFVN.js";import{e as ae,f as M}from"./chunk-4RHFH7IF.js";import{d as re}from"./chunk-LPTRVNVL.js";import{a as d}from"./chunk-5JJQQHKZ.js";import{s as Q,wb as te,y as ee}from"./chunk-ZPOCIBPN.js";import{d as j,f as Re}from"./chunk-2G2AXMFT.js";import{a as se,b}from"./chunk-4JZ3HIS7.js";import{B as k,C as O,M as q,Qa as A,Ra as D,Sa as x,Ta as R,Ua as K,Va as N,Wa as z,Xa as J,Ya as X,hb as S,la as Ne,m as Fe,pb as B,t as G,x as L}from"./chunk-M54COW6Q.js";import{I as _e,m as V}from"./chunk-K4MPEKC5.js";import{a as I}from"./chunk-CXUPEGDW.js";import{f as h,m,o as p}from"./chunk-ICCOEXX5.js";m();p();var T={UNAPPROVED:"unapproved",APPROVED:"approved",REJECTED:"rejected",SIGNED:"signed",SUBMITTED:"submitted",FAILED:"failed",DROPPED:"dropped",SUCCEED:"succeed",PENDING:"pending"},f={TRANS_OUT:1,AUTHORIZATION:2,CONTRACT_CALL:3,CANCEL_AUTHORIZATION:4,CONTRACT_DEPLOY:5},je={[f.TRANS_OUT]:"wallet_extension_history_list_send",[f.CONTRACT_CALL]:"wallet_extension_history_list_contract_interaction",[f.AUTHORIZATION]:"wallet_extension_history_list_approval",[f.CANCEL_AUTHORIZATION]:"wallet_extension_history_list_revoke_approval",[f.CONTRACT_DEPLOY]:"developer_mode_history_title_contract_eployment"};m();p();B();var Ee=h(I());m();p();B();var Te=async(e={})=>e?.baseFeePerGas!==void 0,H=e=>parseInt(e,16);function Ce({baseFeePerGas:e,number:t}){return{number:t,baseFeePerGas:e,gasUsedRatio:null,priorityFeesByPercentile:null}}function we({baseFeePerGas:e,number:t,blockIndex:s,gasUsedRatios:r,priorityFeePercentileGroups:n,percentiles:o}){let i=r[s],a=n[s],c=o.reduce((u,l,_)=>{let F=a[_];return{...u,[l]:H(F)}},{});return{number:t,baseFeePerGas:e,gasUsedRatio:i,priorityFeesByPercentile:c}}async function de({web3:e,numberOfBlocks:t,endBlockNumber:s,percentiles:r,includeNextBlock:n}){let o=await e.eth.getFeeHistory(t,s,r),i=H(o.oldestBlock);if(o.baseFeePerGas!==void 0&&o.baseFeePerGas.length>0&&o.gasUsedRatio.length>0&&(o.reward===void 0||o.reward.length>0)){let a=n?o.baseFeePerGas:o.baseFeePerGas.slice(0,t),c=o.gasUsedRatio,u=o.reward??[],l=c.length;return a.map((_,F)=>{let Y=H(_),Z=x(i,F);return F>=l?Ce({baseFeePerGas:Y,number:Z}):we({baseFeePerGas:Y,number:Z,blockIndex:F,gasUsedRatios:c,priorityFeePercentileGroups:u,percentiles:r})})}return[]}var v=1024;function ye(e,t){N(e,t)&&(t=e);let s=[];for(let r=R(e,t);N(r,e);r=x(r,v)){let n=R(e,r),o=n<v?n:v,i=x(r,o);s.push({numberOfBlocks:o,endBlockNumber:i})}return s}var Pe=async({web3:e,numberOfBlocks:t,endBlock:s="latest",percentiles:r=[],includeNextBlock:n=!1})=>{let o=r.length>0?Array.from(new Set(r)).sort((u,l)=>u-l):[],a=ye(s,t);return(await Promise.all(a.map(({numberOfBlocks:u,endBlockNumber:l},_)=>_===a.length-1?de({web3:e,numberOfBlocks:u,endBlockNumber:l,percentiles:o,includeNextBlock:n}):de({web3:e,numberOfBlocks:u,endBlockNumber:l,percentiles:o,includeNextBlock:!1})))).reduce((u,l)=>[...u,...l],[])};var Ae=e=>e?C(e):{},Se=["0x144","0x2105"],Ie=e=>(0,Ee.useCallback)(async()=>(await Ae(e)).eth.getBlock("latest"),[e]),ct=e=>d(async({to:t,from:s,value:r,data:n=""},o)=>{let i=!o,a="";return n?le(n)?a=Q(n):a=ue(n):i||(a=me(t,r||0)),await(await C(e)).eth.estimateGas({from:s,to:i?t:o,value:i?r:null,data:a||null})},[e]),Ge=["low","medium","high"],Le={low:{percentile:10,baseFeePercentageMultiplier:110,priorityFeePercentageMultiplier:94,minSuggestedMaxPriorityFeePerGas:1e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:3e4}},medium:{percentile:20,baseFeePercentageMultiplier:120,priorityFeePercentageMultiplier:97,minSuggestedMaxPriorityFeePerGas:15e8,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:45e3}},high:{percentile:30,baseFeePercentageMultiplier:125,priorityFeePercentageMultiplier:98,minSuggestedMaxPriorityFeePerGas:2e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:6e4}}};function ke(e){let t=e.slice().sort((n,o)=>N(R(n,o),0)?-1:1),s=t.length,r=Math.floor((s-1)/2);return t[r]}var Oe=(e,t)=>{let s=Le[e],r=t[t.length-1].baseFeePerGas,n=D(A(r,s.baseFeePercentageMultiplier),100),o=t.map(l=>"priorityFeesByPercentile"in l?l?.priorityFeesByPercentile?.[s.percentile]:null).filter(Boolean),i=ke(o),a=D(A(i,s.priorityFeePercentageMultiplier),100),c=K([a,s.minSuggestedMaxPriorityFeePerGas]),u=x(n,c);return{baseFeePerGas:S(n,0),maxFeePerGas:S(u,0),maxPriorityFeePerGas:S(c,0)}},De=e=>Ge.reduce((t,s)=>{let r=Oe(s,e),{maxFeePerGas:n}=r;return[...t,{level:s,isSupportEip1559:!0,gasPrice:n,...r}]},[]),Be=e=>d(async t=>{let s=await C(e),r=await Pe({web3:s,endBlock:t.number,numberOfBlocks:21,percentiles:[10,20,30]});return De(r)},[e]),be=[{coefficient:1.1,level:"low"},{coefficient:1.35,level:"medium"},{coefficient:1.7,level:"high"}],Me=e=>d(async()=>{let s=await(await C(e)).eth.getGasPrice();return be.map(({level:r,coefficient:n})=>({level:r,gasPrice:A(s,n)}))},[e]),ut=e=>{let t=Ie(e),s=Me(e),r=Be(e);return d(async n=>{let o=await t(),i=!Se.includes(n)&&await Te(o),a,c=i?r:s;try{a=await c(o)}catch{a=await s(o)}return a},[e])};m();p();var y=h(I()),U=h(ee());Ne();var ve=()=>{let{isRpcMode:e}=(0,U.useSelector)(re);return e},He=[L,G,O,k],Ue=()=>{let e=ne(),t=oe(),s=(0,y.useMemo)(()=>e.filter(({appBaseChain:r,localType:n})=>r===q?.ETHEREUM?!0:He.includes(n)),[e]);return(0,y.useMemo)(()=>s.map(({image:r,chainName:n,localType:o,...i})=>{let a=t.find(c=>c.localType===o);return{...a||i,chainName:n,icon:r,chainId:[L,G,O,k].includes(o)?b(i?.chainId):a?.realChainIdHex||b(i?.chainId)}}),[t,s])},W=()=>{let{defaultNets:e,customNets:t}=(0,U.useSelector)(ae);return(0,y.useMemo)(()=>pe([...e,...t||[]]),[e,t])},gt=()=>{let e=ve(),t=W(),s=Ue();return(0,y.useMemo)(()=>e?t:s,[e,t,s])};m();p();Re();var We={singleTx:"singleTx",batchTransfer:"batchTransfer"},yt=()=>{let e=W();return(t,s=We.singleTx)=>e.find(n=>fe(n,t))?.defaultGasForRpc?.[s]},$e=()=>async(e,t)=>{await j().setRpcDefaultGas(e,t)},At=$e;m();p();var E=h(I()),g=h(ee());var P=h(Fe());_e();B();function Ye(){return(0,g.useSelector)(te,g.shallowEqual)}function $(e){let t=Ye(),s=ie(),r=(0,g.useSelector)(M)||{};return(0,E.useMemo)(()=>Object.values(t).filter(n=>{if(!n.txParams)return!1;let{from:o,chainId:i}=n.txParams;return s===o&&i===r.chainId&&e(n)}),[t,s,r.chainId])}function Ut(){return $(e=>e.status===T.FAILED||e.status===T.SUCCEED)}function he(e){let[t,s]=e,r=+t,n=+V.add(1,"d",new Date(s));return o=>X(o,r)&&z(o,n)}function xe(e={}){let{dates:t}=e,s=$(r=>r.status===T.FAILED||r.status===T.SUCCEED||r.status===T.DROPPED);return(0,E.useMemo)(()=>{let r=s;if(t){let n=he(t);r=r.filter(({finishTime:o})=>n(o))}return r.sort((n,o)=>o.finishTime-n.finishTime).map(n=>({...n,isShowPending:!1}))},[s,t])}function ge(e={}){let t=$(r=>r.status===T.PENDING),{dates:s}=e;return(0,E.useMemo)(()=>{let r=(0,P.sortBy)(t,[n=>ce(n.txParams.nonce)]).map((n,o)=>({...n,isShowPending:o===0}));if(s){let n=he(s);r=r.filter(({sendTime:o})=>n(o))}return r},[t,s])}function Ze(){let e=ge(),t=xe();return(0,E.useMemo)(()=>[...e,...t],[e,t])}function Wt(e){let t=Ze();return(0,E.useMemo)(()=>e?t.find(({id:s})=>e===s):null,[e,t])}function $t({tokenAddress:e}){let t=ge(),s=xe();return(0,E.useMemo)(()=>[...t,...s].filter(({type:r,txParams:n,extraParams:o})=>{if(r===f.TRANS_OUT)return!e&&!o?.tokenAddress||(0,P.toLower)(e)===(0,P.toLower)(o?.tokenAddress);if(r===f.AUTHORIZATION||r===f.CANCEL_AUTHORIZATION)return(0,P.toLower)(e)===(0,P.toLower)(o?.tokenAddress);if(r===f.CONTRACT_CALL){let{value:i}=n||{};return!e&&J(se(i),0)}return!1}),[t,s,e])}var Ve=(e,t,s)=>{let{protocol:r,host:n,pathname:o,search:i,hash:a}=new URL(e),c=o.endsWith("/")?`${o}${t}/${s}`:`${o}/${t}/${s}`;return new URL(`${r}//${n}${c}${i}${a}`).toString()};function Yt(){let e=(0,g.useSelector)(M);return d(t=>e?.explorerUrl?Ve(e?.explorerUrl,"tx",t):null)}export{T as a,f as b,je as c,Ut as d,xe as e,ge as f,Ze as g,Wt as h,$t as i,Ve as j,Yt as k,ct as l,ut as m,ve as n,gt as o,We as p,yt as q,At as r};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-UYALNF4Q.js.map
