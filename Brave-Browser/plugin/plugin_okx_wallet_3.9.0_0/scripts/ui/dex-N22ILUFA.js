import{a as vs}from"./chunk-SMPKI7U4.js";import{a as su,b as iu}from"./chunk-MJMSMKGU.js";import{a as Yc,b as Xc,c as zc}from"./chunk-HC6ABCSA.js";import{a as Dc,b as xc}from"./chunk-LDK4YRRU.js";import{a as eu,b as ou,c as ru}from"./chunk-P4K7WMB2.js";import"./chunk-3TWPOAEX.js";import"./chunk-4KSIW65U.js";import{a as Qc,b as $c}from"./chunk-NR5M2562.js";import"./chunk-FSXW45U6.js";import"./chunk-6UR6D26Y.js";import"./chunk-DQUBHXFU.js";import"./chunk-PCZ7TQOH.js";import{a as Kc}from"./chunk-OXTQMA4W.js";import"./chunk-RMPNHDVC.js";import"./chunk-YWELIV7Q.js";import"./chunk-53Z372L4.js";import"./chunk-EHDEZCO2.js";import"./chunk-TFCBP6UV.js";import"./chunk-FORV77D5.js";import{a as tu}from"./chunk-UFJWKC47.js";import{k as Jc}from"./chunk-G35FQ3WW.js";import{a as Zc}from"./chunk-KEYZ4YCG.js";import{a as Hc}from"./chunk-5NV3TIKF.js";import"./chunk-DCMAUS7C.js";import"./chunk-QIJYKINJ.js";import"./chunk-D4V7ONZY.js";import{b as jc}from"./chunk-MTAR53YL.js";import"./chunk-KWQVFNZ3.js";import{h as Rc,l as Oc,p as Nc,r as Pc}from"./chunk-N3VGDA3L.js";import{a as wc,b as bs,c as Lc,d as bc}from"./chunk-3QCQMWWZ.js";import"./chunk-TQEP4B6B.js";import"./chunk-E6PQQLEO.js";import"./chunk-R7R6LTH6.js";import{f as kc}from"./chunk-TAZU4KSU.js";import"./chunk-W327NRHO.js";import"./chunk-DZDHGH5B.js";import{b as yc,d as Ec}from"./chunk-UKFSUXAE.js";import"./chunk-U3CLRNWK.js";import"./chunk-M4STRGDO.js";import"./chunk-GYUX3JJ3.js";import"./chunk-C3P5GP5W.js";import"./chunk-4C2576LU.js";import"./chunk-2ZLYTJ3L.js";import"./chunk-H43TVLNI.js";import{a as Fc}from"./chunk-PBOUQOH2.js";import"./chunk-SG4LXTVB.js";import"./chunk-M4JNKF23.js";import"./chunk-3EYFKVOU.js";import"./chunk-QUUI62AZ.js";import{a as nd}from"./chunk-36RLD6PA.js";import{a as N,b,c as ks,d as Kt,e as Ja,h as Za,i as tc,j as ec,l as oc,p as sr,q as rc}from"./chunk-U2NLBCHF.js";import{a as ja,b as Ya,c as Qt,f as dc,i as ao,j as co,k as nr,l as ar,m as mc,n as cr,q as ur,r as $t}from"./chunk-MGLTCTLW.js";import{a as Xo,b as st,c as it,d as Sa,e as xa,f as Fa,g as yt,h as Ht,i as k,k as $a,l as Me,m as Xa,n as za,r as Be}from"./chunk-DWXABMGH.js";import{a as sc,b as ir,c as ic,d as nc,e as ac,f as cc,g as uc,h as lc}from"./chunk-S75HHGJZ.js";import{$ as Pt,A as ga,B as Jo,Ba as Pa,C as Ca,Ca as Da,D as so,Da as Ma,E as Zo,F as tr,G as Ia,H as Aa,Ia as Fe,J as _a,Ja as Ba,Ka as er,L as X,La as Ua,N as ya,O as se,P as io,Pa as ys,S as Ea,U as ka,V as wa,W as La,X as no,Y as ba,Ya as or,Za as Es,_a as Wa,a as dn,aa as Cs,ab as Va,b as Ft,ba as va,bb as qa,c as $e,ca as De,d as mn,da as Is,db as rr,e as at,ea as As,f as Ct,fb as Ga,g as Mt,ga as h,gb as Ha,h as pn,hb as Qa,i as M,ia as wt,ib as Ka,j as ct,ja as xe,k as x,kb as id,l as kt,la as Ra,lb as U,m as Bt,ma as Lt,n as hn,o as Y,p as fa,pa as Oa,ra as G,s as J,ta as _s,v as Ta,w as zo,x as Gt,xa as Na,y}from"./chunk-J5Z72UTY.js";import{a as Gc}from"./chunk-LROIEJOH.js";import"./chunk-CDQGPNSO.js";import{a as Wc}from"./chunk-SIKYZQW4.js";import{b as Cc}from"./chunk-MCRNCTJS.js";import{a as Mc,b as Bc,d as Uc,e as Vc,g as qc}from"./chunk-YZAK46Y6.js";import"./chunk-VX7CI7XT.js";import"./chunk-D6HSNWGS.js";import{a as Ic,d as _c}from"./chunk-7ODXCTBK.js";import"./chunk-NRUOGYUU.js";import"./chunk-BZTTFC54.js";import"./chunk-WSSHN373.js";import"./chunk-GZMWLE4V.js";import{b as vc}from"./chunk-C54I6GL3.js";import"./chunk-ZJICRI36.js";import"./chunk-BIBDTDJA.js";import{a as gc}from"./chunk-ADIQBHVU.js";import"./chunk-TPVT7ZCY.js";import"./chunk-A6HNAUBV.js";import"./chunk-6GFVKSAR.js";import{a as Ac}from"./chunk-JVLSBRR5.js";import"./chunk-5IXTSGAM.js";import{$ as Qo,$a as Pe,$b as sa,A as Cn,Aa as eo,Ab as xn,Ba as It,Bb as jo,C as F,Ca as v,Cb as Fn,D as Le,Da as $o,Db as Mn,E as be,Ea as hs,Eb as Bn,F as In,Fa as fs,Fb as Un,G as ve,Ga as kn,Gb as Wn,H as oe,Ha as _t,Hb as Vn,I as ns,Ia as rt,Ib as qn,J as Ze,Jb as Gn,K as An,L as re,Lb as Hn,Mb as Qn,Nb as Kn,O as lt,P as Ut,Pb as $n,Q as as,Qb as jn,R as Wt,Rb as Yn,S as Re,Sa as oo,Sb as Yo,T as qo,Ta as B,Tb as Xn,U as ot,Ua as C,Ub as zn,V as Vt,Vb as Jn,Wa as wn,Wb as Zn,X as cs,Xb as ta,Y as Go,Yb as ea,Z as Ho,Za as ht,Zb as oa,_ as Oe,_a as ft,_b as ra,a as Mo,ab as Ss,ac as ia,b as Bo,bb as Ln,bc as na,c as je,ca as us,cb as bn,cc as aa,d as Ye,da as ls,dc as ca,e as Uo,ea as _n,ec as ua,f as Xe,fa as Ko,fc as la,g as rs,ga as to,gb as vn,h as Wo,hb as _,hc as da,i as ze,ic as ma,j as Je,jb as Nt,k as ss,ka as z,l as fn,la as At,lc as pa,ma as Ne,mc as ha,n as ut,o as Z,oa as ds,oc as g,p as tt,pc as gs,qc as qt,r as Sn,ra as ms,rc as et,s as Tn,sa as ps,sc as j,ta as yn,tc as ro,u as $,ua as En,ub as Ts,v as is,vb as Rn,w as gn,wb as On,xb as Nn,yb as Pn,z as Vo,za as Ot,zb as Dn}from"./chunk-OR2KMY5L.js";import"./chunk-FFJ36R7T.js";import"./chunk-NVCWAHOV.js";import"./chunk-RFEJLMRV.js";import{e as Sc,g as Tc}from"./chunk-UIABO6UG.js";import"./chunk-KJFAD5C4.js";import"./chunk-BFVA6OLJ.js";import"./chunk-ON3J2WQV.js";import{a as Ls}from"./chunk-RC3QMLDN.js";import"./chunk-JINEVGIZ.js";import"./chunk-SRU2IM3A.js";import"./chunk-46NSFYB3.js";import{i as fc}from"./chunk-FFQESTX4.js";import"./chunk-OCZAVPFZ.js";import"./chunk-P6SDUFQ6.js";import"./chunk-5TNZ4MQV.js";import{W as sn}from"./chunk-U4LUDZBW.js";import"./chunk-44D6W456.js";import{a as rd}from"./chunk-VPDXC6IS.js";import"./chunk-XGXABYQN.js";import"./chunk-KKTPGZSO.js";import"./chunk-ESKOSV75.js";import{b as on}from"./chunk-ZDQ5EBGN.js";import"./chunk-2KEW2T4M.js";import"./chunk-WZVETVFR.js";import"./chunk-R7VTXTCL.js";import"./chunk-LBYCQPAD.js";import"./chunk-KSSIMCRC.js";import{a as li,b as di,g as xi}from"./chunk-CCCFHF2B.js";import"./chunk-PAEQZ7UN.js";import"./chunk-KDTBVHVU.js";import"./chunk-CWTKVHHS.js";import"./chunk-PRHPRTXY.js";import"./chunk-IGCT3RWS.js";import"./chunk-SQ5W4RLM.js";import"./chunk-I27PVEIN.js";import"./chunk-Y2PED5BF.js";import"./chunk-RUSRHRGO.js";import"./chunk-IZ5XPPXG.js";import{d as nn,e as an}from"./chunk-6PN4BR3D.js";import"./chunk-EWK7ZFVN.js";import"./chunk-A23SHFFL.js";import"./chunk-VZ3BFZKL.js";import"./chunk-T6Z2C3RK.js";import"./chunk-R2QYIBE7.js";import{b as os}from"./chunk-KT53NMHD.js";import"./chunk-64STH2HN.js";import"./chunk-EKQH7XTV.js";import"./chunk-R2QKPEWB.js";import"./chunk-RMA2FZOE.js";import"./chunk-KRHB66KZ.js";import"./chunk-4RHFH7IF.js";import"./chunk-LPTRVNVL.js";import"./chunk-PH2A2GR3.js";import"./chunk-2LLM6N6U.js";import{h as ln}from"./chunk-LF2PURXZ.js";import"./chunk-JEZIPKDY.js";import{a as un}from"./chunk-SR2BDP3A.js";import{c as ws,d as lr,e as dr,i as pc,l as hc}from"./chunk-CFT6B56M.js";import"./chunk-WK32FAZW.js";import"./chunk-WMUTUJYX.js";import{d as sd}from"./chunk-B23OWGFX.js";import"./chunk-OSWXWF4A.js";import"./chunk-Q7FJER56.js";import"./chunk-RBTIRMSE.js";import"./chunk-7GZ2ZCGI.js";import"./chunk-WTP3OIOS.js";import{a as ed}from"./chunk-D66ZH3O3.js";import"./chunk-X764QIVO.js";import"./chunk-HISWVX7W.js";import"./chunk-PYJPOVV7.js";import"./chunk-AO6MUSOH.js";import{a as cn}from"./chunk-I435LZHT.js";import{e as Fi}from"./chunk-SJIW4WAV.js";import"./chunk-SLDECH2O.js";import{a as Yi,h as od,j as Xi,t as zi}from"./chunk-5JJQQHKZ.js";import{a as Ji}from"./chunk-URG4MCPH.js";import{$a as $i,Oa as qi,Pa as Gi,Ra as Hi,Va as Qi,Xa as Ki,ab as xo,qb as ji,r as Pi,y as Di}from"./chunk-ZPOCIBPN.js";import{J as es,T as Wi,da as Vi,p as Bi,v as ts,x as Ui}from"./chunk-CA5MYYD6.js";import"./chunk-RZ7GFYMN.js";import{a as xt}from"./chunk-IOCZ22XI.js";import"./chunk-EJY3MW2I.js";import"./chunk-3VRAVMMN.js";import"./chunk-YJ45QIWT.js";import"./chunk-WR62TYUO.js";import{d as pt,f as jr}from"./chunk-2G2AXMFT.js";import{a as Zi}from"./chunk-XGFQCNHX.js";import"./chunk-7JF42X5G.js";import{a as rn,b as Fo}from"./chunk-4JZ3HIS7.js";import"./chunk-JLA5HXVC.js";import"./chunk-I4WIGQLD.js";import"./chunk-ZNGQ6IUR.js";import"./chunk-JERFAOJH.js";import"./chunk-JXZFOFB5.js";import"./chunk-LYNLETTP.js";import{a as tn,u as en}from"./chunk-FQ4XEVKF.js";import{c as Mi}from"./chunk-VMYDP774.js";import{a as Ni,b as td}from"./chunk-A7LNVEYU.js";import{b as Li,h as zl}from"./chunk-2YWUVAR3.js";import"./chunk-VA2HGDZT.js";import{b as ki,f as wi,g as Xl}from"./chunk-AKPDCNMH.js";import{$b as Do,Bb as Jl,C as Ci,D as Ii,Ea as Qe,Eb as Jr,F as Oo,Kb as Zl,L as we,Lb as Zr,Pa as Ei,Qa as Ke,Ra as bi,S as Ai,Sa as Po,V as No,W as _i,_b as ee,ba as yi,d as ui,da as Xr,db as vi,e as jl,la as te,m as $r,nb as Ri,o as Yr,pb as Oi,q as Ti,sb as zr,t as ke,u as Et,x as gi}from"./chunk-M54COW6Q.js";import"./chunk-PWWHYQAY.js";import{G as Ee,H as P,i as fi,m as Si}from"./chunk-RIJWHGTU.js";import{C as O,I as D,a as mi,u as L,v as Rt,y as pi,z as Kr}from"./chunk-K4MPEKC5.js";import"./chunk-X6USBUO5.js";import"./chunk-674MHQJQ.js";import{N as hi,X as Ro}from"./chunk-XIGC6FD5.js";import{a as W}from"./chunk-CXUPEGDW.js";import"./chunk-QAWZYDPQ.js";import"./chunk-PYTKRRY4.js";import"./chunk-363VDWOO.js";import"./chunk-7B5WANGL.js";import"./chunk-4P4FGPYZ.js";import"./chunk-Y47SQ3XQ.js";import"./chunk-CNUTE26Y.js";import"./chunk-LQTGDVAY.js";import"./chunk-YGNOWOE7.js";import"./chunk-N4GKTC7Y.js";import"./chunk-MHPFRLZZ.js";import"./chunk-IR63YTCE.js";import"./chunk-PATHAEX7.js";import"./chunk-664ZTB7N.js";import"./chunk-4WUMETG6.js";import"./chunk-TAJDMRFA.js";import"./chunk-YZ3HFF2L.js";import"./chunk-2BD64J7Y.js";import{a as Yl}from"./chunk-RYJHESAH.js";import"./chunk-DOQ5NSSP.js";import"./chunk-VULQOB2N.js";import{f as E,h as r,l as process,m as u,o as l}from"./chunk-ICCOEXX5.js";u();l();var Gr=E(W()),vt=E(Di()),Hr=E(xt());var Qr=E($r());D();u();l();var qr=E(W()),yl=E(xt());u();l();var au=E(W());u();l();var mr=E(W());var nu=({children:a,rootStore:t})=>{let e=hn(t),o=(0,mr.useMemo)(()=>(t.commonStore.rootStore=t,t.accountStore.rootStore=t,t),[t]);return mr.default.createElement(e.Provider,{value:o},a)};var cu=kt(({swapRootStore:a,bridgeRootStore:t,children:e,initTab:o})=>{let{commonStore:{currentTab:s}}=a.getInstance(),i=o||s,n=a.getInstance();return i===_.BRIDGE&&(n=t.getInstance()),au.default.createElement(nu,{rootStore:n},e)});u();l();var uu=E(W());D();function Rs({children:a,...t}){return uu.default.createElement(pi,{fetchConfig:fa.fetchConfig,...t},a)}u();l();u();l();u();l();u();l();var Cr=E(W());u();l();var hr=E(W());u();l();var pr=E(ed());async function ad(a,t){let{devid:e}=await a.get("devid");return(o,s)=>{pr.setDeviceId(e);let i=pr.newInstance({site:"okex",product:o});return i.setApiEndpoint(`${t}/amplitude`),i.setCommonParams(Fa()),s(i),i}}async function Os(a,t){(await ad(a,t))("web3_trade",Ma)}var cd=()=>{let[a,t]=(0,hr.useState)(!1);return(0,hr.useEffect)(()=>{let{getApiHostname:e}=v.global;Os(v.localStore,e()).then(()=>t(!0)).catch(()=>{})},[]),{initialized:a}},lu=cd;u();l();u();l();var uo=E(W());var du=a=>{let{params:t,replace:e}=Me(),{autoSwitch:o}=t,[s,i]=(0,uo.useState)(""),[n,c]=(0,uo.useState)(!0);return(0,uo.useEffect)(()=>{a&&(async()=>{if(a===_.SWAP&&o===Ya.BRIDGE){let m=await Qt.judgeTabTypeByParams(t?.from,t?.to);m===_.BRIDGE&&e({pathname:it,params:{...t,autoSwitch:void 0}}),i(m),c(!1)}else i(a),c(!1)})().catch(()=>{})},[a]),{tabType:s,autoSwitching:n}};u();l();var fr=E(W()),mu=E(xt());var pu=()=>{let{pathname:a}=(0,mu.useLocation)(),[t,e]=(0,fr.useState)("");return(0,fr.useEffect)(()=>{switch(a){case Xo:case st:e(_.SWAP);break;case it:e(_.BRIDGE);break;default:break}},[a]),t};u();l();var Ns=E(W());var hu=(a,t)=>{let{accountStore:e}=Y(),{params:o}=Me(),{btcAddressType:s}=o;(0,Ns.useEffect)(()=>{e.setBtcAddressType(s)},[]);let i=Xa();(0,Ns.useEffect)(()=>{async function n(){let c=new Qt(a,o),{from:d,to:m,tab:p,inputAmount:S,error:T}=await c.initTokenPair(t);T||i(d,m,S,p)}a&&n().catch(()=>{})},[a])};u();l();var fu=E(W()),Su=E(xt());var Tu=a=>{let{fromToStore:t}=Y(),{from:e,to:o}=t,{params:s,replace:i}=Me(),{pathname:n}=(0,Su.useLocation)(),c=za();(0,fu.useEffect)(()=>{let d=c(e,o);d&&a&&[st,it].includes(n)&&(new Qt(a).writeTabInfoToLocalStorage(d),i({params:{...d,feeConfig:s.feeConfig}}))},[e?.chainId,e?.tokenContractAddress,o?.chainId,o?.tokenContractAddress,a,n])};var ud=a=>{let t=pu(),{tabType:e}=du(t);hu(e,a),Tu(e)},gu=ud;u();l();var Au=E(W());u();l();function ld(a){return new Promise(t=>setTimeout(t,a))}async function Cu(a,t=3,e=0){let o;for(let s=0;s<t;s++)try{return await a()}catch(i){o=i,e&&s<t-1&&await ld(e)}throw o}function dd(a,t,e){let o=yt();return{promise:a(t,{...e,signal:o.signal}),cancel:()=>o.abort()}}function md(a,t,e){if(rt())return dd(a,t,e);let o=new AbortController,s=o.signal;return{promise:a(t,{...e,signal:s}),cancel:()=>o.abort()}}function Iu(a,t){return md(k.get,a,t)}function _u(){let{accountStore:a,receiveAddressStore:t}=Y(),{address:e,setUserForbiddenBridge:o}=a,{receiveAddrObj:s,computedSwapHighLight:i}=t,{specifiedAddress:n}=s||{};(0,Au.useEffect)(()=>{let c=()=>{};if(e&&i){let{promise:d,cancel:m}=Iu(la,{params:{userWalletAddress:e,receiveWalletAddress:n}});c=m,d.then(p=>{o(p?.data.blackListTypes||re)}).catch(()=>{o(re)})}else o(re);return c},[e,o,n,i])}u();l();var yu=E(W());function Ps(){let{accountStore:{address:a}}=Y();(0,yu.useEffect)(()=>{b.setTags({address:a})},[a])}u();l();var Eu=E(W());var pd=()=>{let a=Si(),{commonStore:t}=Y();(0,Eu.useEffect)(()=>{t.setCurrentTheme(a)},[a,t])},ku=pd;u();l();var wu=E(W());var hd=()=>{let{accountStore:a,fromToStore:t,approveStore:e,recentTransactionStore:o,tokenModalStore:s}=Y();(0,wu.useEffect)(()=>{let{computedAccountWalletAddresses:i}=a;return i&&(Kt.addListen("error",()=>{e.onSocketError(),o.onSocketError(),t.setNeedBalanceLoading(!1),t.getSwapTokenBalance(),s.reloadTokenList()}),Kt.addListen(ks.DEX_PUSH_ENGINE,n=>{o.onSocket(n),e.onSocket(n)}),Kt.addListen(ks.WALLET_ASSET,n=>{n&&(s.updateAllTokenList(n),t.updateFromBalancePush(n))}),Kt.init(i)),()=>{Kt.removeAll(),Kt.wsInstance&&i&&Kt.logout(i)}},[a.computedAccountWalletAddresses,o.onSocket,s.updateAllTokenList,t.updateFromBalancePush,a,o,s])},Lu=hd;u();l();var jt=E(W()),bu=E(xt());var fd=({currency:a,currentWallet:t,walletInfo:e,keyringIdentityTypeEnum:o,addressBookList:s,walletList:i,t:n,dispatch:c,currentTab:d,onBack:m})=>{let{commonStore:p,accountStore:S,recentTransactionStore:T,reset:I}=Y(),A=(0,bu.useHistory)();(0,jt.useEffect)(()=>{v.setRuntimeContext({history:A,toLocale:n,dispatch:c,walletInfo:e,onBack:m})},[n,A,c,e,m]),(0,jt.useEffect)(()=>{t&&S.setWalletConfig(t)},[t]),(0,jt.useEffect)(()=>(p.getUserUnit(a),p.fetchChainList({businessLine:1,currentTab:d}).catch(()=>{p.setChainListLoadError(!0)}),()=>{I()}),[]),(0,jt.useEffect)(()=>{S.setAddressBookList(s)},[s]),(0,jt.useEffect)(()=>{S.setWalletList(i)},[i]),(0,jt.useEffect)(()=>{S.setKeyringIdentityTypeEnum(o)},[o]),(0,jt.useEffect)(()=>{t.walletId?T.updatePendingOrders(t.walletId):T.setPendingOrders([])},[t.walletId,d]),Ja()},vu=fd;u();l();var St=E(W()),Yt=E(xt());u();l();var lo=E(W()),gr=E(xt()),Mu=E(id());u();l();var Ru=E(W());var Sd=({visible:a,onBack:t=()=>{},params:e})=>{let{useCoin:o}=v.hooks,{coinId:s,receiveOnly:i,chainId:n,tokenContractAddress:c}=e,d=o(n,c);return a&&Ru.default.createElement(v.components.SupplyGas,{visible:a,closeCallback:t,coinId:s||d.coinId,receiveOnly:i})},Ou=Sd;u();l();var Sr=E(W()),xu=E(xt());u();l();var Nu=E(W());var Td=()=>{let{components:{Mev:a}}=v,{quoteStore:{quote:t},mevStore:e}=Y(),{bestRoute:o}=t||{},{fromToken:s,toToken:i}=o||{},n=o?.isEnableMev,{computedIsMevOpen:c,setMevUserSwitchOpen:d,setMevInfo:m}=e,p=!c&&Number(n)===Qo.ON;return Nu.default.createElement(a,{isMev:c,chainId:s?.chainId,toChainId:i?.chainId,isShowBlockSwapMevTooltip:p,onMevChange:(S,T)=>{d(S),m(T)}})},Pu=kt(Td);var gd=[It,Ot],Du={[st]:"swaptrade_card_swap_title_swap",[it]:"swaptrade_card_swap_title_swap",[Ot]:"",[It]:"swaptrade_extension_cinteraction_contract_interaction",[eo]:"swaptrade_recent_transaction_detail_dialog_title"},Cd=a=>{let t="",e=null,o=!1,s=!1,i=a.pathname,{type:n}=Da(a.search),c=n===ot.INTENT_SWAP,d=p=>h(Du[p]),m=gd.find(p=>i.startsWith(p));return m===a.pathname?t=d(m):m===Ot&&m!==a.pathname?t=h(Du[eo]):t=d(i),(i===st||i===it)&&(o=!0),i===st&&(s=!0),i===It&&!c&&(e=Sr.default.createElement(Pu,null)),{title:t,rightIcon:e,settingIcon:o,isAllowShareBlinkPath:s}},Id=()=>{let a=(0,xu.useLocation)();return(0,Sr.useMemo)(()=>Cd(a),[a])},Fu=Id;u();l();var Tr={wrapper:"_wrapper_bmqyn_1",container:"_container_bmqyn_5"};var Ad=[st,it],_d=({children:a,onBack:t})=>{let{title:e,isGray:o,rightIcon:s,settingIcon:i,isAllowShareBlinkPath:n}=Fu(),c=(0,gr.useLocation)(),d=(0,gr.useHistory)(),{fromToStore:m,swapStore:p,tradeModeStore:S}=Y(),{visibleAddFunds:T,addFundsParams:I,closeAddFunds:A}=m,{walletSnapSwitchVisible:R,setWalletSnapSwitchVisible:w}=S,q=tc(),K=()=>{w(!R)},nt=()=>{c.pathname===It&&Fe({...p.getSaveOrderMonitorData(),button_name:"back"}),t?t(d.goBack,Ad.includes(c.pathname)):d.goBack()};return lo.default.createElement("div",{className:(0,Mu.default)("universe-swap background-base-primary",Tr.wrapper,{[Tr.grey]:o})},lo.default.createElement(Za,{title:e,onBack:nt,rightIcon:s,settingIcon:i,settingIconClick:K,showShareBlinkIcon:q&&n}),lo.default.createElement("div",{className:Tr.container},a),lo.default.createElement(Ou,{visible:T,params:I,onBack:A}))},Bu=kt(_d);var yd=(0,St.lazy)(()=>import("./Swap-NF7OYUVP.js")),Ed=(0,St.lazy)(()=>import("./Bridge-BF7U2XGS.js")),kd=(0,St.lazy)(()=>import("./OrderDetail-X2VJJTQ3.js")),wd=(0,St.lazy)(()=>import("./Contract-GVJMRKDG.js")),Ld=({onBack:a})=>{let t=(0,Yt.useLocation)();return St.default.createElement(Bu,{onBack:a},St.default.createElement(St.Suspense,null,St.default.createElement(Yt.Switch,null,[{path:st,component:yd,exact:!0},{path:it,component:Ed,exact:!0},{path:eo,component:kd,exact:!0},{path:It,component:wd,exact:!0}].map((o,s)=>St.default.createElement(Yt.Route,{key:s,path:o.path,component:o.component,exact:o.exact})),St.default.createElement(Yt.Redirect,{from:Xo,to:{pathname:st,search:t.search},strict:!0,exact:!0}))))},Uu=Ld;var bd=({currency:a,currentWallet:t,keyringIdentityTypeEnum:e,addressBookList:o,walletList:s,walletInfo:i,onBack:n,t:c,dispatch:d,currentTab:m=_.SWAP})=>{gu(i.chainId),ku(),vu({currency:a,currentWallet:t,walletInfo:i,keyringIdentityTypeEnum:e,addressBookList:o,walletList:s,t:c,dispatch:d,currentTab:m,onBack:n}),_u(),Lu(),Ps();let{initialized:p}=lu();return p?Cr.default.createElement(Uu,{onBack:n}):null},Wu=(0,Cr.memo)(kt(bd));u();l();D();u();l();u();l();u();l();u();l();var Vu=(a,t)=>{let e=a.split(".").map(Number),o=t.split(".").map(Number),s=Math.max(e.length,o.length);for(let i=0;i<s;i++){let n=e[i]||0,c=o[i]||0;if(n>c)return 1;if(n<c)return-1}return 0};var mo=class{constructor(){r(this,"btcAddressType","");r(this,"setBtcAddressType",t=>{this.btcAddressType=t});r(this,"commonStore",null);r(this,"scanAppType",{});r(this,"walletType",{});r(this,"initWalletConstants",async()=>{let t=await this.getWalletConstants();this.scanAppType=t.SCANING_APP_TYPE,this.walletType=t.WALLET_TYPE});r(this,"userForbiddenWithBridge",re);r(this,"setUserForbiddenBridge",t=>{this.userForbiddenWithBridge=t});r(this,"defaultWalletConfig",bn);r(this,"walletConfig",this.defaultWalletConfig);r(this,"hasInitWalletInfo",!1);r(this,"chainId",$t);r(this,"setChainId",t=>{this.chainId=t});r(this,"fromChainId",$t);r(this,"setFromChainId",t=>{this.fromChainId=t});r(this,"walletSupportMev",!1);r(this,"setWalletSupportMev",t=>{this.walletSupportMev=t});r(this,"checkOkxVersion",async()=>{let t="2.82.31",e=this.walletConfig.isOkxWallet;if(this.isConnectedWallet&&e&&window?.okxwallet?.getVersion){let o=await window.okxwallet.getVersion(),i=Vu(o,t)>=0;this.setWalletSupportMev(i)}else this.setWalletSupportMev(!1)});this.initWalletConstants().catch(()=>{})}getDeviceId(){}getChainId(){}getWalletConstants(){}get address(){return $t}get computedForbiddenBridge(){let{computedIsCrossChain:t}=this.rootStore.fromToStore;return t?this.userForbiddenWithBridge:re}get computedAccountId(){let{walletConfig:t}=this;return t.walletId}setWalletConfig(t={}){this.walletConfig=t}getAddressByChainId(){}get isConnectedWallet(){return!!this.walletConfig.walletId}get computedNonsupportChain(){return!this.isConnectedWallet||!G(this.fromChainId)?!1:!this.address}get computedAccountWalletAddresses(){return De(y(this,"walletConfig.address",[])).join(",")||this.address}get computedAccountWalletAddressesArray(){return De(y(this,"walletConfig.address",[]))||[this.address]}get computedSpecialWalletAddress(){return this.getAddressByChainId(B.BTC_MAINNET)}};u();l();u();l();function Tt(a=[],t=[]){let e={};a.forEach(s=>{e[s]=$e});let o={};return t.forEach(s=>{o[s]=mn}),{...e,...o}}var qu=Tt(["scanAppType","walletType","walletConfig","chainId","hasInitWalletInfo","fromChainId","btcAddressType"],["computedAccountId","isConnectedWallet","computedNonsupportChain","computedAccountWalletAddresses","computedAccountWalletAddressesArray","address","computedSpecialWalletAddress"]);var Ds=class extends mo{constructor(e){super();r(this,"formatWalletType",()=>{let{walletInfo:e}=v,{isHARDWARE:o,isMNEMONIC:s,isMPC:i,isPRIVATE:n}=e?.walletType||{};return o?Wt.HARDWARE:s?Wt.MNEMONIC:i?Wt.MPC:n?Wt.PRIVATE_KEY:null});r(this,"formatWalletAccount",e=>{let o=Object.values(e.account);return{...e,OKXWalletType:this.formatWalletType(),address:o}});r(this,"keyringIdentityTypeEnum",{});r(this,"walletList",[]);r(this,"addressBookList",[]);r(this,"hasInitWalletInfo",!1);r(this,"getAddressByChainId",e=>{if(!G(e))return $t;let o=this.getWalletChainName(e);return this.walletConfig.account?.[o]||$t});this.rootStore=e,this.commonStore=e.commonStore,ct(this,qu)}async getDeviceId(){let{devid:e}=await v.localStore.get("devid");return e}getCurrentChainAddress(e){let o=this.rootStore?.fromToStore.from.chainId;if(!G(o))return $t;let s=this.getWalletChainName(o);return e.account[s]}getWalletConstants(){return{SCANING_APP_TYPE:"1",WALLET_TYPE:"2"}}getWalletChainName(e){return v.getNetWorkName(e)}replaceBtcAddressByType(e){if(this.btcAddressType){let o=this.getWalletChainName(B.BTC_MAINNET);if(e.account?.[o]){let i=e.accountsMap?.bitcoin?.[this.btcAddressType]?.address;if(i)return{...e,account:{...e.account,[o]:i}}}}return e}setWalletConfig(e){this.walletConfig=this.formatWalletAccount(this.replaceBtcAddressByType(e)),this.hasInitWalletInfo=!0}webSwapHistoryDetailViewMore(){}setAddressBookList(e){this.addressBookList=e}setWalletList(e){this.walletList=e.map(o=>o.walletId===this.computedAccountId?this.replaceBtcAddressByType(o):o)}setKeyringIdentityTypeEnum(e){this.keyringIdentityTypeEnum=e}get address(){return this.getAddressByChainId(this.fromChainId)}},Gu=Ds;u();l();u();l();D();u();l();var dt={COLLECT_LIST:"COLLECT_LIST",ALL_NETWORK:"ALL_NETWORK",CHAIN_LIST:"CHAIN_LIST",SEARCH:"SEARCH",ALL_TOKENS:"ALL_TOKENS"},vd={[dt.COLLECT_LIST]:{[_.SWAP]:zn,[_.LIMIT_ORDER]:Xn,[_.BRIDGE]:Jn},[dt.ALL_NETWORK]:{[_.SWAP]:jn,[_.LIMIT_ORDER]:$n,[_.BRIDGE]:Yn},[dt.SEARCH]:{[_.SWAP]:ta,[_.LIMIT_ORDER]:Zn,[_.BRIDGE]:ea},[dt.CHAIN_LIST]:{[_.SWAP]:Bn,[_.LIMIT_ORDER]:Wn,[_.BRIDGE]:Un},[dt.ALL_TOKENS]:{[_.SWAP]:Ts,[_.LIMIT_ORDER]:Ts,[_.BRIDGE]:Rn}},Dt=(a,t)=>vd[a]?.[t]??"";u();l();var xs=a=>!!(a?.isNativeToken===fn.TRUE||a?.isBaseCoin),Ir=a=>a?G(a.chainId)&&a.tokenContractAddress:!1;var po=class{constructor(t){r(this,"rootStore",null);r(this,"userUniqueId",$a());r(this,"chainListFreshCount",0);r(this,"chainList",[]);r(this,"setChainList",t=>{this.chainList=t,this.chainListFreshCount+=1});r(this,"transactionLoading",!1);r(this,"setTransactionLoading",t=>{this.transactionLoading=t});r(this,"nowCurrencyUnit",{});r(this,"tokenModalVisible",!1);r(this,"safemoonSlippage",0);r(this,"fetchChainList",async({businessLine:t=1,isLimit:e=!1,isHistory:o=!1,currentTab:s})=>{if(mi())return[];let i=Dt(dt.CHAIN_LIST,this.currentTab||s),n=await k.get(i,{params:{businessLine:e?Nt.LIMIT_ORDER:t}});return!o&&this.setChainList(n?.data),this.setCurrentTabChainList({[e?_.LIMIT_ORDER:_.SWAP]:n?.data}),n?.data});r(this,"currentTabChainList",{});r(this,"setCurrentTabChainList",t=>{this.currentTabChainList={...this.currentTabChainList,...t}});r(this,"getTradeType",()=>this.rootStore?.fromToStore?.computedIsCrossChain?Ss.MULTI:Ss.SINGLE);r(this,"globalMessages",null);r(this,"setGlobalMessage",t=>{this.globalMessages=t});r(this,"cleanGlobalMessage",()=>{this.globalMessages=null});r(this,"socketStatus",!1);r(this,"balancePushSocketStatus",!1);r(this,"resetFromToByTabChange",!1);r(this,"setResetFromToByTabChange",t=>{this.resetFromToByTabChange=t});r(this,"portal",_t.DEX);r(this,"setPortal",t=>{this.portal=t});r(this,"currencyConversion",t=>{let{usdToThisRate:e}=this.nowCurrencyUnit,o=g.BigNumber(t);return!e||o.isNaN()?"":o.multipliedBy(e)});r(this,"isSensitiveChain",t=>this.computedSensitiveChainIds.some(e=>String(e)===String(t)));r(this,"getTokenAddress",t=>{let e=this.isSensitiveChain(t?.chainId),o=t?.tokenContractAddress||t?.tokenAddress;return e?o:Pt(o)});r(this,"equalsToken",(t,e)=>{let o=t!==null&&String(t?.chainId)===String(e?.chainId);return xs(t)&&xs(e)?o:o&&this.getTokenAddress(t)===this.getTokenAddress(e)});r(this,"fromFillToken",!1);r(this,"currentTab","");r(this,"setCurrentTab",(t,e)=>{this.currentTab!==t&&(this.setResetFromToByTabChange(!0),this.rootStore?.fromToStore?.clearFromTo()),this.currentTab=t,this.fromFillToken=!!e});r(this,"marketWsIsConnected",!1);r(this,"setMarketWsIsConnected",t=>{this.marketWsIsConnected=t});r(this,"forceUpdateFromToByHash",0);r(this,"forceUpdateFromTo",()=>{this.forceUpdateFromToByHash+=1});r(this,"currentTheme","");r(this,"setCurrentTheme",t=>{this.currentTheme=t});r(this,"isFirstInit",!0);this.rootStore=t,Be&&this.setPortal(_t.LEDGER)}setChainType(){}get computedReserveGas(){let{chainList:t}=this,e=this.rootStore.fromToStore.from.chainId;return t.find(s=>Number(s.chainId)===Number(e))?.reserveGas||""}getChainByID(t){return this.chainList.find(e=>(this.computedCurrentTabIsLimit||e.chainUsed)&&e.chainId===Number(t))}getUserUnit(){}get computedRealSlippageValue(){return y(this,"rootStore.slippageStore",{}).computedRealSlippageValue||0}setSocketStatus(t){this.socketStatus=t}setBalanceSocketStatus(t){this.balancePushSocketStatus=t}get computedIsWalletEnv(){return this.portal===_t.OKX_WALLET_EXTENSION}get computedIsWalletDashBoard(){return this.portal===_t.WALLET_DASHBOARD}get computedIsMarket(){return this.portal===_t.MARKET}get computedNotThirdBiz(){return this.portal===_t.OKX_WALLET_EXTENSION||this.portal===_t.DEX||this.portal===_t.MARKET}get computedNowCurrencySymbol(){return this.nowCurrencyUnit.symbol||""}get computedSensitiveChainIds(){return this.chainList.map(t=>Number(t.isSensitive)===Cn.YES?t.chainId:null).filter(Boolean)}get computedCurrentTabIsLimit(){return this.currentTab===_.LIMIT_ORDER}get computedIsUrlFillSwap(){return this.computedIsWalletDashBoard||this.computedIsWalletEnv}toBaseFormatUSD(t,e){let o=this.computedNowCurrencySymbol,s=this.nowCurrencyUnit?.usdToThisRate,i=g.BigNumber(t).multipliedBy(s).toString();return et(i,o,{needPlaceholder:!0,...e})}setIsFirstInit(t){this.isFirstInit=t}};u();l();var Hu=Tt(["userUniqueId","chainList","transactionLoading","nowCurrencyUnit","tokenModalVisible","safemoonSlippage","globalMessages","socketStatus","balancePushSocketStatus","portal","currentTab","currentTabChainList","forceUpdateFromToByHash","marketWsIsConnected","currentTheme","isFirstInit"],["computedReserveGas","computedNowCurrencySymbol","computedSensitiveChainIds","computedIsWalletEnv","computedCurrentTabIsLimit"]);var ho=class extends po{constructor(e){super(e);r(this,"swapCollapse",!1);r(this,"setSwapCollapse",e=>{this.swapCollapse=e});r(this,"chainListLoadError",!1);r(this,"setChainListLoadError",e=>{this.chainListLoadError=e});ct(this,{...Hu,swapCollapse:$e,chainListLoadError:$e}),this.setPortal(kn)}getUserUnit(e){this.nowCurrencyUnit=e}};u();l();var fo=class{constructor(){r(this,"snapModeSwitch",!1);r(this,"setSnapModeSwitch",t=>{this.snapModeSwitch=t,this.resetTradingModeBySwitch(t)});r(this,"isSupportSnapChain",!1);r(this,"isMetSnap",Go.NOT_SUPPORT);r(this,"tradingModeType","");r(this,"walletSnapSwitchVisible",!1);r(this,"setWalletSnapSwitchVisible",t=>{this.walletSnapSwitchVisible=t});r(this,"bestPriceTag",cs.NO_COMPARE);r(this,"setBestPriceTag",t=>{this.bestPriceTag=t});x(this,{},{autoBind:!0})}resetTradingModeBySwitch(t,e){e&&!this.tradingModeType||(this.setTradingModeType(t?Vt.COMPARE_MODE:Vt.AUTO),this.setBestPriceTag(cs.NO_COMPARE))}setIsSupportSnapChain(t){this.isSupportSnapChain=t}setIsMetSnap(t){this.isMetSnap=t}setTradingModeType(t){this.tradingModeType=t}get computedIsSnapType(){return this.tradingModeType===Vt.SNAP_MODE}};u();l();D();var So=class{constructor(t){r(this,"showLimitDialog",!1);r(this,"setShowLimitDialog",t=>{this.showLimitDialog=t});r(this,"cancelRef",null);r(this,"callbackList",[]);r(this,"addToCallbackList",t=>{this.callbackList.push(t)});r(this,"removeFromCallbackList",t=>{this.callbackList=this.callbackList.filter(e=>e!==t)});r(this,"updateTokenCollectStatus",async({tokenInfo:t,callBack:e})=>{let{isConnectedWallet:o}=this.accountStore;if(!o){this.walletWarnInterceptor();return}this.cancelRef&&this.cancelRef.abort(),this.cancelRef=yt();let s={tokenContractAddress:t?.tokenContractAddress,chainId:Number(t?.chainId),symbol:t?.tokenSymbol,decimal:t?.decimals,walletAddress:this.accountStore.getAddressByChainId(Number(t?.chainId))||this.accountStore.computedAccountWalletAddresses,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,mnemonicWallet:this.accountStore.computedAccountWalletAddresses,isCustomToken:t?.isCustomToken||t?.isSubscribe},[i,n]=await O(k.post(Yo,s,{signal:this.cancelRef.signal}));if(!Ht(i)&&i)P.error(h("swaptrade_pricechart_no_connection_desc"));else if(n){if(n?.data===-1)this.setShowLimitDialog(!0);else if(n?.data===0)P.success({title:h("swaptrade_selecttoken_toast_removed_from_favorite"),duration:At}),e({selected:!1,tokenInfo:t}),this.callbackList.forEach(c=>{c({selected:!1,tokenInfo:t})});else if(n?.data===1){let c=Ga(),{isMarketHomeUrl:d}=Ha();!d&&er({business_type:c?ds.LIMIT_ORDER:ds.SWAP}),P.success({title:h("swaptrade_selecttoken_toast_added_to_favorite"),duration:At}),e({selected:!0,tokenInfo:t}),this.callbackList.forEach(m=>{m({selected:!0,tokenInfo:t})})}}});r(this,"debounceUpdateTokenCollectStatus",Jo(this.updateTokenCollectStatus,500));r(this,"walletWarnInterceptor",()=>{P.error({title:h("swaptrade_selecttoken_toast_connect_wallet"),duration:At})});this.rootStore=t,this.commonStore=t.commonStore,this.accountStore=t.accountStore,x(this,{},{autoBind:!0})}};var ie=class{constructor(){ie.instance?(this.commonStore=ie.instance.commonStore,this.accountStore=ie.instance.accountStore,this.updateCollectionStore=ie.instance.updateCollectionStore):(this.commonStore=new ho(this),this.accountStore=new Gu(this),this.updateCollectionStore=new So(this),ie.instance=this),this.tradeModeStore=new fo(this)}},ne=ie;r(ne,"instance",null);u();l();u();l();D();u();l();function Ar(a){return[Pe.USER_DENIED,Pe.WC2Denied].includes(a?.code)}var Fs=class{constructor(t){r(this,"approveTokenDefaultConfig",{status:F.Unknown,approvedAmount:"0"});r(this,"approveTokensConfig",{});r(this,"getApproveTokenMapKey",(t,e)=>{let o=this.commonStore.getTokenAddress(t);return`${t.chainId}_${o}_${e}`});r(this,"registerApproveToken",(t,e)=>{let o=this.getApproveTokenMapKey(t,e),s=y(this.approveTokensConfig,o);X(s)&&(this.approveTokensConfig[o]={...this.approveTokenDefaultConfig})});r(this,"registerCurrentApproveToken",()=>{let{token:t,tradeModeCode:e}=this.computedTokenAndTradeModeCode;this.registerApproveToken(t,e)});r(this,"updateApproveTokenConfig",(t,e,o)=>{let s=this.getApproveTokenMapKey(t,e),i=y(this.approveTokensConfig,s);X(i)?b.stuff("if you want to update approve token config, you should register it first."):this.approveTokensConfig[s]={...i,...o}});r(this,"removeApproveTokenConfig",(t,e)=>{let o=this.getApproveTokenMapKey(t,e);delete this.approveTokensConfig[o]});r(this,"updateCurrentApproveTokenConfig",t=>{let{token:e,tradeModeCode:o}=this.computedTokenAndTradeModeCode;this.updateApproveTokenConfig(e,o,t)});r(this,"getApproveTokenConfig",(t,e)=>{let o=this.getApproveTokenMapKey(t,e);return y(this.approveTokensConfig,o,this.approveTokenDefaultConfig)});r(this,"clearNonApprovingTokensConfig",()=>{let t=wa(this.approveTokensConfig,e=>[F.Approving,F.CancelApproving].includes(e.status));this.approveTokensConfig={...t}});r(this,"isApprovalCheckRequired",()=>{let{computedIsSolanaChain:t,computedIsAptosChain:e}=this.fromToStore,{quote:{bestRoute:o}}=this.rootStore.quoteStore,s=this.commonStore.computedCurrentTabIsLimit,{token:i}=this.computedTokenAndTradeModeCode,{isNativeToken:n}=i;return(s?!0:o?.needApprove==="1")&&!n&&!t&&!e});r(this,"validApproveAmountLessSwapAmount",t=>{let{token:e}=this.computedTokenAndTradeModeCode;return g.BigNumber(t).isLessThan(e.amount||"0")});r(this,"isValidApprovalStatus",(t,e)=>{let o=qt(t),s=this.validApproveAmountLessSwapAmount(t);return o?F.UnApproved:s&&e?F.CancelApprove:s?F.UnApproved:F.Approved});r(this,"generateApproveRequestParams",t=>{let{address:e}=this.accountStore,{token:o,tradeModeCode:s}=this.computedTokenAndTradeModeCode,{tokenContractAddress:i,chainId:n}=o,{computedIsDexQuote:c}=this.rootStore.quoteStore;return{userWalletAddress:e,tokenContractAddress:i,chainId:n,cancelApproveTag:t,...c?{}:{intentCode:s}}});r(this,"fetchApproveAllowance",()=>k.get(Hn,{params:this.generateApproveRequestParams()}).then(t=>t?.data));r(this,"fetchApproveData",t=>{let e=this.generateApproveRequestParams(t);return k.get(Qn,{params:e}).then(o=>{let{id:s,data:i,from:n,to:c,unsignedTx:d}=o?.data||{},m={data:i,from:n,to:c};return b.info(N.APPROVE_DATA,{id:s,data:i,from:n,to:c,unsignedTx:d,cancelApproveTag:t}),ir(e.chainId)&&(m=JSON.parse(d)),{transactionPayload:m,id:s}})});r(this,"approveStatusIsPending",()=>[F.Approving,F.CancelApproving].includes(this.computedApprovalStatus));r(this,"isPendingNeedCheck",async()=>{this.approveStatusIsPending()&&this.checkApprove().catch(()=>{})});r(this,"isPendingNotCheck",async()=>{this.approveStatusIsPending()||this.checkApprove().catch(()=>{})});r(this,"checkApprove",async()=>{let{token:t,tradeModeCode:e}=this.computedTokenAndTradeModeCode;if(this.registerApproveToken(t,e),!this.isApprovalCheckRequired()){this.updateApproveTokenConfig(t,e,{status:F.Approved});return}let{tokenContractAddress:o,decimals:s}=t,{address:i}=this.accountStore;if(o&&i){let[,n]=await O(this.fetchApproveAllowance());if(!n){this.updateApproveTokenConfig(t,e,{status:F.Unknown});return}let c=Number(n.status)===F.Approved?n.amount:"0",d=xe(c,s)||"0",m=n?.needCancelApproveToken,p=this.isValidApprovalStatus(d,m);this.updateApproveTokenConfig(t,e,{status:p,approvedAmount:d})}});r(this,"fetchApproveDataErrorTips",(t,e)=>{this.updateCurrentApproveTokenConfig({status:F.UnApproved});let o=U(t?.tokenSymbol);ar({title:e?h("swaptrade_transfer_notification_title_ccy_unrevoked",{ccy:o}):h("swaptrade_toast_approve_fail",{tokenSymbol:o})})});r(this,"approveErrorTips",({error:t,chainId:e,transactionPayload:o,token:s,tradeModeCode:i,cancelApproveTag:n})=>{b.error(N.APPROVE_TOKEN_ERROR,{chainId:e,transactionPayload:o,error:t,token:s,tradeModeCode:i}),Ar(t)||Ee.error({title:h("swaptrade_home_toast_broadcast_failed")}),this.updateApproveTokenConfig(s,i,{status:this.isCancelApprove(n)?F.CancelApprove:F.UnApproved})});r(this,"isCancelApprove",t=>t===Le.CANCEL_APPROVE);r(this,"setApprove",async t=>{let{token:e,tradeModeCode:o}=this.computedTokenAndTradeModeCode,{chainId:s}=e;this.updateApproveTokenConfig(e,o,{status:this.isCancelApprove(t)?F.CancelApproving:F.Approving});try{let{id:i,transactionPayload:n}=await this.fetchApproveData(t);await this.approveToken({chainId:s,transactionPayload:n}).then(({result:c})=>this.saveApprove({id:i,chainId:s,transactionHash:c,cancelApproveTag:t})).catch(c=>{this.approveErrorTips({error:c,chainId:s,transactionPayload:n,token:e,tradeModeCode:o,cancelApproveTag:t})})}catch{this.fetchApproveDataErrorTips(e,t)}});r(this,"saveApprove",async({id:t,chainId:e,transactionHash:o,cancelApproveTag:s})=>{if(!o)return;let{address:i}=this.accountStore;b.info(N.SAVE_APPROVE,{id:t,transactionHash:o,chainId:e,userWalletAddress:i,cancelApproveTag:s});try{await k.post(Kn,{id:t,transactionHash:o,chainId:e,userWalletAddress:i,cancelApproveTag:s})}catch(n){b.info(N.SAVE_APPROVE_ERROR,{error:n?.message,id:t,transactionHash:o,chainId:e,userWalletAddress:i,cancelApproveTag:s})}});r(this,"onSocket",async t=>{if(t?.type==="1"&&t?.dexData&&t.dexData.type==="approve"){let e=t.dexData,{status:o,transactionHash:s,fromTokenSymbol:i,fromTokenAddress:n,exploreUrl:c,solanaToast:d,intentCode:m=Ho}=e,p=rt();if(d==="1"){if(p)return;let w=o===be.CANCEL_APPROVE_SUBMITTED?"swaptrade_transfer_toast_ccy_unrevoke_submit":"swaptrade_transfer_notification_approval_submit";nr({title:h(w,{ccy:U(i)})});return}let{token:S,tradeModeCode:T}=this.computedTokenAndTradeModeCode,I={chainId:e.chainId,tokenContractAddress:n},A=this.commonStore.equalsToken(S,I),R=String(T)===String(m);if(A&&R&&await this.isPendingNeedCheck(),(!A||A&&!R)&&this.removeApproveTokenConfig(I,m),o===be.APPROVE_SUCCESS){let w=h("swaptrade_toast_approve_success",{tokenSymbol:U(i)});!p&&nr({title:w,exploreUrl:c}),co.emit(ao.APPROVE,{data:s,status:0,message:w})}else if(o===be.APPROVE_FAILED&&!p){let w=h("swaptrade_toast_approve_fail",{tokenSymbol:U(i)});ar(w,c)}else if(o===be.CANCEL_APPROVE_SUCCESS&&!p){let w=h("swaptrade_transfer_notification_title_ccy_revoked",{ccy:U(i)});nr(w,c)}else if(o===be.CANCEL_APPROVE_FAILED&&!p){let w=h("swaptrade_transfer_notification_title_ccy_unrevoked",{ccy:U(i)});ar({title:w,exploreUrl:c})}}});r(this,"onSocketError",()=>{this.isPendingNeedCheck().catch(()=>{})});this.rootStore=t,this.accountStore=t.accountStore,this.commonStore=t.commonStore,this.fromToStore=t.fromToStore}get computedApprovalStatus(){let{token:t,tradeModeCode:e}=this.computedTokenAndTradeModeCode;return this.getApproveTokenConfig(t,e).status}get computedTokenAndTradeModeCode(){let{from:t}=this.fromToStore,{tradingModeType:e}=this.rootStore.tradeModeStore;return{token:t,tradeModeCode:e}}get computedIsCancelApproveStatus(){return[F.CancelApprove,F.CancelApproving].includes(this.computedApprovalStatus)}approveToken(){}},Qu=Fs;u();l();var Ku=Symbol(),$u=Object.prototype,Od=(a,t,e)=>{if(pn(a))throw new Error("Target must not be observable");let o=a[Ku];if(o){let s={};for(let i in a)o[i]&&(s[i]=o[i]);o=s}else{o={};let s=a;for(;s&&s!==$u;)Reflect.ownKeys(s).forEach(n=>{n===dn||n==="constructor"||(o[n]=t&&n in t?t[n]:!0)}),s=Object.getPrototypeOf(s);let i=Object.getPrototypeOf(a);i&&i!==$u&&Object.defineProperty(i,Ku,{value:o})}return ct(a,o,e)},Xt=Od;var ae=class extends Qu{constructor(e){super(e);r(this,"visibleApprove",!1);r(this,"setVisibilityApprove",e=>{this.visibleApprove=e});r(this,"approveInfo",{});r(this,"setApproveInfo",e=>{this.approveInfo=e});r(this,"setApprove",async(e=Le.APPROVE)=>{let{token:o,tradeModeCode:s}=this.computedTokenAndTradeModeCode,{chainId:i}=o;this.updateApproveTokenConfig(o,s,{status:this.isCancelApprove(e)?F.CancelApproving:F.Approving});try{let{id:n,transactionPayload:c}=await this.fetchApproveData(e);this.setApproveInfo({chainId:i,id:n,transactionPayload:c,token:o,tradeModeCode:s,cancelApproveTag:e}),this.setVisibilityApprove(!0)}catch{this.fetchApproveDataErrorTips(o,e)}});r(this,"approveCancel",()=>{let e=this.approveInfo.cancelApproveTag;this.setApproveInfo({}),this.setVisibilityApprove(!1),this.updateCurrentApproveTokenConfig({status:this.isCancelApprove(e)?F.CancelApprove:F.UnApproved})});r(this,"approveConfirm",async({txHash:e,error:o})=>{if(o){this.approveErrorTips({error:o,...this.approveInfo}),this.approveCancel();return}let{id:s,chainId:i,cancelApproveTag:n}=this.approveInfo;await this.saveApprove({id:s,chainId:i,transactionHash:e,cancelApproveTag:n}),this.setVisibilityApprove(!1),this.setApproveInfo({})});Xt(this)}};u();l();D();u();l();var ce=()=>{let{fromToStore:a,gasDropStore:t,receiveAddressStore:e,outerStore:o,quoteStore:s,accountStore:i,tradeModeStore:n,liquidityChooseStore:c}=Bt(),{from:d,to:m}=a,{receiveAddrObj:p}=e,{computedForbiddenBridge:S,address:T}=i,{tradingModeType:I}=n,A=g.BigNumber(a.computedTypedValue).toString(10),w={...{chainId:d.chainId,toChainId:m.chainId,toTokenAddress:m.tokenContractAddress,fromTokenAddress:d.tokenContractAddress,amount:A,userWalletAddress:T},...s.computedSlippage,pmm:"1",gasDropType:t?.computedGasDropSelected?1:0,forbiddenBridgeTypes:_s(S),dexIds:_s(c?.computedIds),receiveWalletAddress:p?.specifiedAddress,tradingModeType:I};return o.extendFeeConfig(w)};u();l();u();l();u();l();var Q=class{constructor({orderData:t,extParams:e},o){r(this,"walletNoNeedExtParams",!1);r(this,"differentiatedEnvironment",t=>rt()&&t.length>1&&!this.walletNoNeedExtParams&&!t[0].params?[{...t[0],extParams:t[1]}]:t);this.orderData=t,this.calldataType=t.calldataType,this.extParams=e||{},this.swapStore=o}get isTransferType(){return this.calldataType===An.TRANSFER}};var ue=class extends Q{constructor(){super(...arguments);r(this,"formatContractPayload",()=>{let{orderData:e}=this;return{...JSON.parse(e?.callData?.data)}});r(this,"formatTransferPayload",()=>{});r(this,"getSendTransactionParams",async()=>{let e=this.formatContractPayload();return this.differentiatedEnvironment([{...e,extParams:this.extParams}])});r(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};r(ue,"chainId",B.APTOS_MAINNET);u();l();var le=class extends Q{constructor(e,o,s){super(e,o);r(this,"makeSendBtcCallParams",async e=>{let{preDataForSendBtc:o}=this.swapStore.rootStore.walletContractStore;if(!o)throw Error("preDataForSendBtc is not ready");let{satBytes:s,coinAmount:i,dustSize:n,fetchUtxoList:c,serviceCharge:d}=o,m=await c();return{...e,utxoList:m,satBytes:s,dustSize:n,coinAmount:i,serviceCharge:d}});r(this,"formatContractPayload",()=>{});r(this,"formatTransferPayload",async()=>{let{orderData:e}=this;return this.swapStore.transferBtcPayload(e.callData)});r(this,"extendExtParams",e=>({...e,extParams:this.extParams}));r(this,"getSendTransactionParams",async()=>{if(!this.token.isNativeToken)throw new Error("btc token is not native token");let e;if(this.isTransferType){let o=await this.formatTransferPayload();e=this.extendExtParams(o),rt()&&(e=await this.makeSendBtcCallParams(e))}else throw Error("Not support contract call");return this.differentiatedEnvironment([e])});r(this,"preExecution",async()=>{if(!this.token.isNativeToken)throw new Error("btc token is not native token");let e;if(this.isTransferType)e=await this.formatTransferPayload();else throw Error("Not support contract call");return{payload:e}});this.token=s}};r(le,"chainId",B.BTC_MAINNET);u();l();var _r=class extends Q{constructor(){super(...arguments);r(this,"valueToHex",e=>g.BigNumber(e).toString(16));r(this,"formatContractPayload",()=>{let{orderData:e}=this,{priorityFee:o,maxFeePerGas:s,maxPriorityFeePerGas:i,gasPrice:n,gas:c,...d}=e?.callData||{};return d});r(this,"formatTransferPayload",()=>{let{orderData:e}=this;return e.callData});r(this,"getSendTransactionParams",async()=>{let{payload:e}=await this.preExecution();return Be&&e.value&&(e.value=this.valueToHex(e.value)),this.differentiatedEnvironment([e])});r(this,"preExecution",async()=>{let e;this.isTransferType?e=this.formatTransferPayload():e=this.formatContractPayload();let{extendEvmParams:o,extendsGas:s}=this.swapStore;return e.extParams=this.extParams,s&&(e=s(e)),e=o(e),{payload:e}})}};r(_r,"chainId",B.ETHEREUM_MAINNET);var yr=_r;u();l();var de=class extends Q{constructor(){super(...arguments);r(this,"importSolana",async()=>{let e=await import("./index.browser.esm-THG5RFG3.js"),{default:o}=await import("./bs58-GBGXHBX6.js");return{SolanaWeb3:e,bs58:o}});r(this,"deserialize",async e=>{let o,{SolanaWeb3:s,bs58:i}=await this.importSolana();try{o=s.Transaction.from(i.decode(e))}catch{o=s.VersionedTransaction.deserialize(i.decode(e))}return o});r(this,"rentReserve",e=>{if(!e)return"0";let{BigNumber:o}=g,s=o("365.25").div(2).multipliedBy(2);return o("19.055441478439427").multipliedBy(e).multipliedBy(s).div(10**9).toFixed(9)});r(this,"formatContractPayload",async()=>{let{orderData:e}=this,{bizType:o,bizId:s,data:i,accountLength:n}=JSON.parse(e.unsignedTx),c=await this.deserialize(i);return{payload:{bizType:o,bizId:s,transaction:c},rent:this.rentReserve(n)}});r(this,"formatTransferPayload",async()=>{let{orderData:e}=this,{unsignedTx:o}=e,s=JSON.parse(o),{data:i,accountLength:n}=s;return{payload:{transaction:await this.deserialize(i)},rent:this.rentReserve(n)}});r(this,"getSendTransactionParams",async()=>{let{payload:e}=await this.preExecution();return this.differentiatedEnvironment([e,this.extParams])});r(this,"preExecution",async()=>{let e;return this.isTransferType?e=await this.formatTransferPayload():e=await this.formatContractPayload(),e})}};r(de,"chainId",B.SOLANA_MAINNET);u();l();var me=class extends Q{constructor(){super(...arguments);r(this,"formatContractPayload",()=>{let{orderData:e}=this,{data:o,from:s}=e.callData,i=JSON.parse(o);return{...i,functionArgs:i.functionArgsEncode,txType:"contract_call",stxAddress:s}});r(this,"formatTransferPayload",()=>{});r(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload(),this.extParams]));r(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};r(me,"chainId",B.STACKS_MAINNET);u();l();var pe=class extends Q{constructor(){super(...arguments);r(this,"walletNoNeedExtParams",!0);r(this,"formatContractPayload",()=>{let{orderData:e}=this,o=JSON.parse(e.unsignedTx),{executionRequest:s}=JSON.parse(o.data);return s.calls});r(this,"formatTransferPayload",()=>{});r(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload()]));r(this,"preExecution",()=>({payload:this.formatContractPayload()}))}};r(pe,"chainId",B.STARKNET_MAINNET);u();l();var Er=class extends Q{constructor(){super(...arguments);r(this,"formatContractPayload",()=>{let{orderData:e}=this,{txBytes:o}=JSON.parse(e.unsignedTx);return{transactionBlock:o}});r(this,"getSendTransactionParams",async()=>this.differentiatedEnvironment([this.formatContractPayload(),this.extParams]));r(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};r(Er,"chainId",B.SUI_MAINNET);var Ms=Er;u();l();var kr=class extends Q{constructor(){super(...arguments);r(this,"walletNoNeedExtParams",!0);r(this,"formatContractPayload",()=>{let{orderData:e}=this,{params:o}=JSON.parse(e.unsignedTx);return o});r(this,"formatTransferPayload",()=>{let{orderData:e}=this,{params:o}=JSON.parse(e.unsignedTx);return o});r(this,"getSendTransactionParams",async()=>{let e=this.isTransferType?this.formatTransferPayload():this.formatContractPayload();return this.differentiatedEnvironment([e,this.extParams])});r(this,"preExecution",async()=>({payload:this.isTransferType?this.formatTransferPayload():this.formatContractPayload()}))}};r(kr,"chainId",B.TON_MAINNET);var Bs=kr;u();l();var he=class extends Q{constructor(){super(...arguments);r(this,"formatContractPayload",()=>{let{orderData:e}=this;return JSON.parse(e.unsignedTx)});r(this,"formatTransferPayload",()=>{});r(this,"getSendTransactionParams",async()=>{let e=this.formatContractPayload();return this.differentiatedEnvironment([{...e,extParams:this.extParams}])});r(this,"preExecution",async()=>({payload:this.formatContractPayload()}))}};r(he,"chainId",B.TRON_MAINNET);var Nd={[le.chainId]:le,[yr.chainId]:yr,[de.chainId]:de,[ue.chainId]:ue,[Ms.chainId]:Ms,[he.chainId]:he,[me.chainId]:me,[pe.chainId]:pe,[Bs.chainId]:Bs},Pd=a=>Nd[a]||yr,Dd=(a,t,e)=>{let{chainId:o}=a,s=Pd(o);return new s(t,e,a)},wr=Dd;u();l();function xd({selector:a}){let t=document.querySelector(a);t&&t.scrollTo({top:0,behavior:"smooth"})}var Us=xd;var ju=20,zt={CONFIRM:"confirm",UPDATE:"update",FILL_UP:"fill_up",SNAP_UPDATE:"snap_update"},Ws=class{constructor(t){r(this,"quoteData",null);r(this,"preDataForSendBtc",null);r(this,"setPreDataForSendBtc",t=>{this.preDataForSendBtc=t});r(this,"setQuoteData",t=>{this.quoteData=t});r(this,"quoteParams",()=>{let{accountStore:t,fromToStore:e,receiveAddressStore:o}=this.rootStore,i={...ce(),userWalletAddress:t.address};return e.computedDiffCrossChain&&(i.receiveWalletAddress=o.receiveAddrObj?.specifiedAddress),i});r(this,"updating",!1);r(this,"updateQuoteData",async()=>{let{quoteStore:{quote:t}}=this.rootStore,e=ce();this.updating=!0;let[o,s]=await O(k.post(ia,{...e,bridgeId:t?.bestRoute?.bridge?.bridgeId}));if(this.updating=!1,Us({selector:"#wallet_scroll"}),o){P.error({title:o?.data?.msg||h("swaptrade_top_notif_data_failed")});return}let{callDataResult:i,quoteResult:n}=s?.data||{};if(n&&this.rootStore.quoteStore.handleUpdateQuote({data:n}),i){let c=await this.getPreExecutionPayload(i);at(()=>{this.transactionPayload=c})}this.initCountDown(),this.startCountdown()});r(this,"updateSnapQuoteData",async()=>{let t=ce();this.updating=!0;let[e,o]=await O(k.get(da,{params:t}));if(this.updating=!1,Us({selector:"#wallet_scroll"}),e){P.error({title:e?.data?.msg||h("swaptrade_trading_mode_error_no_update")});return}let{quote:s,quoteResult:i,tradingModeType:n,unsignedTx:c}=o?.data||{};i&&this.rootStore.quoteStore.handleUpdateQuote({data:i}),this.rootStore.intentSwapStore.setCallDataInfo({quote:s,tradingModeType:n,unsignedTx:c}),this.initCountDown(),this.startCountdown()});r(this,"timer",null);r(this,"countdown",ju);r(this,"initCountDown",()=>{this.countdown=ju});r(this,"startCountdown",()=>{this.timer=setTimeout(()=>{let t=this.countdown;if(t===0){this.clearTimer();return}this.countdown=t-1,this.startCountdown()},1e3)});r(this,"clearTimer",()=>{this.timer&&clearTimeout(this.timer)});r(this,"initGasInfo",()=>({gasType:"normal",gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,isNetworkFeeLoading:!0,isGasLimitLoading:!0}));r(this,"gasInfo",this.initGasInfo());r(this,"setGasInfo",t=>{this.gasInfo=t});r(this,"gasFee",0);r(this,"setGasFee",t=>{this.gasFee=t});r(this,"orderInfo",{});r(this,"transactionPayload",null);r(this,"solonaRent","");r(this,"getPreExecutionPayload",async t=>{let{swapStore:e,quoteStore:o}=this.rootStore,s=o?.quote?.bestRoute||{},{fromToken:i}=s,n=wr(i,{orderData:t},e),{payload:c,rent:d}=await n.preExecution();return i.chainId===B.SOLANA_MAINNET&&d&&(this.solonaRent=d),c});r(this,"setTransactionPayload",t=>{this.transactionPayload=t});r(this,"fetchCallData",async()=>{let t=this.rootStore.swapStore.saveOrderParams(),[e,o]=await O(k.post(sa,t));if(e){let i=[90002,10009].includes(Number(e?.code))?e?.error_message:e?.data?.msg;return P.error({title:i||h("swaptrade_top_notif_data_failed")}),!0}let s=await this.getPreExecutionPayload(o?.data||{});return this.transactionPayload=s,!1});r(this,"nativeCoin",null);r(this,"setNativeCoin",t=>{this.nativeCoin={...t}});r(this,"calcNativeCoinAmount",()=>{let{coinAmountInt:t,decimals:e}=this.nativeCoin,{from:o,computedIsFromBtcCoin:s}=this.rootStore.fromToStore;return g.BigNumber(s?o.availableBalance:xe(t,e))});r(this,"calcNativeCoinAmountChange",()=>{let t;if(this.type===ot.SWAP){let{fromToStore:o}=this.rootStore;t=o.from}else{let{fromToken:o,fromTokenAmount:s}=this.rootStore.facetStore.facetOrderDetail;t={...o,amount:s}}let e=g.BigNumber(this.gasFee).isNaN()?"0":this.gasFee;return t.isNativeToken?g.BigNumber(t.amount).plus(e):g.BigNumber(e)});r(this,"gasFeeLoading",!0);r(this,"setGasFeeLoading",t=>{this.gasFeeLoading=t});r(this,"gasLimitError",null);r(this,"setGasLimitError",t=>{this.gasLimitError=t});r(this,"activityId",null);r(this,"setActivityId",t=>{this.activityId=t});r(this,"type",ot.SWAP);r(this,"setSwapType",t=>{this.type=t});r(this,"reset",()=>{this.gasInfo=this.initGasInfo(),this.setGasFeeLoading(!1),this.nativeCoin=null,this.transactionPayload=null,this.gasFee=0,this.setGasLimitError(null),this.setStarknetRegisterStatus(""),this.setVisibleStarknetRegister(!1),this.setActivityId(null),this.setSwapType(ot.SWAP),this.clearTimer(),this.solonaRent=""});r(this,"starknetRegisterStatus","");r(this,"setStarknetRegisterStatus",t=>{this.starknetRegisterStatus=t});r(this,"visibleStarknetRegister",!1);r(this,"setVisibleStarknetRegister",t=>{this.visibleStarknetRegister=t});r(this,"onSwap",()=>{Fe({...this.rootStore.swapStore.getSaveOrderMonitorData(),button_name:"confirm"}),this.rootStore.swapStore.onSwap()});r(this,"onRedeem",()=>{this.rootStore.facetStore.walletSendRedeem()});r(this,"onIntentSwap",()=>{this.rootStore.intentSwapStore.onIntentSwap()});r(this,"confirmSwapMap",{[ot.SWAP]:this.onSwap,[ot.REDEEM]:this.onRedeem,[ot.INTENT_SWAP]:this.onIntentSwap});r(this,"onConfirm",t=>{this.confirmSwapMap[t]?.()});r(this,"getBtnProps",t=>{let{fromToStore:e}=this.rootStore,{symbol:o,coinId:s,chainId:i}=this.nativeCoin||{};return{[zt.CONFIRM]:{disabled:this.computedConfirmBtnDisabled,onClick:c=>{this.onConfirm(c)},text:h("swaptrade_card_swap_btn_confirm_swap"),loading:this.computedIsConfirming},[zt.UPDATE]:{onClick:()=>{Fe({...this.rootStore.swapStore.getSaveOrderMonitorData(),button_name:"update"}),this.updateQuoteData().catch(()=>{})},loading:this.updating,text:h("swaptrade_confirmswap_btn_update_price")},[zt.SNAP_UPDATE]:{onClick:()=>{Fe({...this.rootStore.swapStore.getSaveOrderMonitorData(),button_name:"update"}),this.updateSnapQuoteData().catch(()=>{})},loading:this.updating,text:h("swaptrade_confirmswap_btn_update_price")},[zt.FILL_UP]:{onClick:()=>{Wa({wallet_address:this.rootStore.accountStore.address,button_name:"fill_up"}),e.baseAddFunds({coinId:s,chainId:i,receiveOnly:!1})},text:h("swaptrade_dialog_btn_supplement",{token:o})}}[t]});x(this),this.rootStore=t}get computedFormatTime(){return Oa(this.countdown)}get computedPriceUpdate(){return this.countdown===0}get computedIsSufficientGas(){if(!this.nativeCoin)return!0;let t=this.calcNativeCoinAmount(),e=this.calcNativeCoinAmountChange();return t.gte(e)}get computedSolonaNativeTokenSufficientRent(){let{quoteStore:t}=this.rootStore,e=t?.quote?.bestRoute||{},{fromToken:o}=e||{};if(o?.chainId!==B.SOLANA_MAINNET||!this.nativeCoin||!this.solonaRent)return!0;let s=this.calcNativeCoinAmount(),i=this.calcNativeCoinAmountChange();return s.gte(i.plus(this.solonaRent))}get walletSendParams(){let{toLocale:t,dispatch:e}=v;return!t||!e?null:{t,dispatch:e}}get computedIsIntentSwap(){return this.type===ot.INTENT_SWAP}get computedConfirmBtnDisabled(){let{RegisterLocalStatusEnum:t}=v.global,{computedIsStarknetChain:e,computedIsFromBtcCoin:o,computedIsEvmChain:s}=this.rootStore.fromToStore;if(this.computedIsIntentSwap)return!1;if(e&&this.starknetRegisterStatus!==t?.COMPLETED)return!0;let i=this.computedPriceUpdate||!this.computedIsSufficientGas||!this.computedSolonaNativeTokenSufficientRent||this.gasFeeLoading||this.gasLimitError;return o||!s?i:i||this.gasInfo?.isGasLimitLoading||this.gasInfo?.gasLimitInfo?.queryGasLimitErrorUseDefault}get computedIsConfirming(){let{swapStore:t,intentSwapStore:e}=this.rootStore;return this.computedIsIntentSwap?!!e.isConfirmLoading:t.isConfirmLoading}get computedBtnProps(){let t=zt.CONFIRM;return!this.computedIsSufficientGas||!this.computedSolonaNativeTokenSufficientRent?t=zt.FILL_UP:this.computedPriceUpdate&&(t=this.computedIsIntentSwap?zt.SNAP_UPDATE:zt.UPDATE),this.getBtnProps(t)}get computedMonitorGasType(){return this.gasInfo?.gasType?{network_fee_details:{gas_level:this.gasInfo?.gasType}}:{}}},Lr=Ws;u();l();u();l();D();u();l();var Xu=(a,t)=>a.filter(({networks:e})=>e.findIndex(s=>s.name===t)>-1),zu=(a,t)=>a.filter(({account:e})=>e[t]),Ju=({recentAddrData:a,addressBookData:t,walletListData:e,chainName:o})=>{let s=[];if(a.length>0){let i=a.map(({specifiedAddress:n,...c})=>({specifiedAddress:n,...c}));s.push({group:h("swaptrade_extension_wallet_address_recent_address"),list:i})}if(t.length>0){let i=t.map(n=>({...n,specifiedAddress:n.address}));s.push({group:h("swaptrade_extension_wallet_address_connected_wallets"),list:i})}if(e.length){let i=e.map(c=>({specifiedAddress:c.account[o],group:c.keyringName,name:c.walletName,walletId:c.walletId}));Object.entries(Ia(i,"group")).forEach(([c,d])=>{s.push({group:c,list:d})})}return s},Yu=a=>String(y(a,"isLeveraged"))==="1",Zu=(a,t)=>{let e=[null,null];return Yu(a)&&(e[0]=a),Yu(t)&&(e[1]=t),e};var{BigNumber:H,sub:Fd,div:Md}=g,To=class{constructor(t){r(this,"defaultToken",{amount:"",prevAmount:"",balance:"",logoURI:"",coinId:"",decimals:"",usdPrice:"",tokenName:"",baseCoinId:"",tokenSymbol:"",tokenLogoUrl:"",isNativeToken:0,tokenContractAddress:"",isSafeMoonToken:"",isHoneypot:"",buyTaxes:"0",sellTaxes:"0",reverseReceiveAmount:""});r(this,"from",{...this.defaultToken,amount:"1"});r(this,"to",this.defaultToken);r(this,"fromBalanceState",Z.BALANCE_NOT_SHOW);r(this,"toBalanceState",Z.BALANCE_NOT_SHOW);r(this,"fromBalanceRequestError",!1);r(this,"toBalanceRequestError",!1);r(this,"isBalanceLoading",!1);r(this,"visibleAddFunds",!1);r(this,"setFrom",t=>{this.from=t});r(this,"setTo",t=>{this.to=t});r(this,"maxDialogType",Ze.enough);r(this,"setMaxDialogType",t=>{this.maxDialogType=t});r(this,"checkMaxDialogTypeIsEnough",t=>Ze.enough===t);r(this,"typedValue","1");r(this,"fromMax",!1);r(this,"independentField",C.FROM);r(this,"singleTypedValue","1");r(this,"singleFromMax",!1);r(this,"advanceSetTypedValue",(t,e,o="")=>{(o||this.commonStore.currentTab)===_.SWAP?(this.singleTypedValue=t,this.singleFromMax=e):this.setTypeInput(t,e)});r(this,"needCrossChainDoubleConfirm",!1);r(this,"setNeedCrossChainDoubleConfirm",t=>{this.needCrossChainDoubleConfirm=t});r(this,"updateBtcFromBalance",async()=>this.computedIsFromBtcCoin?(await this.getTokenBalanceByAccount(C.FROM,M(this.from)),!this.fromBalanceRequestError):!this.fromBalanceRequestError);r(this,"onClickMax",async()=>{Ba({button_name:"max"});let{isNativeToken:t}=this.from;this.setField(C.FROM);let e="",o="";if(t===1){let[s,i]=await Promise.all([this.rootStore.quoteStore.fetchGasTokenFee(),this.updateBtcFromBalance()]);if(!i)return;let{balance:n,availableBalance:c}=this.from,d=(this.computedIsFromBtcCoin?c:n)||"0";if(s===-1)return;o=H(d).minus(s);let m=o.isNegative();this.setMaxDialogType(m?Ze.insufficient:Ze.enough),m&&this.setShowAddFund(!0),this.showMaxDialog(),this.setShowMaxIcon(!0),e=m?"":o.toString()}else e=this.from.balance;this.advanceSetTypedValue(e,!0)});r(this,"setTypeInput",(t,e)=>{this.typedValue=t,this.fromMax=!!e});r(this,"setField",t=>{this.independentField=t});r(this,"quoteUpdateFromTo",t=>{let{receiveAmount:e="",fromTokenPrice:o="",toTokenPrice:s="",payAmount:i="",inputToTokenPrice:n=""}=t||{};!this.computedIsExactIn&&e?(this.from.amount=i,this.to.amount=this.computedTypedValue,this.to.prevAmount=this.computedTypedValue,this.from.currentTime=new Date().getTime(),this.to.usdPrice=n):this.computedIsExactIn&&(this.from.amount=this.computedTypedValue,this.to.amount=e,this.from.prevAmount=this.computedTypedValue,this.to.currentTime=new Date().getTime(),this.to.usdPrice=s),this.to.reverseReceiveAmount=e,this.from.usdPrice=o});r(this,"checkAndGetTokenInfo",async({chainId:t,tokenContractAddress:e})=>{let[o,s]=await this.getTokenInfoAndBalance(t,e);return o?null:s.data});r(this,"getDexMultiDefaultTokenInfo",t=>{let{chainList:e}=this.commonStore,o=M(e).find(s=>Number(s.chainId)===Number(t??oo))||{};return{fromDexMultiTokenInfoVO:{...o.dexDefaultFromToTokenShowVO?.fromDexMultiTokenInfoVO,reserveGas:o.reserveGas},toDexMultiTokenInfoVO:o.dexDefaultFromToTokenShowVO?.toDexMultiTokenInfoVO||{}}});r(this,"addressReplaceSymbol",t=>{let{fromDexMultiTokenInfoVO:e}=this.getDexMultiDefaultTokenInfo(t.chainId),{tokenSymbol:o,isNativeToken:s}=e;return s&&this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(e)?o:t?.tokenContractAddress});r(this,"symbolReplaceAddress",t=>this.tokenReplaceMainToken(t).tokenContractAddress);r(this,"validTokens",{});r(this,"fetchTokenInfo",async t=>{if(t.tokenContractAddress){let e=await this.checkAndGetTokenInfo(t);if(e?.tokenContractAddress){let s={...e,balance:e.amountNum,amount:t.amount||""},i=`${e.chainId}_${this.commonStore.getTokenAddress(e)}`;return this.validTokens[i]=!0,s}let o=`${t.chainId}_${this.commonStore.getTokenAddress(t)}`;return this.validTokens[o]=t.tokenContractAddress==wn,null}return null});r(this,"checkQueryToken",async(t,e=!0)=>{if(!G(t.chainId))return null;let o=t;if(ja(this.commonStore.chainList,Number(t.chainId))){let{from:i}=this.getInitializedValue(t.chainId);if(this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(i)&&e){let c=`${i?.chainId}_${this.commonStore.getTokenAddress(i)}`;return this.validTokens[c]=!0,i}let n=await this.fetchTokenInfo({chainId:Number(t.chainId),tokenContractAddress:t.tokenContractAddress});e?o=n||i:o=n}else o=null;return o});r(this,"updateFrom",t=>{(!this.commonStore.equalsToken(t,this.from)||this.from.balance!==t.balance)&&(this.setShowMaxIcon(!1),this.setShowAddFund(!1)),this.from={...M(this.from),...t}});r(this,"updateFromAmount",t=>{this.from.amount=t,t||(this.from.usdPrice="0"),this.from.prevAmount||(this.from.prevAmount=t)});r(this,"updateTo",t=>{this.to={...M(this.to),...t}});r(this,"hideMaxDialog",!!L.get(hs));r(this,"hideMaxDialogLessGas",!!L.get(fs));r(this,"setStorageShowMaxDialog",t=>{if(t){let e=this.checkMaxDialogTypeIsEnough(this.maxDialogType);L.set(e?hs:fs,"1"),e?this.hideMaxDialog=!0:this.hideMaxDialogLessGas=!0}this.visibleMaxDialog=!1});r(this,"visibleMaxDialog",!1);r(this,"showMaxDialog",()=>{let t=this.checkMaxDialogTypeIsEnough(this.maxDialogType);t&&this.hideMaxDialog||!t&&this.hideMaxDialogLessGas||(this.visibleMaxDialog=!0)});r(this,"showMaxIcon",!1);r(this,"setShowMaxIcon",t=>{this.showMaxIcon=t});r(this,"showAddFund",!1);r(this,"setShowAddFund",t=>{this.showAddFund=t});r(this,"setFromBalanceRequestError",t=>{this.fromBalanceRequestError=t});r(this,"setToBalanceRequestError",t=>{this.toBalanceRequestError=t});r(this,"onSwitchFromTo",async()=>{if(!this.isBalanceLoading){this.rootStore.quoteStore.isFirstQuote=!0,this.rootStore.quoteStore.quoteScope=null,this.setShowMaxIcon(!1),this.setShowAddFund(!1);let[t,e]=[M(this.from),M(this.to)];[this.fromBalanceRequestError,this.toBalanceRequestError]=[this.toBalanceRequestError,this.fromBalanceRequestError];let o={amount:this.computedTypedValue??"",prevAmount:this.computedTypedValue??"",usdPrice:""},s={amount:"",prevAmount:"",usdPrice:""};this.setNeedCrossChainDoubleConfirm(!0),this.setField(C.FROM),this.computedIsSingleChain?this.setFrom({...e,...o}):(this.rootStore.quoteStore.setQuoteNumber(this.computedTypedValue?0:2),this.setFrom({...e,amount:e.amount||"",prevAmount:e.amount||"",usdPrice:""})),this.setTo({...t,...s}),this.advanceSetTypedValue(e.amount),this.rootStore.receiveAddressStore.clearReceiveAddressValue()}});r(this,"getChainInfo",t=>{let{chainList:e}=this.commonStore;return M(e).find(s=>Number(s.chainId)===Number(t))||{}});r(this,"getInitializedValue",(t=oo)=>{let e=this.getChainInfo(t),{fromDexMultiTokenInfoVO:o,toDexMultiTokenInfoVO:s}=e?.dexDefaultFromToTokenShowVO||{fromDexMultiTokenInfoVO:{},toDexMultiTokenInfoVO:{}},i={...M(o),balance:"",reserveGas:e?.reserveGas},n={...M(s),balance:""};return{from:i,to:n}});r(this,"resetFromTo",async t=>{let{chainList:e,currentTab:o}=this.commonStore,s=o===_.BRIDGE;if(Number(t)!==Number(this.from.chainId)){let i=M(e).find(p=>Number(p.chainId)===Number(t)),{fromDexMultiTokenInfoVO:n,toDexMultiTokenInfoVO:c,toCrossDexMultiTokenInfoVO:d}=i?.dexDefaultFromToTokenShowVO||{fromDexMultiTokenInfoVO:{},toDexMultiTokenInfoVO:{}};this.from={...M(n),balance:"",reserveGas:i?.reserveGas};let m=s&&d||c;this.to={...M(m),balance:""}}});r(this,"clearFromTo",()=>{this.from={},this.to={}});r(this,"updateBalanceIfNativeToken",(t,e)=>{e.isNativeToken?this.getTokenBalanceByAccount(t,e,!1).catch(Ta):(this.setFromBalanceRequestError(!1),this.setBalance(t,e.amountNum))});r(this,"getSwapTokenBalance",(t=!1)=>{this.getTokenBalanceByAccount(C.FROM,M(this.from),t).catch(()=>{}),this.getTokenBalanceByAccount(C.TO,M(this.to),t).catch(()=>{})});r(this,"getTokenInfoAndBalance",async(t,e)=>{let o=this.accountStore.getAddressByChainId(t),s={chainId:t,tokenAddress:e,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,userWalletAddress:o,businessType:this.commonStore.computedCurrentTabIsLimit?ps.LIMIT_ORDER:ps.SWAP_ORDER};return O(k.get(Gn,{params:s}))});r(this,"needBalanceLoading",!0);r(this,"setNeedBalanceLoading",t=>{this.needBalanceLoading=t});r(this,"getTokenBalanceByAccount",async(t,e,o)=>{let s=t===C.FROM,{chainId:i,tokenContractAddress:n}=e;if(G(i)&&n&&this.accountStore.computedAccountId){this.needBalanceLoading&&(this.isBalanceLoading=!0);let c=await this.getTokenInfoAndBalance(i,n);if(this.isBalanceLoading=!1,this.setNeedBalanceLoading(!0),!this.commonStore.equalsToken(e,s?this.from:this.to))return;if(c[0]){if(o){this.fromBalanceRequestError=!1,this.toBalanceRequestError=!1;return}s?(this.fromBalanceRequestError=!0,this.fromBalanceState=Z.BALANCE_REQUEST_FAILED):(this.toBalanceRequestError=!0,this.toBalanceState=Z.BALANCE_REQUEST_FAILED),this.setBalance(t,"0","0");return}s?this.fromBalanceRequestError=!1:this.toBalanceRequestError=!1;let{amountNum:d,availableAmountNum:m}=c[1]?.data;this.setBalance(t,d,m)}});r(this,"setBalance",(t,e="",o="")=>{let s=t===C.TO,i={balance:e,availableBalance:o};s?this.updateTo({...this.to,...i}):this.updateFrom({...this.from,...i})});r(this,"setBalanceState",t=>{let{amount:e,address:o,from:s,to:i}=t;Boolean(o)&&Boolean(s.tokenContractAddress)?this.fromBalanceRequestError===!0?this.fromBalanceState=Z.BALANCE_REQUEST_FAILED:H(s.balance||"0").lt(e||"0")?this.fromBalanceState=Z.BALANCE_INSUFFICIENT:this.fromBalanceState=Z.COMMON:this.fromBalanceState=Z.BALANCE_NOT_SHOW,!(Boolean(o)&&Boolean(i.tokenContractAddress))||!this.computedIsToAddressEqualsCurrentToAddress&&this.computedDiffCrossChain?this.toBalanceState=Z.BALANCE_NOT_SHOW:this.toBalanceRequestError===!0?this.toBalanceState=Z.BALANCE_REQUEST_FAILED:this.toBalanceState=Z.COMMON});r(this,"updateFromBalancePush",t=>{let{coinAmountOriginalDec:e,availableAmountNum:o}=t;this.commonStore.equalsToken(this.from,t)?this.setBalance(C.FROM,e,o):this.commonStore.equalsToken(this.to,t)&&this.setBalance(C.TO,e,o)});r(this,"tokenReplaceMainToken",t=>{let e=t,{fromDexMultiTokenInfoVO:o}=this.getDexMultiDefaultTokenInfo(t?.chainId),{tokenSymbol:s,chainId:i}=o;return G(t?.chainId)&&t?.tokenContractAddress&&(this.commonStore.getTokenAddress(t)===(this.commonStore.isSensitiveChain(i)?s:Pt(s))||this.commonStore.getTokenAddress(t)===this.commonStore.getTokenAddress(o))&&(e={...o,amount:t.amount}),e});r(this,"onClickAddFunds",()=>{let{tokenSymbol:t,chainName:e}=this.from,{address:o}=this.accountStore,s={currency:t,network:e,address:o};this.getDeposit(s)});r(this,"calOrderUpdateFromTo",t=>{let{fromTokenUsd:e,toTokenUsd:o,fromAmount:s,toAmount:i}=t||{};io(s)||(this.from.amount=s),io(e)||(this.from.usdPrice=e),io(i)||(this.to.amount=i),io(o)||(this.to.usdPrice=o)});r(this,"isEvmChain",t=>G(t)?this.commonStore.getChainByID(t)?.chainType!==Sn.NO_EVM_CHAIN:!0);r(this,"isTronChain",t=>t===B.TRON_MAINNET);r(this,"getFormatFromToToken",async({from:t,to:e},o)=>{let[s,i]=await Promise.all([this.checkQueryToken(t,o),this.checkQueryToken(e,o)]),n=s,c=i,d=m=>`${m?.chainId}-${m?.tokenContractAddress}`;if(s){let m=this.getInitializedValue(s?.chainId),p=so(Is([s,i,m.from,m.to],d));n=p[0],c=p[1]}else if(i){let m=this.getInitializedValue(i.chainId),p=so(Is([i,m.from,m.to],d));n=p[1],c=p[0]}return{token1:n,token2:c}});r(this,"orderContinueStatus",z.DEFAULT);r(this,"setOrderContinueStatus",t=>{this.orderContinueStatus=t});r(this,"fillSwapFromTo",async({apiRequestParams:t,locationParams:e})=>{let{closeModal:o}=this.rootStore.recentTransactionStore;!await this.beforeCheckAndGetTokenInfo(t,e)||(o(),this.setSwapAndLimitTypeValue(e.inputAmount))});r(this,"beforeCheckAndGetTokenInfo",async(t,e)=>{let{orderCheckContinue:o}=this.rootStore.oneMoreOrderStore;if(this.setOrderContinueStatus(z.LOADING),t&&!await o(t))return this.setOrderContinueStatus(z.ERROR),!1;let{token1:s,token2:i}=await this.getFormatFromToToken(e,!1);return!s||!i?(P.error({title:h("swaptrade_history_toast_setup_error"),duration:At}),this.setOrderContinueStatus(z.ERROR),!1):(this.setOrderContinueStatus(z.READY),this.updateFromAndToInfo(s,i),!0)});r(this,"beforeCheckUrl",async t=>{this.setOrderContinueStatus(z.LOADING);let{orderCheckContinue:e}=this.rootStore.oneMoreOrderStore;return await e(t)?(this.setOrderContinueStatus(z.READY),!0):(this.setOrderContinueStatus(z.ERROR),!1)});r(this,"updateFromAndToInfo",(t,e)=>{this.updateFrom(t),this.updateTo(e)});this.rootStore=t,this.accountStore=t.accountStore,this.commonStore=t.commonStore}get computedTypedValue(){return this.commonStore.currentTab===_.SWAP?this.singleTypedValue:this.typedValue}get computedFromMax(){return this.commonStore.currentTab===_.SWAP?this.singleFromMax:this.fromMax}get computedNeedCrossChainDoubleConfirm(){return this.computedIsSingleChain?!1:!this.needCrossChainDoubleConfirm}get dependentField(){return this.independentField===C.FROM?C.TO:C.FROM}get computedIsExactIn(){return this.independentField===C.FROM}get computedIsSingleChain(){return G(this.from.chainId)&&G(this.to.chainId)&&Number(this.from.chainId)===Number(this.to?.chainId)}get computedSwapAmount(){return{[this.independentField]:this.computedFromMax?ro(this.computedTypedValue,{noNeedThousandth:!0}):this.computedTypedValue,[this.dependentField]:this.computedCalAmount[this.dependentField]}}get computedCalAmount(){return{[C.FROM]:ro(this.from?.amount,{noNeedThousandth:!0})??"",[C.TO]:ro(this.to?.amount,{noNeedThousandth:!0})??""}}get computedIfQuote(){return!!(this.computedTypedValueIsValid&&this.from&&this.to)}get computedTypedValueIsValid(){return!H(this.computedTypedValue).isZero()&&!H(this.computedTypedValue).isNaN()}get computedFromAmountIsValid(){let{amount:t}=this.from;return wt(t)}get computedFromLocalCostByUsd(){let{usdPrice:t}=this.from;if(!this.computedFromAmountIsValid)return"";let{nowCurrencyUnit:e}=this.commonStore,{symbol:o,usdToThisRate:s}=e,i=H(t);if(o&&t&&s&&!i.isNaN()){let c=i.multipliedBy(s).toString();return et(c,o)}return""}get computedToLocalCostByUsd(){let{usdPrice:t}=this.to,{nowCurrencyUnit:e}=this.commonStore,{symbol:o,usdToThisRate:s}=e,i=H(t);if(o&&t&&s&&this.to.amount&&!i.isNaN()&&wt(this.from.amount)){let c=i.multipliedBy(s).toString();return et(c,o)}return""}get computedRate(){let{from:t,to:e,computedIsExactIn:o}=this,{quoteStore:s,gasDropStore:i}=this.rootStore,n=y(s,"quote.bestRoute.gasDropFromAmount",""),c=n&&i?.gasDropConfig?.gasDrop?H(t?.amount).minus(n):H(t?.amount),d=e?.reverseReceiveAmount&&o||!o&&t?.amount;return c&&d?j(H(e?.reverseReceiveAmount).div(c).toString(10)):""}get computedToFromRate(){let{from:t,to:e,computedIsExactIn:o}=this,{quoteStore:s,gasDropStore:i}=this.rootStore,n=y(s,"quote.bestRoute.gasDropFromAmount",""),c=n&&i?.gasDropConfig?.gasDrop?H(t?.amount).minus(n):H(t?.amount),d=e?.reverseReceiveAmount&&o||!o&&t?.amount;return c&&d?j(H(c).div(e?.reverseReceiveAmount).toString(10)):""}get computedIsToAddressEqualsCurrentToAddress(){let t=this.accountStore.getAddressByChainId(this.to.chainId);return t&&this.rootStore.receiveAddressStore.computedReceiveAddr===t}get computedValueDifference(){let{tradeModeStore:t,quoteStore:e}=this.rootStore,{usdPrice:o}=this.from,{usdPrice:s,currentTime:i}=this.to,{computedIsSnapType:n}=t,c=y(e,"quote.bestRoute.gasDropFromAmount",""),d=y(e,"quote.bestRoute.fromTokenAmount",""),m=qt(o),p=gs(o),S=qt(s),T=gs(s);if(m||p||S||T)return{isUp:!1,diff:"",isOver:!1,nowTime:new Date().getTime()};let I=c?H(o).div(H(d))*H(c):"";o=c?o-I:o;let A=H(s).minus(o).div(o).multipliedBy(100),R=H(A.toFixed(2,1));if(R.gt(-.1)&&R.lt(.1))return null;let q=A.isNegative()?"":"+",K="";return A.gt(100)?K=`>${q}${Lt(100,{needZero:!1})}`:A.lt(-100)?K=`<${q}${Lt(100,{needZero:!1})}`:K=`${q}${Lt(R.toString(10),{needZero:!1})}`,{isUp:n?!1:!A.lt(0),diff:K,isOver:n?!1:A.lte(-10),currentTime:i,specialValueRangePrompt:A.gt(-10)&&A.lt(10),value:`${H(A.toFixed(2,1)).toString(10).replace(/\+|-/,"")}`}}get computedMinimumReceived(){let{quoteStore:t}=this.rootStore,e=y(t,"quote.bestRoute.minimumReceived"),o=y(t,"quote.bestRoute.toToken.tokenSymbol","");return`${j(e)||"--"} ${o}`}get computedMinimumReceivedIsOrange(){let{quoteStore:t}=this.rootStore,e=H(y(t,"quote.bestRoute.minimumReceived")),o=H(this.to?.amount);return!o.isZero()&&!o.isNaN()&&Md(Fd(o,e),o)>=.1}get computedIsCrossChain(){return G(this.from.chainId)&&G(this.to.chainId)&&Number(this.from.chainId)!==Number(this.to?.chainId)}get computedIsBridge(){let{from:t,to:e}=this;return this.computedIsCrossChain&&t.tokenSymbol===e.tokenSymbol}getDeposit(){}get computedDiffCrossChain(){let t=!!this.accountStore.address,e=this.commonStore.getChainByID(this.from.chainId),o=this.commonStore.getChainByID(this.to.chainId),s=String(this.from.isHoneypot),i=String(this.to.isHoneypot),{computedNonsupportChain:n}=this.accountStore,c=e?.crossChainType||"",d=o?.crossChainType||"";return t&&!n&&s!=="1"&&i!=="1"&&c&&d&&c!==d}get computedMaxTipsText(){let{from:t,maxDialogType:e}=this,{cacheNativeGasFee:o}=this.rootStore.quoteStore;if(!t.isNativeToken||!o||!t.tokenSymbol)return h("wallet_swap_toast_reserve_mainnet_token");let s={value:j(o),tokenSymbol:t.tokenSymbol};if(this.checkMaxDialogTypeIsEnough(e)){if(this.computedIsFromBtcCoin&&g.gt(this.computedUnavailableBalance,0)){let i=j(this.computedUnavailableBalance);return h("swaptrade_dialog_pay_card_reserved_from_wallet",{symbol:s.tokenSymbol,value:s.value,unablevalue:i})}return h("swaptrade_dialog_desc_reserved_netfee",s)}return h("swaptrade_dialog_desc_please_reserve",s)}get computedShowAddFund(){let{accountStore:t,swapBtnStore:e}=this.rootStore,{from:o}=this;return!t.computedNonsupportChain&&(this.independentField===C.FROM&&H(this.computedTypedValue||0).gt(H(o.balance||0))||e.computedTooBalance)||this.showAddFund&&!this.checkMaxDialogTypeIsEnough(this.maxDialogType)}get computedIsEvmChain(){return this.isEvmChain(this.from.chainId)}get computedDefaultAutoSlippageInfo(){let t=this.commonStore.getChainByID(this.from.chainId);return{autoSlippage:t?.toleranceSlippage?.selectItem,autoTotalSlippage:t?.crossToleranceSlippage?.selectItem}}get computedIsSolanaChain(){return cc(this.from.chainId)}get computedIsAptosChain(){return uc(this.from.chainId)}get computedIsTronChain(){return ir(this.from.chainId)}get computedIsSuiChain(){return ic(this.from.chainId)}get computedIsStacksChain(){return nc(this.from.chainId)}get computedIsStarknetChain(){return ac(this.from.chainId)}get computedHasToSwap(){let t=y(this.rootStore.quoteStore,"quote.bestRoute.toSwapFeeUsd");return this.computedIsCrossChain&&t>0}setSwapAndLimitTypeValue(t){let{computedCurrentTabIsLimit:e}=this.commonStore,{clearSellAndReceive:o}=this.rootStore?.limitOrderControlStore||{};e?o?.():wt(t)?(this.setField(C.FROM),this.advanceSetTypedValue(t)):this.advanceSetTypedValue("")}get computedLeverageTokenPair(){return Zu(this.from,this.to)}get computedFormToTokenIsLeverageToken(){let[t,e]=this.computedLeverageTokenPair;return!!t||!!e}get computedIsFromBtcChain(){return sc(this.from.chainId)}get computedIsFromBtcCoin(){return this.computedIsFromBtcChain&&this.from.isNativeToken}get computedUnavailableBalance(){return H(this.from.balance).minus(this.from.availableBalance).toString()}get computedIsFacetToken(){let{from:t,to:e}=this;return Number(t.tokenType)===Re.FACET||Number(e.tokenType)===Re.FACET}get computedNonsupportFacetToken(){let{address:t,walletConfig:{OKXWalletType:e,walletType:o}}=this.accountStore;return t?this.computedIsFacetToken&&!(G(e)&&[Wt.MNEMONIC,Wt.PRIVATE_KEY].includes(e)||o===Ko.METAMASK):!1}};var fe=class extends To{constructor(e){super(e);r(this,"getDeposit",()=>()=>{});r(this,"addFundsParams",{});r(this,"closeAddFunds",()=>{this.visibleAddFunds=!1});r(this,"onClickAddFunds",()=>{let{tokenSymbol:e,chainName:o,tokenLogoUrl:s,chainId:i,isNativeToken:n,tokenContractAddress:c}=this.from;this.visibleAddFunds=!0;let d={currency:e,network:o,iconUrl:s,chainId:i,isNativeToken:n,tokenContractAddress:n?"":c,receiveOnly:!0};this.baseAddFunds(d)});r(this,"baseAddFunds",e=>{this.visibleAddFunds=!0,this.addFundsParams={...e}});r(this,"tokenReplaceMainToken",(e,o)=>{let s=e,i=!Ir(e),{fromDexMultiTokenInfoVO:n}=this.getDexMultiDefaultTokenInfo(i?o:e.chainId),{tokenSymbol:c,chainId:d}=n;return!i&&(this.commonStore.getTokenAddress(e)===(this.commonStore.isSensitiveChain(d)?c:Pt(c))||this.commonStore.getTokenAddress(e)===this.commonStore.getTokenAddress(n))&&(s={...n,amount:e.amount}),s});Xt(this),Ct(()=>{let{computedDiffCrossChain:o,to:s}=this;return{computedDiffCrossChain:o,toChainId:s?.chainId}},({computedDiffCrossChain:o,toChainId:s})=>{this.cacheToChainId!==s&&this.rootStore.receiveAddressStore.saveReceiveAddressValue({}),this.rootStore.receiveAddressStore.setCacheToChainId(o&&s?s:-1)},{equals:Ft.shallow})}};u();l();u();l();D();var Vs=class{constructor(t){r(this,"callDataInfo",null);r(this,"setCallDataInfo",({quote:t,tradingModeType:e,unsignedTx:o})=>{this.callDataInfo={quote:t,tradingModeType:e,unsignedTx:o}});r(this,"signIntentSwap",async()=>[]);r(this,"createIntentOrder",async(t,e,o)=>{let s={intentCode:e,signature:o,quote:t,userWalletAddress:this.rootStore?.accountStore?.address},[i,n]=await O(k.post(ma,{...s}));return i&&(b.error(N.INTENT_ORDER_CREATE_ERROR,{error:i}),P.error({title:i?.error_message||h("swaptrade_trading_mode_alert_order_fail")})),[i,n]});this.rootStore=t}},tl=Vs;u();l();var el=Tt(["isConfirmLoading"],[]);var qs=class extends tl{constructor(e){super(e);r(this,"isConfirmLoading",!1);r(this,"setIsConfirmLoading",e=>{this.isConfirmLoading=e});r(this,"signIntentSwap",async(e,o)=>{let{signTransaction:s}=this.rootStore.sendTransactionStore,[i,n]=await s(e,o);return i&&(b.error(N.INTENT_SWAP_SIGN_ERROR,{error:i,msg:{chainId:e,unsignedTx:o}}),P.error({title:h("swaptrade_trading_mode_alert_order_fail")})),[i,n]});r(this,"onIntentSwap",async()=>{this.setIsConfirmLoading(!0),b.keepLive();let{swapStore:e,quoteStore:o}=this.rootStore,s=y(o,"quote.bestRoute.fromToken.chainId");try{let{quote:i,tradingModeType:n,unsignedTx:c}=this.callDataInfo||{},[d,m]=await this.signIntentSwap(s,c);if(d)return;let[p,S]=await this.createIntentOrder(i,n,m);if(p)return;e.afterTransaction(S.data?.orderId)}catch(i){b.error(N.INTENT_SWAP_PROCESS_ERROR,{error:i})}finally{this.setIsConfirmLoading(!1),b.removeKeep()}});ct(this,el)}},br=qs;u();l();D();u();l();D();var Gs=class{constructor(t){r(this,"receiveAddrStatus",ve.NORMAL);r(this,"receiveAddrObj",{});r(this,"saveReceiveAddressValue",t=>{this.receiveAddrObj=this.filterReceiveWalletInfo(t),t?.specifiedAddress||this.initCheckAddrStatus()});r(this,"clearReceiveAddressValue",()=>{this.receiveAddrObj={},this.initCheckAddrStatus(),this.walletAddrInWeb3=[],this.getLinkedWalletAddrInWeb3().catch(()=>{})});r(this,"checkReceiveAddressLoading",!1);r(this,"filterReceiveAddress",(t,e,o=!0)=>{let s=e?.specifiedAddress||this.receiveAddrObj?.specifiedAddress||"";return s?t.filter(({specifiedAddress:i})=>o?i.includes(s):i===s):t});r(this,"filterReceiveWalletInfo",t=>{if(!t.specifiedAddress||t.walletId)return t;let e=this.filterReceiveAddress(this.initWalletAddrListFromChain,t,!1);return e.length?e[0]:t});r(this,"initCheckAddrStatus",()=>{this.checkReceiveAddressLoading=!1,this.receiveAddrStatus=ve.NORMAL});r(this,"checkReceiveAddr",async t=>{if(t||this.receiveAddrObj.specifiedAddress){this.checkReceiveAddressLoading=!0;let{to:e}=this.rootStore.fromToStore;try{let o=await ec(e?.chainId,t||this.computedReceiveAddr),s=Symbol("requestId");if(this.currentRequestId=s,o){let{data:i}=await k.get(oa,{params:{address:t||this.receiveAddrObj.specifiedAddress,chainId:e?.chainId}});this.currentRequestId===s&&at(()=>{this.receiveAddrStatus=i.status})}else at(()=>{this.receiveAddrStatus=ve.ILLEGALITY})}catch(o){b.stuff(o),this.receiveAddrStatus=ve.ILLEGALITY}finally{this.checkReceiveAddressLoading=!1}}else this.initCheckAddrStatus()});r(this,"getSpecifiedChainWalletList",async t=>{let e=await this.getSpecifiedChainWalletListByWeb3(t),o={};return e?.forEach(s=>{let{specifiedAddress:i,walletType:n,createTime:c}=s,d=n===Ko.OKEXCHAIN;o[i]&&o[i]?.has&&d?o[i].walletInfo.createTime<c&&(o[i].walletInfo=s):(!o[i]?.has||d)&&(o[i]={walletInfo:s,has:d})}),Object.keys(o).map(s=>o[s].walletInfo)});r(this,"walletAddrInWeb3",[]);r(this,"getLinkedWalletAddrInWeb3",async()=>{let{computedDiffCrossChain:t,to:e}=this.rootStore.fromToStore,{computedAccountId:o}=this.rootStore.accountStore;if(!t)return;let[s,i]=await O(this.getSpecifiedChainWalletList({chainId:e.chainId,walletIds:[o]}));s||at(()=>{this.walletAddrInWeb3=i})});r(this,"initWalletAddrListFromChain",[]);r(this,"initWalletAddrListInStorage",[]);r(this,"filterWalletAddrListFromChain",[]);r(this,"filterWalletAddrListInStorage",[]);r(this,"getWalletList",async()=>{let{to:t}=this.rootStore.fromToStore,e=await this.getSpecifiedChainWalletList({chainId:t.chainId});at(()=>{this.initWalletAddrListFromChain=e,this.filterWalletAddrListFromChain=e;let o=L.get(to);if(o){let s=o[t.chainId]||[];this.initWalletAddrListInStorage=s,this.filterWalletAddrListInStorage=s}})});r(this,"getFilteredAddrList",t=>{this.filterWalletAddrListFromChain=this.filterReceiveAddress(this.initWalletAddrListFromChain,t),this.filterWalletAddrListInStorage=this.filterReceiveAddress(this.initWalletAddrListInStorage,t)});r(this,"saveWalletAddressToStorage",t=>{this.receiveAddrObj?.specifiedAddress&&L.set(to,{[t.chainId]:[this.receiveAddrObj]})});r(this,"formatInputValue",t=>{let{specifiedAddress:e,deriveName:o,label:s}=t;if(e.length<=9)return e;let i=rr(t.specifiedAddress);return o&&(i=`(${i})`,s?i=`${o} - ${s} ${i}`:i=`${o} ${i}`),i});this.rootStore=t}get computedSwapHighLight(){return this.receiveAddrStatus===ve.NORMAL&&!!this.receiveAddrObj?.specifiedAddress}get computedFormatReceiveAddr(){return this.receiveAddrObj?.specifiedAddress?this.formatInputValue(this.receiveAddrObj):""}get computedReceiveAddr(){return this.receiveAddrObj?.specifiedAddress||""}setReceiveAddress(t){this.receiveAddress=t}getReceiveAddress(){return this.receiveAddress}getSpecifiedChainWalletListByWeb3(){}get computedWalletAddrInWeb3(){return this.walletAddrInWeb3.length?this.walletAddrInWeb3[0]:null}get isFromFilterAddress(){let t=this.filterReceiveAddress(this.initWalletAddrListFromChain,this.receiveAddrObj?.specifiedAddress,!1),e=this.filterReceiveAddress(this.initWalletAddrListInStorage,this.receiveAddrObj?.specifiedAddress,!1);return!!(t.length+e.length)&&!!this.receiveAddrObj?.specifiedAddress}},ol=Gs;var Hs=class extends ol{constructor(e){super(e);r(this,"formatInputValueEx",(e,o)=>{let{keyringName:s,walletName:i}=e;if(o.length<=9)return o;let n=rr(o);return s&&(n=`(${n})`,i?n=`${s} - ${i} ${n}`:n=`${s} ${n}`),n});r(this,"cacheToChainId",-1);r(this,"setCacheToChainId",e=>{this.cacheToChainId=e});r(this,"addressListEx",[]);r(this,"getWalletListEx",()=>{let{accountStore:e,fromToStore:o}=this.rootStore,s=v.getNetWorkName(o.to.chainId),{walletList:i,addressBookList:n,keyringIdentityTypeEnum:c}=e,m=(L.get(to)||{})[o.to.chainId]||[],p=Xu(n,s),S=zu(i,s);this.addressListEx=Ju({recentAddrData:m,addressBookData:p,walletListData:S,chainName:s,keyringIdentityTypeEnum:c})});Xt(this)}get computedFormatReceiveAddrEx(){let{accountStore:e,fromToStore:o}=this.rootStore,{walletConfig:s}=e;if(this.receiveAddrObj.specifiedAddress)return this.formatInputValueEx(this.receiveAddrObj,this.receiveAddrObj.specifiedAddress);let i=v.getNetWorkName(o.to.chainId),n=s?.account[i];return n?(this.receiveAddrObj={...s,specifiedAddress:n},this.formatInputValueEx(s,n)):""}},vr=Hs;u();l();D();u();l();var Qs=class{constructor(t){r(this,"updateTxHash",t=>(b.info(N.UPDATE_HASH,{...t,tags:{orderId:t.orderId,status:t?.status||1}}),k.post(Mn,t).catch(e=>{b.info(N.UPDATE_HASH_ERROR,{...t,error:e,tags:{orderId:t.orderId}})})));r(this,"cancelOrder",t=>(b.info(N.CANCEL_ORDER,{tags:{orderId:t}}),k.get(aa,{params:{id:t}})));this.rootStore=t}},rl=Qs;var Ks=class extends rl{constructor(){super(...arguments);r(this,"sendTransaction",async(...e)=>v.global?.signAndSubmitTransaction(...e));r(this,"sendTransactionEnhance",async(...e)=>this.sendTransaction(...e));r(this,"signTransaction",async(e,o)=>{let[s,i]=await O(v.global.signTypedDataV4(e,o));return[s,i]})}},Rr=Ks;u();l();u();l();D();u();l();D();var $s=class{constructor(t){r(this,"rootStore");this.rootStore=t}checkZeroValue(){let t=null,o=this.rootStore.quoteStore.quote.bestRoute,{fromTokenPrice:s,toTokenPrice:i,fromToken:n,toToken:c}=o;return!Number(s)&&!Number(i)?t=n.tokenSymbol===c.tokenSymbol?$.ALIKE_TOKEN_SYMBOL_PRICE_UNKNOWN:$.ALL_TOKEN_PRICE_UNKNOWN:Number(s)?Number(i)||(t=$.TO_TOKEN_PRICE_UNKNOWN):t=$.FROM_TOKEN_PRICE_UNKNOWN,{errorType:t,continueToNextInterceptor:!1}}checkValueDifference(){let t=null,{fromToStore:e,tradeModeStore:o}=this.rootStore,{computedValueDifference:s,computedIsCrossChain:i}=e,{computedIsSnapType:n}=o;return n?null:(s?.isOver&&(t=i?$.VALUE_DIFFERENCE_TOO_MUCH_CROSS:$.VALUE_DIFFERENCE_TOO_MUCH),{errorType:t,continueToNextInterceptor:!1})}checkMinReceive(){let t=null,e=this.rootStore.fromToStore,{computedIsSnapType:o}=this.rootStore.tradeModeStore;return o?null:(e.computedMinimumReceivedIsOrange&&(t=$.MIN_RECEIVED_TOO_SMALL),{errorType:t,continueToNextInterceptor:!1})}checkRepeatOrderWithEnoughBalance(){let t=null,{swapCheckStore:e}=this.rootStore,{repeatOrder:o}=e;return o?.enoughFlag===ns.ENOUGH&&(t=$.REPEAT_ORDER),{errorType:t,continueToNextInterceptor:!1}}async checkBlockedRepeatOrder(){let t=null,{swapCheckStore:e}=this.rootStore;await e.checkRepeatOrder();let{repeatOrder:o}=e;return o&&(o.repeatFlag===oe.BTC_REPEAT?t=$.REPEAT_ORDER_BTC:o.repeatFlag===oe.FACET_REPEAT?t=$.REPEAT_ORDER_FACET:o.enoughFlag!==ns.ENOUGH&&(t=$.REPEAT_ORDER_NOT_ENOUGH)),{errorType:t,continueToNextInterceptor:!1}}checkFacetTokenCrossChainDetail(){let{fromToStore:t}=this.rootStore,{from:e,to:o,computedNonsupportFacetToken:s}=t;if(s||L.get(En))return null;let i=null;return e.tokenType!==o.tokenType&&(Number(e.tokenType)===Re.FACET||Number(o.tokenType)===Re.FACET)&&(i=$.FACET_SWAP_TIPS),{errorType:i,continueToNextInterceptor:!1}}checkCrossChain(){let t=null;return this.rootStore.fromToStore.computedNeedCrossChainDoubleConfirm&&!L.get(gn)&&(t=$.CROSS_CHAIN_DOUBLE_CONFIRM),{errorType:t,continueToNextInterceptor:!1}}checkGasMoreThanReceive(){let t=null,{fromToStore:e,quoteStore:o}=this.rootStore,{computedIsCrossChain:s}=e,i=o.quote.bestRoute,{toTokenPrice:n,quoteNetWorkFeeOfMoney:c,fromSwapFeeUsd:d}=i,{BigNumber:m}=g;return(s?new m(d):new m(c)).gte(new m(n))&&(t=$.GAS_MORE_THAN_RECEIVE_VALUE),{errorType:t,continueToNextInterceptor:!1}}checkToSwapThanGasFee(){let t=null,{fromToStore:e,quoteStore:o}=this.rootStore,{computedHasToSwap:s}=e,i=Number(e.to.chainId)===1;if(s&&i){let n=y(o,"quote.bestRoute.toSwapFeeUsd"),c=y(o,"quote.bestRoute.bridge.bridgeAmountOutUsd"),d=y(o,"quote.bestRoute.bridge.toRiskLimit");g.BigNumber(n).dividedBy(c).gte(d)&&(t=$.TO_SWAP_THAN_GAS_FEE)}return{errorType:t,continueToNextInterceptor:!1}}checkVolatilitySlippage(){let t=null,o=this.rootStore.slippageStore.computedVolatilityTips?.swapInterceptorType;return o&&(t=o),{errorType:t,continueToNextInterceptor:!0}}async checkBtcBalance(){let{fromToStore:t,safeMoonStore:e}=this.rootStore,{computedIsFromBtcCoin:o,from:s,updateBtcFromBalance:i}=t;if(o){if(!await i())throw Error("btc balance update failed");let c=e.computedInputVal,d=s.availableBalance;if(g.BigNumber(c).gt(d))return{errorType:$.BTC_AVAILABLE_BALANCE_NOT_ENOUGH,continueToNextInterceptor:!1}}return null}async checkCrossChainSwap(){let{swapCheckStore:t}=this.rootStore;await t.checkCrossChainSwap();let e=t.checkSwapMoreInfo?.errorCode;return ya(e)&&e!==0?e===4&&L.get(`${is}_${t.checkSwapMoreInfo?.contentTip?.extra?.bridgeName}_${e}`)||L.get(`${is}_${e}`)?null:{errorType:$.CHECK_CROSS_MORE,continueToNextInterceptor:!1}:null}makeCheckers(){let{fromToStore:{computedIsCrossChain:t}}=this.rootStore;return t?[this.checkVolatilitySlippage,this.checkCrossChainSwap,this.checkBtcBalance,this.checkZeroValue,this.checkToSwapThanGasFee,this.checkValueDifference,this.checkMinReceive,this.checkCrossChain,this.checkGasMoreThanReceive]:[this.checkVolatilitySlippage,this.checkBlockedRepeatOrder,this.checkFacetTokenCrossChainDetail,this.checkZeroValue,this.checkRepeatOrderWithEnoughBalance,this.checkValueDifference,this.checkMinReceive,this.checkGasMoreThanReceive]}async check(){let t=[],e=this.makeCheckers();for(let o=0;o<e.length;o++){let s=e[o],{errorType:i,continueToNextInterceptor:n}=await s.call(this)||{};if(i&&(t.push(i),!n))return t}return t}},sl=$s;var go=class{constructor(t){r(this,"swapBtnErrorTipsDialog",null);r(this,"swapInterceptor");r(this,"isInterceptionProcessing",!1);r(this,"defaultTipsDialogInfo",()=>({type:"",visible:!1,confirmCallBack:()=>{}}));r(this,"notShowAgainCrossChainConfirm",!1);r(this,"setNotShowAgainCrossChainConfirm",t=>{this.notShowAgainCrossChainConfirm=t});r(this,"tipsDialogInfo",this.defaultTipsDialogInfo());r(this,"swapBtnLoading",!1);r(this,"showErrorTips",(t,e)=>{this.tipsDialogInfo={type:t,visible:!0,confirmCallBack:e},this.setNotShowAgainCrossChainConfirm(!1)});r(this,"closeErrorTipsDialog",()=>{this.swapBtnLoading=!1,this.tipsDialogInfo.visible=!1});r(this,"openConfirmSwapDialog",(t,e)=>{let{swapStore:o,commonStore:s}=this,{receiveAddressStore:i}=this.rootStore;i.saveWalletAddressToStorage(e),o.setConfirmSwapVisible(!0),s.portal===_t.MARKET&&qa({token_symbol:e.tokenSymbol,token_chain:e.chainId,token_address:e.tokenContractAddress})});r(this,"connectWallet",()=>{});r(this,"approve",()=>{});r(this,"cancelApprove",()=>{});r(this,"swap",()=>{});r(this,"clickSwapOnDapp",()=>{let{from:t,to:e,computedIsSingleChain:o}=this.fromToStore,{portal:s,computedNotThirdBiz:i}=this.commonStore;or({business_type:o?"swap":"bridge",trade_dialog:i?"no":"yes",source:s,from_token_address:t.tokenContractAddress,to_token_address:e.tokenContractAddress,swap_type:o?"discover_swap":"discover_cross_chain_swap",from_chain:t.chainName,to_chain:e.chainName}),this.rootStore.swapDappStore?.fetchDappList()});r(this,"checkDappTrade",()=>{let t=this.rootStore.swapDappStore?.checkShouldJumpToDapp;return typeof t=="function"&&t()?Je:null});r(this,"isQuoting",()=>{let{fromToStore:t,quoteStore:e,slippageStore:o}=this.rootStore,{isFetchQuoting:s,bestRoute:i,quoteError:n,quoteNull:c}=e.quote,{from:d,to:m,computedTypedValue:p}=t,{tokenContractAddress:S}=d,{computedRealSlippageValue:T}=o;return c||!i&&n&&!s||!p||!m.tokenContractAddress||!S||T>50||T<0?ut:null});r(this,"isHoneypot",()=>this.rootStore?.safeMoonStore?.computedHoneypot?ut:null);r(this,"noAmountOrOverLimit",()=>{let{fromToStore:t}=this,{overLimit:e}=this.rootStore?.safeMoonStore?.computedSlippageTips||{},{computedTypedValue:o}=t;return Number(o)===0||e?ut:null});r(this,"hasFeeConfigErrorTips",()=>this.outerStore.computedFeeConfigErrorTips?ut:null);r(this,"uninitializedWalletInfo",()=>{let{accountStore:{hasInitWalletInfo:t}}=this;return t?null:ut});r(this,"unConnectedWallet",()=>{let{accountStore:{isConnectedWallet:t}}=this;return t?null:je});r(this,"nonsupportChain",()=>{let{accountStore:{computedNonsupportChain:t}}=this;return t?ut:null});r(this,"nonsupportFacetToken",()=>{let{fromToStore:{computedNonsupportFacetToken:t}}=this;return t?ut:null});r(this,"checkReceiveAddressStatus",()=>{let{fromToStore:{computedDiffCrossChain:t}}=this,{receiveAddressStore:{checkReceiveAddressLoading:e,computedSwapHighLight:o}}=this.rootStore;return t&&!o||e?ut:null});r(this,"interceptionProcessing",()=>{let{fromToStore:t}=this;return!this.isInterceptionProcessing&&t.isBalanceLoading||t.fromBalanceState===Z.BALANCE_REQUEST_FAILED?ut:null});r(this,"balanceLessThenInputAmount",()=>this.computedTooBalance?Ye:null);r(this,"approveStatus",()=>{let{approveStore:{computedApprovalStatus:t}}=this;return In[t]||null});r(this,"isValidAmount",()=>{let{fromToStore:t}=this,{from:e,to:o}=t;return o.amount&&e.amount?ze:null});r(this,"getBtnStatus",()=>{let t=[this.hasFeeConfigErrorTips,this.uninitializedWalletInfo,this.unConnectedWallet,this.nonsupportChain,this.nonsupportFacetToken,this.isHoneypot,this.checkDappTrade,this.checkReceiveAddressStatus,this.noAmountOrOverLimit,this.interceptionProcessing,this.balanceLessThenInputAmount,this.isQuoting,this.approveStatus,this.isValidAmount],e;for(let o of t){let s=o();if(s){e=s;break}}return e||(e=ut),e});r(this,"checkIsCurrentQuote",()=>(this.computedIsCurrentQuote||P.warn({title:h("swaptrade_mid_toast_tryagain_with_newquote")}),this.computedIsCurrentQuote));let{accountStore:e,fromToStore:o,swapStore:s,commonStore:i,quoteStore:n,approveStore:c,tradeModeStore:d}=t;this.rootStore=t,this.accountStore=e,this.fromToStore=o,this.swapStore=s,this.commonStore=i,this.quoteStore=n,this.approveStore=c,this.tradeModeStore=d,this.swapInterceptor=new sl(t),Object.assign(this,t)}async runSwapInterceptor(t){this.isInterceptionProcessing=!0;let[e,o]=await O(this.swapInterceptor.check());if(this.isInterceptionProcessing=!1,e){b.error(N.UPDATE_BTC_BALANCE_ERROR_BEFORE_SWAP,{error:e});return}if(o.length===0){t();return}let s=-1,i=()=>{s++;let n=s===o.length-1;this.showErrorTips(o[s],n?t:i)};i()}getBtnAllStatus({from:t,computedIsSingleChain:e}){return{[je]:{statusType:je,disabled:!1,toLocaleText:()=>h(je),onClick:this.connectWallet},[Ye]:{statusType:Ye,disabled:!0,toLocaleText:()=>h(Ye,{tokenSymbol:U(t.tokenSymbol)}),symbol:t.tokenSymbol},[Uo]:{statusType:Uo,disabled:!1,toLocaleText:()=>h(Uo,{tokenSymbol:U(t.tokenSymbol)}),onClick:this.approve,icon:"okx-defi-dex-authorization",iconType:Ro.ICON_POSITION.leading},[Xe]:{statusType:Xe,loading:!0,disabled:!0,toLocaleText:()=>h(Xe)},[rs]:{statusType:Xe,disabled:!1,toLocaleText:()=>h(rs,{ccy:t.tokenSymbol}),onClick:this.cancelApprove,icon:"okx-defi-dex-authorization",iconType:Ro.ICON_POSITION.leading},[Wo]:{statusType:Wo,loading:!0,disabled:!0,toLocaleText:()=>h(Wo)},[ut]:{statusType:ut,disabled:!0,toLocaleText:()=>h(e?ut:ss)},[ze]:{statusType:ze,disabled:!1,loading:this.swapBtnLoading,toLocaleText:()=>h(e?ze:ss),onClick:this.swap},[Je]:{statusType:Je,disabled:!1,loading:this.rootStore.swapDappStore?.swapOnDappBtnLoading,toLocaleText:()=>h(Je),icon:"okds-open-link",iconType:Ro.ICON_POSITION.leading,onClick:this.clickSwapOnDapp}}}get needToCrossChainDoubleCheck(){return!0}get computedTooBalance(){let{rootStore:t,fromToStore:e,accountStore:o}=this,{isConnectedWallet:s}=o,i=e.from.balance,n=t.safeMoonStore.computedInputVal;return s?g.BigNumber(i||0).isLessThan(n):!1}get computedBtnStatus(){let{fromToStore:t}=this,e=this.getBtnStatus();return this.getBtnAllStatus(t)[e]}get computedIsCurrentQuote(){let{fromToStore:t,quoteStore:e}=this,{computedIsExactIn:o,computedTypedValue:s}=t,{quote:i,getGasTokenFeeLoading:n}=e,{fromTokenAmount:c="",inputToTokenAmount:d=""}=i?.bestRoute||{},m=!!s,p=m&&o&&g.BigNumber(s).isEqualTo(c),S=m&&!o&&g.BigNumber(s).isEqualTo(d);return!n&&(p||S)}};u();l();var il=Tt(["tipsDialogInfo","notShowAgainCrossChainConfirm","isInterceptionProcessing","swapBtnLoading"],["computedTooBalance","computedBtnStatus","computedIsCurrentQuote"]);var Se=class extends go{constructor(e){super(e);r(this,"handleSwap",async()=>{let{quote:e,computedIsDexQuote:o}=this.quoteStore,{receiveAddressStore:s}=this.rootStore;if(this.swapBtnLoading=!0,this.walletContractStore.setQuoteData(e.bestRoute),o){let n=await this.walletContractStore.fetchCallData();if(this.swapBtnLoading=!1,n)return}this.swapBtnLoading=!1;let i=o?ot.SWAP:ot.INTENT_SWAP;s.saveWalletAddressToStorage(this.fromToStore?.to),v.history?.push({pathname:It,search:`needUpdate=${qo.on}&type=${i}`})});r(this,"swap",async()=>{let e=this.checkIsCurrentQuote();or({wallet_address:this.accountStore.address,button_name:"confirm",...this.quoteStore.computedMonitorSwapSaveOrderParams}),e&&(this.swapBtnLoading=!0,this.runSwapInterceptor(this.handleSwap))});r(this,"approve",async()=>{let{accountStore:e}=this;this.approveStore.updateCurrentApproveTokenConfig({status:F.Approving});let o=await v.checkMpcAccountIfNecessary();if(Es({wallet_address:e.address}),!o){this.approveStore.updateCurrentApproveTokenConfig({status:F.UnApproved});return}this.approveStore.setApprove()});r(this,"cancelApprove",async()=>{let{accountStore:e}=this;this.approveStore.updateCurrentApproveTokenConfig({status:F.CancelApproving});let o=await v.checkMpcAccountIfNecessary();if(Es({wallet_address:e.address}),!o){this.approveStore.updateCurrentApproveTokenConfig({status:F.CancelApprove});return}this.approveStore.setApprove(Le.CANCEL_APPROVE)});this.walletContractStore=e.walletContractStore,ct(this,il)}};u();l();u();l();D();u();l();u();l();var nl=function(){return new Promise(function(t){setTimeout(t,1)})};u();l();var Ue=E(W());u();l();var Bd=/\s/,al=a=>!(!Aa(a)||Bd.test(a)||a.length<10);u();l();u();l();var Jt={AUTO:1,CUSTOM:2,DEFAULT:3};var qd=g.mul(.5,100),Gd=g.mul(.1,100),js=a=>{let t=y(a,"quoteStore.quote.bestRoute.autoSlippageInfo",{}),{computedDefaultAutoSlippageInfo:e}=a.fromToStore;return{...e,...t}},Co=({isSingleChain:a,autoSlippageInfo:t})=>{let{autoSlippage:e,autoTotalSlippage:o}=t||{};return a?e||.01:o||.03},Nr=a=>{let t=a.fromToStore.computedIsSingleChain,e=js(a),o=Co({isSingleChain:t,autoSlippageInfo:e});return g.mul(g.ceilTruncate(o,3,!1),100)},Hd=a=>{let t=Gt(a);if(t.indexOf(".")>-1){let e=t.split("."),o=e[0],s=e[1];s&&s.length>1&&(s=s.slice(0,1)),t=`${o}.${s}`}return J(t)},Pr=({inputSlippageParams:a,computedSafeMoonTips:t,minSlippageShow:e,maxSlippageShow:o=qd,autoSlippageValue:s=0,isSingleChain:i=!0})=>{let{safeMoonSlippage:n=0,overLimit:c,equalLimit:d}=t||{};if(a===""&&!t)return{slippage:0,inputValue:"",notice:"",isError:!1};let m=Hd(a),p="",S=!1,T=!1;return t?.safeMoonSlippage?c||d||g.BigNumber(m).isZero()?p="":e>m?(p=h("swaptrade_settings_errortip_minimum_slippage",{cross:Lt(e,{needZero:!1})}),S=!0,m=n):n>m?(p=h("swaptrade_settings_errortip_lowslippage_failed",{auto:Lt(n,{needZero:!1})}),T=!0):m>o&&(p=h("swaptrade_card_swap_advance_options_exceeding_desc",{num:Lt(o,{needZero:!1})}),S=!0,m=n):se(m)?(m="",S=!0):m<e?(p=h(i?"swaptrade_dialog_modal_singlechain_limit":"swaptrade_dialog_modal_crosschain_limit",{value:g.thousandFormat(e)}),S=!0):m<s?(p=h("swaptrade_dialog_modal_transaction_failure"),S=!1):m>=Gd&&m<=o?(p=h("swaptrade_adjustslip_modalhint_actual_amount_less",{value:Lt(m,{needZero:!1})}),S=!1):m>o&&(m=o,p=h("swaptrade_card_swap_advance_options_exceeding_desc",{num:Lt(o,{needZero:!1})}),S=!0),{slippage:m,inputValue:a!==""?Gt(m):"",notice:p,isError:S,isWarning:T}},cl=({slippageInfo:a,isSingleChain:t})=>{let{autoSlippageInfo:e,customSlippage:o}=a,s={};return t?o||(s=no(e,["autoSlippage"])):s=no(e,["autoFromSlippage","autoToSlippage","autoTotalSlippage"]),Object.keys(s).forEach(n=>{let c=s[n],d=g.ceilTruncate(c,3,!1);s[n]=g.toPlainString(Number(d))}),{customSlippage:o,autoSlippageInfo:s}};var Io=class{constructor(t){r(this,"defaultGasFee","--");r(this,"isWalletConfirm",!1);r(this,"setWalletConfirm",t=>{this.isWalletConfirm=t});r(this,"isConfirmLoading",!1);r(this,"txInfo",{});r(this,"resetTxInfo",()=>{this.txInfo={}});r(this,"showRecentTransactionModal",t=>{this.confirmSwapVisible=!1,this.rootStore.recentTransactionStore.showModal(t)});r(this,"saveOrderParamsExtendSlippageAndGasPrice",t=>{let e={...t},{computedQuote:o,fromToStore:s}=this,{computedIsSingleChain:i,computedDefaultAutoSlippageInfo:n}=s,{autoSlippageInfo:c}=o.bestRoute||{},d=Co({isSingleChain:i,autoSlippageInfo:n}),m={autoSlippageInfo:c||{}},p=y(this,"rootStore.slippageStore");return p&&(d=p.computedRealSlippageValue,m=p.getOrderSlippageInfo()),Object.assign(e,{slippage:String(d),...cl({slippageInfo:m,isSingleChain:i})})});r(this,"baseSaveOrderParams",()=>{let{accountStore:t,computedQuote:e,fromToStore:o,quoteStore:s,gasDropStore:i}=this,{from:n,to:c}=o,{estimateGasFee:d,minimumReceived:m,gasDropAmount:p}=e.bestRoute||{},{computedIsMevOpen:S}=this.rootStore.mevStore,T={chainId:n.chainId,fromAmount:g.BigNumber(s?.computedQuoteAmount).toString(10),fromTokenAddress:n.tokenContractAddress,fromTokenDecimal:String(n.decimals),toAmount:c.reverseReceiveAmount,toTokenAddress:c.tokenContractAddress,toTokenDecimal:String(c.decimals),userWalletAddress:t.address,estimateGasFee:d,pmm:"1",gasDropType:i?.computedGasDropSelected?1:0,gasDropAmount:p,minimumReceived:m,openMev:S},I=this.rootStore.outerStore.extendFeeConfig(T);return this.saveOrderParamsExtendSlippageAndGasPrice(I)});r(this,"saveOrderSingleChainParams",t=>{let{computedQuote:e}=this,{originDexRouterList:o,dexRouterList:s}=e.bestRoute||{};return{...t,dexRouterList:s,originDexRouterList:o}});r(this,"saveOrderCrossChainParams",t=>{let{computedQuote:e,fromToStore:o}=this,{receiveAddressStore:s}=this.rootStore,{to:i,computedDiffCrossChain:n}=o,{receiveAddrObj:c}=s,{fromDexRouterList:d,bridge:m,toDexRouterToList:p,originFromDexRouterList:S}=e.bestRoute||{};return{...t,toChainId:i.chainId,crossChainDexRouter:{fromDexRouterList:d,toDexRouterToList:p,bridge:m,originFromDexRouterList:S},...n?{receiveWalletAddress:c?.specifiedAddress}:{}}});r(this,"saveOrderParams",()=>{let{fromToStore:t}=this,{computedIsSingleChain:e}=t,o=this.baseSaveOrderParams();return e?this.saveOrderSingleChainParams(o):this.saveOrderCrossChainParams(o)});r(this,"resetFromToAmount",()=>{this.fromToStore.updateFrom({amount:"",currentTime:"",prevAmount:"",usdPrice:""}),this.fromToStore.updateTo({amount:"",prevAmount:"",usdPrice:"",currentTime:""}),this.fromToStore.advanceSetTypedValue("")});r(this,"transferBtcPayload",t=>{let e={...t},{from:o}=this.fromToStore;return e.value=xe(e.value,o.decimals),e});r(this,"getExtParams",t=>{let{computedIsSingleChain:e,to:o,from:s,computedDiffCrossChain:i}=this.fromToStore,{receiveAddrObj:n}=this.rootStore.receiveAddressStore,c=i?n?.specifiedAddress:o.tokenContractAddress;return{txSource:3,orderId:t,toTokenAddress:c,crossChain:e?0:1,chainId:s.chainId,tokenAddress:s.tokenContractAddress,amount:s.amount,toChainId:o.chainId}});r(this,"confirmSwapVisible",!1);r(this,"setConfirmSwapVisible",t=>{this.confirmSwapVisible=t});r(this,"selectTokenHandle",async t=>{let e=this.commonStore.getChainByID(Number(t?.chainId));if(await nl(),!e)return;let{tokenModalStore:o,quoteStore:s}=this.rootStore,{from:i,updateFrom:n,updateTo:c,setBalance:d,setFromBalanceRequestError:m,setToBalanceRequestError:p,to:S,computedIsExactIn:T,needCrossChainDoubleConfirm:I,setNeedCrossChainDoubleConfirm:A}=this.fromToStore,{clearReceiveAddressValue:R}=this.rootStore.receiveAddressStore;o.setCommonlyUsedChain([t?.chainId]),this.quoteStore.isFirstQuote=!0;let w=o.tokenModalFromState===C.FROM,q=()=>{m(!1),d(C.FROM,t.balance)},K=()=>{p(!1),d(C.TO,t.balance)};if(t.selected){w?K():q(),this.fromToStore.onSwitchFromTo();return}w?q():K();let nt=()=>{I||A(!0)};if(w){if(Pa(t.chainId,S.chainId)&&this.commonStore.currentTab===_.BRIDGE){let mt=new Qt(this.commonStore.currentTab,{}),[V,Ge]=await mt.fetchCrossChainTokens({fromChainId:t.chainId,fromTokenAddress:t.tokenContractAddress}),{amount:ci}=i,vo={...t},He;V?(n({...vo,amount:ci}),He=e?.dexDefaultFromToTokenShowVO?.toCrossDexMultiTokenInfoVO,c({...He})):(vo=Ge.data.fromTokenInfo,He=Ge.data.toTokenInfo,n({...vo,amount:ci}),c(He),nt(),this.fromToStore.getTokenBalanceByAccount("from",vo)),this.fromToStore.getTokenBalanceByAccount("to",He)}else if(!this.commonStore.equalsToken(t,i)){let{amount:mt}=i;s.setQuoteNumber(2),n({...t,amount:mt});let{toToken:V,isChanged:Ge}=o.checkFromToLegal(t,S);c(V),Ge&&(nt(),this.fromToStore.getTokenBalanceByAccount("to",M(V))),T&&this.fromToStore.advanceSetTypedValue("")}}else this.commonStore.equalsToken(t,S)||(nt(),s.setQuoteNumber(0),c({...t,amount:""}),T||this.fromToStore.advanceSetTypedValue(""));R()});this.rootStore=t,this.commonStore=t.commonStore,this.accountStore=t.accountStore,this.fromToStore=t.fromToStore,this.tokenModalStore=t.tokenModalStore,this.quoteStore=t.quoteStore,this.gasDropStore=t.gasDropStore}get computedEstimateGasFee(){let t=this.defaultGasFee,e=this.commonStore.nowCurrencyUnit,o=y(this.computedQuote.bestRoute,"quoteNetWorkFeeOfMoney"),s=g.BigNumber(o).multipliedBy(y(e,"usdToThisRate"));return!X(e)&&!s.isNaN()&&(t=et(s.toJSON(),e?.symbol)),t}get computedCrossChainFromFee(){let t=y(this.computedQuote.bestRoute,"fromSwapFeeUsd");if(!t||se(Number(t)))return"--";let{computedNowCurrencySymbol:e,currencyConversion:o}=this.commonStore,s=o(t).toString();return`${et(s,e)}`}updateTxHash(t){this.rootStore.sendTransactionStore.updateTxHash(t)}cancelOrder(t){return this.rootStore.sendTransactionStore.cancelOrder(t)}saveOrderUrl(){return jo}onSaveOrder(t){return b.info(N.SAVE_ORDER_PARAMS,{data:t}),k.post(this.saveOrderUrl(),t)}saveOrderErr(t){let{error_code:e,error_message:o=""}=t,s=t?.data?.code||e||"";return b.error(N.SAVE_ORDER_ERROR,{error:t,tags:{errorCode:e||s,error_msg:`${N.SAVE_ORDER_ERROR}_${s}`}}),e==="10014"?Ee.error({title:h("swaptrade_toast_trade_not_available")}):Ee.error({title:o||h("swaptrade_toast_save_order_fail")})}getSaveOrderMonitorData(){}async onSwap(t){this.isConfirmLoading=!0,b.keepLive();let e=this.saveOrderParams(),[o,s]=await O(this.onSaveOrder(e));if(o){this.saveOrderErr(o),this.isConfirmLoading=!1,b.removeKeep();return}b.info(N.SAVE_ORDER,{data:s?.data,tags:{orderId:s?.data.orderId}}),Va({...this.getSaveOrderMonitorData(),order_id:s?.data.orderId,wallet_type:this.accountStore.walletConfig?.walletType});let[i]=await O(this.onChainTransaction({...s?.data,swapParams:e},t));i&&this.onWalletFail(i,s?.data?.orderId),this.isConfirmLoading=!1,b.removeKeep()}walletErrorMessage(t){let e=null;try{e=JSON.parse(t?.message)}catch{e={}}return e}walletErrToast(t,e){let o,s=this.walletErrorMessage(t);return b.error(N.SEND_ERROR,{error:t,tags:{orderId:e}}),s?.code===Pe.SLIPPAGE_LOW?o=h("swaptrade_home_toast_slippage_too_low"):s?.code===Pe.SEND_TX_ERROR_CODE&&(o=s?.message),Ee.error({title:o||h("swaptrade_home_toast_broadcast_failed")})}onWalletFail(t,e){Ar(t)?this.cancelOrder(e):t?.code!==Ln.RECEIPT_ERROR&&(co.emit(ao.FAIL,{data:{orderId:e},status:-2,message:Kr("transaction fail")}),this.walletErrToast(t,e)),b.error(N.ON_WALLET_FAIL,{error:t,tags:{orderId:e}})}extendEvmParams(t){return t}isOkxWallet(){}async getTransactionPayload({orderData:t,orderId:e}){let{from:o}=this.fromToStore;return wr(o,{orderData:t,extParams:this.getExtParams(e)},this).getSendTransactionParams()}sendTransactionEnhance(...t){return this.rootStore.sendTransactionStore.sendTransaction(...t)}getTransaction(){}logChainId(){}async doubleCheckChainId(){return!0}async onChainTransaction(t,e){let{callData:o,orderId:s,swapParams:i}=t,n=await this.getTransactionPayload({orderData:t,orderId:s}),{computedIsEvmChain:c,from:d}=this.fromToStore;if(b.info(N.PAYLOAD,{payload:n,tags:{orderId:s}}),e)try{await e(...n)}catch(p){return b.error(N.BEFORE_SEND_TRANSACTION_ERROR,{error:p}),!1}return this.logChainId({message:N.CHECK_CHAIN_ID_BEFORE_SEND_TRANSACTION,fromChainId:d.chainId,saveOrderChainId:i.chainId,orderId:s}),await this.doubleCheckChainId({saveOrderChainId:i.chainId,orderId:s})?this.sendTransactionEnhance(...n).then(({result:p,nonce:S})=>{if(!al(p))throw new Error(`hash format is invalid: ${p}`);return this.txInfo={...o,txHash:p},g.BigNumber(S).isNaN()?(this.updateTxHash({orderId:s,transactionHash:p}),c&&this.getTransaction(p,this.fromToStore.from.chainId).then(T=>{b.info(N.UPDATE_NONCE,{nonce:T.nonce,tags:{orderId:s}}),this.updateTxHash({orderId:s,transactionHash:p,nonce:T.nonce})}).catch(T=>{b.error(N.UPDATE_NONCE_FAIL,{error:T})})):this.updateTxHash({orderId:s,transactionHash:p,nonce:S}),this.afterTransaction(s),this.logChainId({message:N.CHECK_CHAIN_ID_AFTER_SEND_TRANSACTION,fromChainId:d.chainId,saveOrderChainId:i.chainId,orderId:s}),!0}):!1}afterTransaction(t){this.setWalletConfirm(!0),this.resetFromToAmount(),this.showRecentTransactionModal(t),co.emit(ao.TXHASH,{status:0,data:M(this.txInfo),message:Kr("Transaction hash has been generated")})}get computedQuote(){return this.quoteStore.quote}checkRepeatOrderDetail(t){t&&this.rootStore.recentTransactionStore.showModal(t)}};u();l();var ul=Tt(["isWalletConfirm","isConfirmLoading","txInfo","confirmSwapVisible"],["computedEstimateGasFee","computedCrossChainFromFee","computedQuote"]);var Te=class extends Io{constructor(e){super(e);r(this,"sendTransactionEnhance",e=>{let{computedIsSolanaChain:o,computedIsTronChain:s,computedIsAptosChain:i,computedIsSuiChain:n,computedIsStacksChain:c,computedIsStarknetChain:d,computedIsFromBtcCoin:m}=this.rootStore?.fromToStore,{from:p}=this.rootStore?.fromToStore,{walletSendParams:S}=this.rootStore.walletContractStore;return this.rootStore.sendTransactionStore.sendTransaction(p.chainId,e,S).then(T=>{let I,A;if(o)I=T.signature;else if(s){let{transaction:R}=T;I=R?.txID}else if(i)I=T;else if(n)I=T;else if(c)I=T.txHash;else if(d)I=T.transaction_hash;else if(m)I=T;else if(lc(p.chainId))I=T.txHash;else{let{hash:R,nonce:w}=T;I=R,A=w}return{result:I,nonce:A}})});r(this,"showRecentTransactionModal",e=>{this.isConfirmLoading=!1,this.confirmSwapVisible=!1,v.history.replace(`${Ot}/${e}`)});r(this,"extendsGas",e=>{let o={...e},{gasInfo:s}=this.rootStore.walletContractStore,{gasLimitInfo:i,isGasLimitLoading:n,gasType:c,...d}=s;return o.extParams.gasType=c,{...o,gasInfo:d}});r(this,"extendEvmParams",e=>{let o=super.extendEvmParams(e),{activityId:s}=this.rootStore.walletContractStore,i=this.rootStore.quoteStore.quote?.bestRoute?.isEnableMev;s&&(o.extParams.activityId=s);let{computedIsMevOpen:n,mevInfo:c}=this.rootStore.mevStore;return n&&(o.extParams.isMev=!0,o.extParams.mevInfo=c),!n&&Number(i)===Qo.ON&&(o.extParams.isShowBlockSwapMevTooltip=!0),o});r(this,"onWalletFail",(e,o)=>{this.isConfirmLoading=!1,!e?.message?.includes(v.global?.HARDWALLETERROR)&&super.onWalletFail(e,o)});r(this,"checkRepeatOrderDetail",e=>{e&&v.history.push(`${Ot}/${e}`)});r(this,"checkUtxoBeforePublish",async e=>{let{utxoList:o}=e,{preDataForSendBtc:s}=this.rootStore.walletContractStore,{checkUtxoBeforePublish:i}=s;await i(o)});r(this,"onSwap",async(...e)=>{this.isConfirmLoading=!0;let o=await v.checkMpcAccountIfNecessary();if(this.isConfirmLoading=!1,!o)return;let{computedIsDexQuote:s}=this.rootStore.quoteStore,{computedIsFromBtcCoin:i}=this.rootStore?.fromToStore;s?await super.onSwap(i?this.checkUtxoBeforePublish:null):await this.rootStore.intentSwapStore?.onIntentSwap(...e)});r(this,"getSaveOrderMonitorData",()=>({...this.quoteStore.computedMonitorSwapSaveOrderParams,...this.rootStore.walletContractStore.computedMonitorGasType}));ct(this,ul)}isOkxWallet(){return!0}getTransaction(){}walletErrorMessage(e){return e}};u();l();u();l();D();u();l();D();u();l();D();var Qd={[_.SWAP]:"swap_used_chain_cache",[_.LIMIT_ORDER]:"limit_used_chain_cache",[_.BRIDGE]:"bridge_used_chain_cache"},ll=(a,t,e)=>{let o=Qd[e],s=L.get(o)||[];if(s.length===0&&(s=t.slice(0,4).map(n=>n.chainId)),a.forEach(i=>{s.includes(i)||s.unshift(i)}),s=s.filter(i=>t.find(n=>n.chainId===i)),s.length<4)for(let i=0;i<t.length&&s.length<4;i++)s.includes(t[i].chainId)||s.push(t[i].chainId);return s.length>4&&(s=s.slice(0,4)),L.set(o,s),s};u();l();var Ao=class{constructor(t,e){r(this,"id",1);r(this,"tokenSymbol","--");r(this,"tokenName","--");r(this,"decimals",6);r(this,"tokenContractAddress","");r(this,"tokenLogoUrl","");r(this,"type","");r(this,"amountNum",0);r(this,"currencyAmount",0);x(this),Object.assign(this,t),this.tokenModalStore=e}get computedPrice(){let{nowCurrencyUnit:t}=this.tokenModalStore.commonStore,{symbol:e,usdToThisRate:o}=t,s=g.BigNumber(this.currencyAmount);return s.isNaN()||s.isZero()?`${e||""}0.00`:e&&o&&!s.isNaN()&&!s.isZero()?et(s.multipliedBy(o).toJSON(),e):"0"}get computedIsSelect(){let{equalsToken:t}=this.tokenModalStore.commonStore,{from:e,to:o}=this.tokenModalStore.fromToStore;return this.tokenModalStore.tokenModalFromState===C.FROM?t(this,o):t(this,e)}get computedIsSelectOrigin(){let{from:t,to:e}=this.tokenModalStore.fromToStore,{equalsToken:o}=this.tokenModalStore.commonStore;return this.tokenModalStore.tokenModalFromState===C.FROM?o(this,t):o(this,e)}get computedAmountNum(){return this.amountNumBigDecimal!==""?this.amountNum:0}toJSON(){return M(this)}};u();l();var _o=(a={})=>({...ft,logoUrl:ft.logoUrl(),chainName:h(ft.localKey),...a}),Dr=(a={},t)=>({...ht,get logoUrl(){return t===fi.dark?ht.darkLogoUrl():ht.logoUrl()},chainName:h(ht.localKey),...a});var dl="hide_collect_cancel_dialog",ml="hideTokenGuide",ge=class{constructor(t){r(this,"searchValue","");r(this,"setSearchValue",t=>{this.searchValue=t});r(this,"fromTokenList",new Map);r(this,"toTokenList",new Map);r(this,"searchTokenList",{});r(this,"error",!1);r(this,"tokenModalVisible",!1);r(this,"tokenModalFromState",C.FROM);r(this,"changeTokenModalFromState",t=>{this.tokenModalFromState=t});r(this,"loading",{[C.FROM]:{},[C.TO]:{}});r(this,"initLoading",()=>{this.loading={[C.FROM]:{},[C.TO]:{}}});r(this,"importTokenInfo",{});r(this,"setImportTokenInfo",t=>{this.importTokenInfo={...t}});r(this,"toSelectedChainId","");r(this,"fromSelectedChainId","");r(this,"setToSelectedChainId",t=>{this.toSelectedChainId=t});r(this,"setFromSelectedChainId",t=>{this.fromSelectedChainId=t});r(this,"extendTokenList",(t=[],e=!0)=>{if(X(t))return t;let o=[];return t.forEach(s=>{if(this.commonStore.getChainByID(J(s.chainId))){let i=new Ao(s,this),n={balance:i.computedAmountNum,selected:i.computedIsSelect,selectedOrigin:e?i.computedIsSelectOrigin:!1,price:i.computedPrice};o.push({...s,...n})}}),o});r(this,"importUserToken",Mt(function*(e,o=!0){let s=e.map(c=>{let{chainId:d,tokenContractAddress:m,tokenSymbol:p,decimals:S}=c;return{chainId:d,contractAddress:m,tokenSymbol:p,precision:S}}),i={userUniqueId:this.commonStore.userUniqueId,tokenDetailList:s},n=[];try{n=(yield k.post(On,i)).data}catch(c){throw P.error(h("swaptrade_pricechart_no_connection_desc")),c}return o&&(this.searchValue="",this.changeTokenModalVisible(!1)),n}));r(this,"orderTokenList",t=>this.computedIsCollectChain?t:La(t,[e=>Number(e.topPlacement),e=>Number(e.currencyAmount),e=>Number(e.amountNum),e=>Number(e.isCollectToken),e=>Number(e.collectTime)],["desc","desc","desc","desc","desc"]));r(this,"formatTokenList",(t,e)=>{let o=t;t.length>100&&e!==ft.chainId&&(o=t.slice(0,100));let s=this.extendTokenList(o,!0);return this.orderTokenList(s)});r(this,"changeTokenModalVisible",t=>{this.tokenModalVisible=t});r(this,"getTokenListByChainId",async()=>{let t=this.tokenModalFromState===C.FROM,e={};if(this.tokenModalFromState===C.FROM?e={fromChainId:this.fromSelectedChainId}:this.tokenModalFromState===C.TO&&(e={fromChainId:this.fromToStore.from.chainId,toChainId:this.toSelectedChainId}),this.tokenModalFromState===C.FROM&&Number(this.fromSelectedChainId)===ht.chainId){this.getFromAllNetworksTokens();return}if(this.tokenModalFromState===C.TO&&Number(this.toSelectedChainId)===ht.chainId){this.getToAllNetworksTokens(e.fromChainId);return}if(this.tokenModalFromState===C.FROM&&Number(this.fromSelectedChainId)===ft.chainId){this.getFromCollectedTokens();return}if(this.tokenModalFromState===C.TO&&Number(this.toSelectedChainId)===ft.chainId){this.getToCollectedTokens(e.fromChainId);return}t?this.getTokenList(C.FROM,e.fromChainId):this.getTokenList(C.TO,e.toChainId,e.fromChainId)});r(this,"setTokenList",(t,e,o)=>{let s=this.formatTokenList(e,t);this[`${o}TokenList`].set(t,s)});r(this,"handleTokenList",Mt(function*(e,o,s,i){this.setError(!1),this[`${e}TokenList`].get(o)||this.setLoading(e,o,!0);try{let{data:n}=yield k.get(s,{params:i}),c=this.toLowerCaseContractAddress(n);return this.setTokenList(o,c,e),this.setLoading(e,o,!1),{data:c}}catch(n){return this.setTokenList(o,[],e),this.setLoading(e,o,!1),this.setError(!0),n}}).bind(this));r(this,"getTokenList",Mt(function*(e,o,s){let i={fromChainId:s,chainId:o,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(i={...i,businessLine:Nt.LIMIT_ORDER});let n=J(o);if(this.computedIsNotSupportToChain)return this.setTokenList(n,[],e),{data:[]};let c=Dt(dt.ALL_TOKENS,this.commonStore.currentTab);return yield this.handleTokenList(e,n,c,i)}));r(this,"getFromCollectedTokens",Mt(function*(){let e={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,fromChainId:"",userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(e={...e,businessLine:Nt.LIMIT_ORDER});let o=Dt(dt.COLLECT_LIST,this.commonStore.currentTab);return yield this.handleTokenList(C.FROM,ft.chainId,o,e)}));r(this,"getToCollectedTokens",Mt(function*(e){let o={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,fromChainId:e,chainId:e,userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(o={...o,businessLine:Nt.LIMIT_ORDER});let s=Dt(dt.COLLECT_LIST,this.commonStore.currentTab);return yield this.handleTokenList(C.TO,ft.chainId,s,o)}));r(this,"getFromAllNetworksTokens",Mt(function*(){let e={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,fromChainId:"",userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(e={...e,businessLine:Nt.LIMIT_ORDER});let o=Dt(dt.ALL_NETWORK,this.commonStore.currentTab);return yield this.handleTokenList(C.FROM,ht.chainId,o,e)}));r(this,"getToAllNetworksTokens",Mt(function*(e){let o={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,fromChainId:e,userWalletAddress:this.accountStore.computedSpecialWalletAddress};this.commonStore?.computedCurrentTabIsLimit&&(o={...o,businessLine:Nt.LIMIT_ORDER});let s=Dt(dt.ALL_NETWORK,this.commonStore.currentTab);return yield this.handleTokenList(C.TO,ht.chainId,s,o)}));r(this,"cancelSearchRef",null);r(this,"needRemoveChainId",t=>[ht.chainId,ft.chainId].includes(J(t)));r(this,"getSearchChainType",()=>{let t=Vo.SINGLE;return this.computedCurrentChainId===ht.chainId&&(t=Vo.ALL_NETWORK),this.computedCurrentChainId===ft.chainId&&(t=Vo.COLLECT),t});r(this,"singleSearchParams",t=>{let e=this.getSearchChainType(),o={userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,chainType:e,searchType:e,userWalletAddress:this.accountStore.computedSpecialWalletAddress},s={},i={};return this.tokenModalFromState===C.FROM?(s={inputContent:t,fromChainId:this.fromSelectedChainId,chainId:this.fromSelectedChainId,toChainId:this.fromSelectedChainId},this.needRemoveChainId(this.fromSelectedChainId)&&(delete s.fromChainId,delete s.toChainId,delete s.chainId)):this.tokenModalFromState===C.TO&&(i={inputContent:t,fromChainId:this.fromToStore.from.chainId,chainId:this.fromToStore.from.chainId,toChainId:this.toSelectedChainId,fromTokenAddress:this.fromToStore.from.tokenContractAddress||""},this.needRemoveChainId(this.toSelectedChainId)&&(delete i.toChainId,delete s.chainId)),{...o,...s,...i}});r(this,"bridgeSearchParams",t=>{let e=this.getSearchChainType(),o={inputContent:t,userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId,chainType:e,userWalletAddress:this.accountStore.computedSpecialWalletAddress};return this.tokenModalFromState===C.FROM&&(o={...o,fromChainId:this.fromSelectedChainId},this.needRemoveChainId(this.fromSelectedChainId)&&delete o.fromChainId),this.tokenModalFromState===C.TO&&(o={...o,fromChainId:this.fromToStore.from.chainId,fromTokenAddress:this.fromToStore.from.tokenContractAddress||"",toChainId:this.toSelectedChainId},this.needRemoveChainId(this.toSelectedChainId)&&delete o.toChainId),o});r(this,"limitSearchParams",t=>({...this.singleSearchParams(t),businessLine:Nt.LIMIT_ORDER}));r(this,"getSearchTokenList",async()=>{if(this.searchValue==="")return;if(this.cancelSearchRef&&this.cancelSearchRef.abort(),this.computedIsNotSupportToChain){this.setSearchTokenList({}),this.setLoading(this.tokenModalFromState,"search",!1);return}this.cancelSearchRef=yt(),this.setLoading(this.tokenModalFromState,"search",!0),this.setError(!1);let t=Cs(this.searchValue),e={};this.commonStore?.currentTab===_.LIMIT_ORDER?e=this.limitSearchParams(t):this.commonStore?.currentTab===_.SWAP?e=this.singleSearchParams(t):this.commonStore?.currentTab===_.BRIDGE&&(e=this.bridgeSearchParams(t)),Ua({keyword:t});let o=Dt(dt.SEARCH,this.commonStore.currentTab),[s,i]=await O(k.get(o,{params:{...e},signal:this.cancelSearchRef?.signal}));if(s&&!this.isCancel(s)&&(this.setError(!0),this.setSearchTokenList({}),this.setLoading(this.tokenModalFromState,"search",!1)),i){let{systemList:n,thirdPartyList:c}=i.data;this.setSearchTokenList({systemList:n,thirdPartyList:c}),this.setLoading(this.tokenModalFromState,"search",!1)}});r(this,"resetTokenModal",()=>{this.resetTokenData()});r(this,"resetTokenData",()=>{this.searchTokenList={},this.searchValue=""});r(this,"balancePushSort",(t,e)=>{let o=[...t],{currencyAmount:s,coinAmountOriginalDec:i}=e;for(let n=0;n<o.length;n++)if(this.commonStore.equalsToken(o[n],e)){o[n].amountNum=i,o[n].currencyAmount=s;break}return o});r(this,"updateAllTokenList",t=>{let{chainId:e}=t,o=J(e),s=this.fromTokenList.get(o);s&&this.setTokenList(o,this.balancePushSort(M(s),t),C.FROM);let i=this.toTokenList.get(o);i&&this.setTokenList(o,this.balancePushSort(M(i),t),C.TO)});r(this,"checkFromToLegal",(t,e)=>{let{currentTab:o}=this.commonStore,s={toToken:{...e,amount:""},isChanged:!1};if(Number(t.chainId)!==Number(e.chainId)){if(this.computedToChain?.some(S=>S.chainId===e.chainId&&!S.disabled))return s;let{dexDefaultFromToTokenShowVO:i}=this.commonStore.getChainByID(this.fromToStore.from.chainId),{fromDexMultiTokenInfoVO:n,toDexMultiTokenInfoVO:c,toCrossDexMultiTokenInfoVO:d}=i,m=o===_.BRIDGE,p;return m&&d?p=d:this.commonStore.equalsToken(t,c)?p=n:p=c,{toToken:p,isChanged:!0}}return s});r(this,"calcCurToChainIdIsInSupList",t=>{let e=!1;return M(this.computedToChain).forEach(o=>{Number(o.chainId)===Number(t)&&!o.disabled&&(e=!0)}),e});r(this,"updateTokenCollected",async(t,e=!1)=>{let{isConnectedWallet:o}=this.accountStore;if(!o){P.error(h("swaptrade_selecttoken_toast_connect_wallet"));return}let s=zo({},{tokenContractAddress:t?.tokenContractAddress||this.rootStore.klineStore.chooseTokenContractAddress,chainId:Number(t?.chainId),symbol:t?.tokenSymbol,decimal:t?.decimals,isCustomToken:t?.isCustomToken||t?.isSubscribe,walletAddress:this.accountStore.address||this.accountStore.computedAccountWalletAddressesArray[0],userUniqueId:this.commonStore.userUniqueId,accountId:this.accountStore.computedAccountId}),[i,n]=await O(k.post(Yo,s));this.updateTokenCollectedLocal(t),i?(P.error(h("swaptrade_pricechart_no_connection_desc")),this.updateTokenCollectedLocal(zo({},t,{isCollectToken:t?.tokenInfo?0:1}))):n?.data===-1?e?P.error({title:h("swaptrade_selecttoken_modal_favorite_limitreached"),duration:.5}):this.setShowCollectOverLimitDialog(!0):n?.data===0?(P.success({title:h("swaptrade_selecttoken_toast_removed_from_favorite"),duration:.5}),this.rootStore.marketInfoStore.setIsCollected(!1)):n?.data===1&&(er(),P.success({title:h("swaptrade_selecttoken_toast_added_to_favorite"),duration:.5}),this.rootStore.marketInfoStore.setIsCollected(!0))});r(this,"hideCollectCancelConfirm",L.get(dl));r(this,"showCollectOverLimitDialog",!1);r(this,"setShowCollectOverLimitDialog",t=>{this.showCollectOverLimitDialog=t});r(this,"setCommonlyUsedChain",t=>{let{from:e,to:o}=this.fromToStore,{chainList:s,currentTab:i}=this.commonStore,n=t&&t.length>0?t:[e.chainId,o.chainId];return ll(n,s,i)});r(this,"tokenPageChainList",[]);r(this,"setTokenPageChainList",t=>{this.tokenPageChainList=t});r(this,"getCurrentToChainInfo",()=>this.computedToChain.find(e=>J(e.chainId)===J(this.toSelectedChainId)));r(this,"changeTokenPageChainList",async t=>{if(this.tokenPageChainList.findIndex(o=>J(o.chainId)===J(t))===-1){let o=this.commonStore.chainList.find(i=>J(i.chainId)===J(t)),s=[...this.tokenPageChainList];s.unshift(o),s.length>4&&s.pop(),this.setTokenPageChainList(s)}this.tokenModalFromState===C.FROM?this.setFromSelectedChainId(t):this.setToSelectedChainId(t),await this.getTokenListByChainId()});r(this,"searchChainKeywords","");r(this,"setSearchChainKeywords",t=>{this.searchChainKeywords=t});r(this,"filterChains",t=>so(t,e=>{let o=Pt(Cs(this.searchChainKeywords));return Pt(e.chainName).includes(o)}));r(this,"dialogIndex",ms.TOKEN_LIST);r(this,"setDialogIndex",t=>{this.dialogIndex=t});r(this,"hideTokenGuide",!!L.get(ml));r(this,"setHideTokenGuide",()=>{this.hideTokenGuide=!0,L.set(ml,"1")});r(this,"importToken",async(t,e)=>{let s=(await this.importUserToken(Array.isArray(t)?t:[t]))[0]||{};e&&e(s),Ir(s)&&await this.fromToStore.getTokenBalanceByAccount(this.tokenModalFromState,s),this.setImportTokenInfo({}),this.setDialogIndex(ms.TOKEN_LIST)});r(this,"reloadTokenList",async()=>{!this.tokenModalVisible||(this.searchValue!==""?await this.getSearchTokenList():await this.getTokenListByChainId())});this.rootStore=t,this.commonStore=t.commonStore,this.swapStore=t.swapStore,this.accountStore=t.accountStore,this.fromToStore=t.fromToStore}get computedIsSearching(){return!!this.searchValue}setSearchTokenList(t){this.searchTokenList=t}setError(t){this.error=t}setLoading(t,e,o){this.loading[t][e]=o}get computedTokenList(){return this.tokenModalFromState===C.FROM?this.fromTokenList.get(this.fromSelectedChainId):this.toTokenList.get(this.toSelectedChainId)}get computedSearchTokenList(){let t={};return X(this.searchTokenList)||(t={systemList:this.extendTokenList(this.searchTokenList?.systemList,!1),thirdPartyList:this.extendTokenList(this.searchTokenList?.thirdPartyList,!1)}),t}toLowerCaseContractAddress(t){let e=[];return Array.isArray(t)&&t.forEach(o=>{e.push({...o,tokenContractAddress:this.commonStore.getTokenAddress(o)})}),e}isCancel(t){return Ht(t)}get computedFromChain(){let t=_o(),e=Dr({},this.commonStore.currentTheme);return[t,e,...M(this.tokenPageChainList)]}get computedToChain(){let t=_o();if(G(this.fromToStore.from.chainId)){let e=this.tokenPageChainList.filter(o=>o?.chainId===this.fromToStore.from.chainId);return[t,...e]}return[t]}get computedCurrentToChainId(){return this.toSelectedChainId?this.toSelectedChainId:G(this.fromToStore.to.chainId)?this.calcCurToChainIdIsInSupList(this.fromToStore.to.chainId)?this.fromToStore.to.chainId:this.fromToStore.from.chainId:this.computedToChain.length>1?ht.chainId:oo}reassignTokenInfo(t,e,o){if(this.commonStore.equalsToken(t,e)){let s=e?.isCollectToken;return zo({},e,{isCollectToken:s?0:1,collectTime:s?"":Date.now().toString(),isCustomToken:o?1:e?.isCustomToken})}return t}filterCollectToken(t){let e=!t.isCustomToken||t.balance;return!!(!this.computedIsCollectChain&&e||this.searchValue||t.isCollectToken)}updateTokenCollectedLocal(t){let e=(o=[],s)=>o.map(i=>this.reassignTokenInfo(i,t,s)).filter(i=>this.filterCollectToken(i));if(this.searchValue){let{systemList:o,thirdPartyList:s}=this.searchTokenList;this.setSearchTokenList({systemList:e(o),thirdPartyList:e(s,!0)})}else this.updateTokenList(e)}updateTokenList(t){if(this.tokenModalFromState===C.FROM){let e=t(this.fromTokenList.get(this.fromSelectedChainId));this.fromTokenList.set(this.fromSelectedChainId,e)}else if(this.tokenModalFromState===C.TO){let e=t(this.toTokenList.get(this.toSelectedChainId));this.toTokenList.set(this.toSelectedChainId,e)}}get computedCurrentChainId(){return J(this.tokenModalFromState===C.FROM?this.fromSelectedChainId:this.toSelectedChainId)}get computedIsCollectChain(){return this.computedCurrentChainId===ft.chainId}setShowCollectCancelConfirm(t){L.set(dl,t),this.hideCollectCancelConfirm=t}get computedIsNotSupportToChain(){let t=this.getCurrentToChainInfo();return this.tokenModalFromState===C.TO&&t&&t.disabled}get computedSelectedChainId(){return this.tokenModalFromState===C.FROM?this.fromSelectedChainId||this.fromToStore.from.chainId:this.tokenModalFromState===C.TO?this.toSelectedChainId||this.fromToStore.to.chainId:""}get computedAllChainList(){let t=this.commonStore.chainList;return this.tokenModalFromState===C.FROM?{supported:t,unsupported:[]}:this.tokenModalFromState===C.TO?this.computedToChainList:{supported:[],unsupported:[]}}get computedToChainList(){let t=this.commonStore.chainList,e=Zo(M(t),{chainId:Number(this.fromToStore.to.chainId)});return{supported:e?[e]:[],unsupported:[]}}get computedIsSearchChainStatus(){return!!this.searchChainKeywords}get computedSearchedChainList(){if(!this.computedIsSearchChainStatus)return{supported:[],unsupported:[]};let{supported:t,unsupported:e}=this.computedAllChainList;return{supported:this.filterChains(t),unsupported:this.filterChains(e)}}get computedTokenGuideVisible(){return!1}};var yo=class extends ge{constructor(t){super(t),this.removeToken().catch(()=>{})}async removeTokenByChainId(t){let e={},o=L.get(t)||[];return o.length>0&&(e=await this.importUserToken(o),L.set(t,[])),e.data||[]}removeToken(){let t=[];return Object.values(B).forEach(e=>{t.push(this.removeTokenByChainId(e))}),Promise.all(t)}};var xr=class extends yo{constructor(e){super(e);r(this,"showChainTab",!0);r(this,"generateToChainMap",()=>{let e=this.commonStore.chainList,s=Zo(M(e),{chainId:Number(this.fromToStore.from.chainId)})?.bridgeSupportChainInfoList||[];return Ea([...s],"chainId")});Xt(this)}get computedTokenGuideVisible(){let{tokenModalFromState:e,hideTokenGuide:o}=this;return e===C.TO&&!o}get computedToChainList(){let e=this.commonStore.chainList,o=[],s=[],i=this.generateToChainMap();return e.forEach(n=>{let c={...n};c.disabled=!i[n.chainId],c.disabled||o.push(c)}),{supported:o,unsupported:s}}get computedToChain(){let e=_o(),o=Dr({},this.commonStore.currentTheme);if(G(this.fromToStore.from.chainId)){let s=this.generateToChainMap(),i=[];return M(this.tokenPageChainList).forEach(n=>{n.chainId!==Number(this.fromToStore.from.chainId)&&i.push({...n,disabled:!s[n.chainId]})}),[e,o,...i]}return[e]}};u();l();D();var Ys=class{constructor(t){r(this,"sendTransactionParams",{});r(this,"waitingHandleOrderList",[]);r(this,"needIntercept",!1);r(this,"updateHistoryOrderList",t=>{let e=rt(),o=[],s=[],i=this.rootStore.recentTransactionStore;i.pendingOrders.forEach(n=>{let c=n;n.orderId===t&&(c={...n,status:cr.PendingRedeeming}),o.push(c)}),!e&&i.history?.list?.forEach(n=>{let c=n;n.orderId===t&&(c={...n,status:cr.PendingRedeeming}),s.push(c)}),i.setPendingOrders(o),!e&&i.setHistory({...i.history,list:s})});r(this,"sendTransactionEnhance",async({callData:t,chainId:e,redeemOrderIdPre:o,redeemOrderId:s,bizType:i},n)=>{let c=rt(),d=`${o}:${s}`;if(!c&&this.setWaitingHandleList(d),this.needIntercept)return;let m;if(rt()){let p=this.rootStore.swapStore.extendsGas(t);m=this.sendTransactionStore.sendTransactionEnhance(e,p,this.rootStore?.walletContractStore?.walletSendParams)}else{if(!await this.rootStore.commonStore.connectAndSwitchNetwork(e))return;m=this.sendTransactionStore.sendTransactionEnhance(t)}m.then(({result:p,hash:S,nonce:T})=>{!c&&this.setWaitingHandleList(d,!0),this.sendTransactionStore.updateTxHash({orderId:s,transactionHash:c?S:p,bizType:i,nonce:T}),Na(n),this.updateHistoryOrderList(o),c||this.sendTransactionStore.getTransaction(p,e).then(I=>{b.info(N.UPDATE_NONCE,{nonce:I.nonce,tags:{orderId:s}}),this.sendTransactionStore.updateTxHash({orderId:s,transactionHash:p,nonce:I.nonce,bizType:i})}).catch(I=>{b.error(N.UPDATE_NONCE_FAIL,{error:I,transactionHash:p,tags:{orderId:s}})})}).catch(p=>{!c&&this.setWaitingHandleList(d,!0),b.error(N.REDEEM_ORDER_ERROR,{error:p,tags:{orderId:s}})})});r(this,"walletSendRedeem",()=>{this.sendTransactionEnhance(this.sendTransactionParams,()=>{v.history?.goBack()})});r(this,"facetOrderDetail",{});this.rootStore=t,this.sendTransactionStore=t.sendTransactionStore,x(this,{},{autoBind:!0})}setSendTransactionParams(t){this.sendTransactionParams=t}async launchFacetSwap(t){let e=rt(),{data:o}=this.rootStore.recentTransactionStore.detail,s=t?t.orderId:o?.orderId,i=t?t.chainId:o?.fromChainId,n=t?t.toTokenAddress:o?.toTokenAddress,c=t?t.fromTokenAddress:o?.fromTokenAddress,d={orderId:s,chainId:i,userWalletAddress:this.rootStore.accountStore.getAddressByChainId(i)};if(e&&t?.goOrderDetail){v.history?.push(`${Ot}/${s}`);return}let[m,p]=await O(k.post(na,d));if(m){b.error(N.REDEEM_ORDER_CALL_DATA_ERROR,{error:m,tags:{orderId:s}}),Number(m?.code)===100002&&this.rootStore.recentTransactionStore.removePendingOrder(s),P.error({title:m?.msg||h("swaptrade_top_notif_data_failed")});return}let{redeemSignatureVo:S,redeemDetailInfo:T,redeemOrderId:I,bizType:A}=p?.data||{},{unsignedTx:R,...w}=S||{},q={...w,extParams:{toTokenAddress:n,crossChain:0,tokenAddress:c,amount:T.fromTokenAmount,toChainId:i,...d}},K={callData:q,chainId:i,redeemOrderIdPre:s,redeemOrderId:I,bizType:A};if(this.setSendTransactionParams(K),b.info(N.REDEEM_ORDER,{callData:q,tags:{orderId:I}}),e){this.setFacetOrderDetail({...T}),this.rootStore.walletContractStore.setTransactionPayload(q),v.history?.push({pathname:It,search:`needUpdate=${qo.off}&type=${ot.REDEEM}`});return}await this.sendTransactionEnhance(K)}setWaitingHandleList(t,e){this.waitingHandleOrderList.find(s=>s===t)?e?(this.waitingHandleOrderList=this.waitingHandleOrderList.filter(s=>s!==t),this.needIntercept=!1):(P.warn({title:h("swaptrade_history_notification_desc_wallet_confirm")}),this.needIntercept=!0):(this.waitingHandleOrderList=[...this.waitingHandleOrderList,t],this.needIntercept=!1)}getFacetExploreUrl(t){let{data:e}=this.rootStore.recentTransactionStore.detail,o=[e?.fromChildOrderDetailVo?.exploreUrl,e?.relativeTransaction?.exploreUrl];return this.computedIsFacetTradeType&&o?.[t]||""}get computedIsFacetTradeType(){let{data:{specialOrderType:t}}=this.rootStore.recentTransactionStore.detail;return t===dc.FromIsEthChainFacetCoin}get computedShowFacetTip(){return this.rootStore.recentTransactionStore.detail.data.status===cr.PendingCanRedeem}setFacetOrderDetail(t){this.facetOrderDetail=t}get computedFacetOrderToFromRate(){let{price:t}=this.facetOrderDetail;return t&&!qt(t)&&t!=="-1"?j(t):""}get computedFacetOrderFromToRate(){let{price:t}=this.facetOrderDetail;return t&&!qt(t)&&t!=="-1"?j(g.BigNumber("1").div(t).toString(10)):""}get computedFacetOrderTokens(){let{fromToken:t,toToken:e,fromTokenAmount:o,toTokenAmount:s}=this.facetOrderDetail;return{fromToken:{...t,amount:o},toToken:{...e,amount:s}}}get computedFacetOrderMinimumReceived(){return this.facetOrderDetail.minimumReceived}get computedFacetTipParams(){let t=this.rootStore.recentTransactionStore.detail?.data;return{amount:j(t?.fromChildOrderDetailVo?.toAmountOut,{needBillionMillionUnit:!1}),token:t?.fromChildOrderDetailVo?.toTokenSymbol}}},Fr=Ys;u();l();D();var Ce=class{constructor(t){r(this,"liquidityModelVisible",!1);r(this,"dataStatus",z.DEFAULT);r(this,"setDataStatus",t=>{this.dataStatus=t});r(this,"rawData",[]);r(this,"LiquidityCancelRef",null);r(this,"fetchLiquidityData",async()=>{this.resetAllLiquidityData(),this.setDataStatus(z.LOADING);let{from:t}=this.fromToStore;this.LiquidityCancelRef&&this.LiquidityCancelRef.abort(),this.LiquidityCancelRef=yt();let[e,o]=await O(k.get(ca,{params:{chainId:t.chainId},signal:this.LiquidityCancelRef?.signal,isolate:!0}));if(e)this.setDataStatus(z.ERROR);else{let s=y(o,"data");X(s)?this.setDataStatus(z.NULL):(this.initAllLiquidityData(s),this.setDataStatus(z.READY))}});r(this,"selectedListIds",[]);r(this,"setSelectedListIds",t=>{this.selectedListIds=t});r(this,"confirmIds",null);r(this,"setConfirmIds",t=>{this.confirmIds=t});r(this,"filterSelectedListIds",(t,e)=>{let o;e?o=As(this.selectedListIds,t):o=ga(this.selectedListIds,t),this.setSelectedListIds(De(o))});r(this,"searchLiquidityValue","");r(this,"setLiquiditySearchValue",t=>{this.searchLiquidityValue=t});this.rootStore=t,this.fromToStore=this.rootStore.fromToStore,x(this,{},{autoBind:!0})}setLiquidityModelVisible(t){this.liquidityModelVisible=t}setData(t){this.rawData=t}resetAllLiquidityData(){this.setData([]),this.setSelectedListIds([]),this.setConfirmIds(null)}initAllLiquidityData(t){this.setData(t);let e=tr(t,"id");this.setSelectedListIds(e);let o=this.fromToStore.from.chainId;G(o)&&this.setConfirmIds(ba({},o,e))}get computedListCheckedAll(){return this.computedSearchStatus?this.computedSearchIfAllChecked:this.selectedListIds.length===this.rawData.length}get computedCheckedAllDisabled(){return this.computedSearchStatus&&X(this.computedSearchData)}get computedLiquidityNum(){let{from:t}=this.rootStore.fromToStore,e="--",{dataStatus:o,rawData:s,confirmIds:i}=this;if(o===z.NULL)e="0 / 0";else if(o===z.READY){let n=y(i,t.chainId);e=`${!n||n&&n.length===0?s.length:n.length} / ${s.length}`}return e}get computedClearAll(){return X(this.selectedListIds)}checkAllBtn(){let t="",e=this.computedSearchStatus?this.computedSearchData:this.rawData,o=tr(e,"id");this.computedListCheckedAll?t=As(this.selectedListIds,...o):t=va(this.selectedListIds,o),this.setSelectedListIds(De(t))}get computedCheckedData(){return tr(this.rawData,e=>({...e,isChecked:!!_a(this.selectedListIds,e.id)}))}get computedSortListData(){return Qa(this.computedCheckedData)}get computedSearchStatus(){return!!this.searchLiquidityValue}get computedSearchDataIsNull(){return this.computedSearchStatus&&X(this.computedSearchData)}get computedSearchData(){return Ka(this.computedCheckedData,this.searchLiquidityValue)}get computedSearchIfAllChecked(){let t=Ca(this.computedSearchData,e=>e?.isChecked);return!X(this.computedSearchData)&&t}get computedShowData(){return this.searchLiquidityValue?this.computedSearchData:this.computedSortListData}get computedIds(){return y(this.rootStore.liquidityChooseStore?.confirmIds,this.rootStore.fromToStore?.from.chainId)}get computedIsCustomLiquidity(){return(this.computedIds||[]).length<this.rawData.length}get computedMonitorLiquidSelectType(){let{computedIds:t=[],rawData:e}=this;return!t.length||t.length===e?.length?"all":t.length>1?"custom_>1":t.length===1?"custom_=1":""}get computedIsSelectedAllDex(){let{computedIds:t=[],rawData:e}=this;return!t.length||t.length===e?.length}};u();l();D();var Xs=class{constructor(t){r(this,"orderCheckContinue",async t=>{let[e,o]=await O(k.get(ua,{params:t}));if(e)return P.error({title:h("swaptrade_history_toast_setup_error"),duration:At}),!1;let s=y(o,"data"),i=String(s?.checkCode);return i===Ne.SUCCESS?!0:(i===Ne.SINGLE_ERROR||i===Ne.LIMIT_SINGLE_ERROR?P.error({title:h("swaptrade_history_toast_chain_unsupported",{chain:s?.fromChainName}),duration:At}):i===Ne.CROSS_ERRORL||i===Ne.LIMIT_CROSS_ERRORL?P.error({title:h("swaptrade_history_toast_both_unsupported",{fromChain:s?.fromChainName,toChain:s?.toChainName}),duration:At}):P.error({title:h("swaptrade_history_toast_setup_error"),duration:At}),!1)});this.rootStore=t,x(this,{},{autoBind:!0})}},Mr=Xs;u();l();D();var{BigNumber:pl}=g,zs="safemoon_slippage",Js="safemoon_is_changed",hl=50,Zs={NeedIncreaseSlip:0,AdviseGivenSlip:1,NotAvailableGivenSlip:2,AdviseSlip:3},Ie=class{constructor(t){r(this,"isChanged",!1);r(this,"getSafemoonIsChangedLocal",()=>!!L.get(`${Js}_${this.computedSlippageTokenPair}`));r(this,"cacheSlippage",0);x(this),this.rootStore=t,this.commonStore=t.commonStore,this.fromToStore=t.fromToStore,Ct(()=>this.computedSlippageTokenPair,()=>{this.setSafeMoonIsChanged(L.get(`${Js}_${this.computedSlippageTokenPair}`)),this.setCacheSlippage(L.get(`${zs}_${this.computedSlippageTokenPair}`))}),Ct(()=>({slippage:this.computedPairSlippage}),()=>{this.cacheSlippage>0&&this.computedPairSlippage>this.cacheSlippage&&this.setSafeMoonIsChanged(!1),this.setCacheSlippage(L.get(`${zs}_${this.computedSlippageTokenPair}`))}),Ct(()=>this.computedSlippage,e=>{this.commonStore.safemoonSlippage=e})}setSafeMoonIsChanged(t){this.isChanged=t,L.set(`${Js}_${this.computedSlippageTokenPair}`,t)}checkIsChanged(t){let e=new pl(t),o=e.gte(this.computedPairSlippage)&&e.lte(50);o&&this.setSafeMoonIsChanged(o)}setSafeMoonPairSlippage(t){!this.isAccessSlippage(t)||(this.setCacheSlippage(t),L.set(`${zs}_${this.computedSlippageTokenPair}`,t))}isAccessSlippage(t){let e=new pl(t);return this.computedPairSlippage>0&&e.gte(this.computedPairSlippage)&&e.lte(50)}get computedAutoSlippage(){return Nr(this.rootStore)}get computedSafeMoonToken(){let{from:t,to:e}=this.fromToStore;return this.checkIsSafeMoon(t)?t:this.checkIsSafeMoon(e)?e:null}get computedHoneypot(){let{from:t,to:e}=this.fromToStore;return this.checkIsHoneypot(t)?t:this.checkIsHoneypot(e)?e:null}setCacheSlippage(t){this.cacheSlippage=t}get computedPairSlippage(){return this.computedSafeMoonToken?1.1:0}get computedSlippage(){return this.cacheSlippage>this.computedPairSlippage?this.cacheSlippage:this.computedPairSlippage}get computedOverLimit(){return this.computedSlippage>50}get computedSlippageTokenPair(){let{from:t,to:e}=this.fromToStore;return`${this.checkIsSafeMoon(t)?t.tokenContractAddress:""}_${this.checkIsSafeMoon(e)?e.tokenContractAddress:""}`}get computedSlippageTips(){let t=y(this,"rootStore.quoteStore.quote.bestRoute"),e=Number(this.computedAutoSlippage),{tokenSymbol:o}=this.computedSafeMoonToken||{};return t?.isSafeMoonToken!=="1"||t?.isHoneypot==="1"?null:e===hl?{type:Zs.AdviseGivenSlip,safeMoonSlippage:e,equalLimit:!0,tip:h("swaptrade_card_errortip_autoadjust_to_50",{tokenSymbol:o,slippageTolerance:e}),tipEquation:h("swaptrade_card_errortip_autoadjust_to_50",{tokenSymbol:U(o),slippageTolerance:e}),inputWarning:h("swaptrade_adjustslip_modal_advise_givenslip")}:e>hl?{type:Zs.NotAvailableGivenSlip,overLimit:!0,safeMoonSlippage:e,tip:h("wallet_swap_adjustslip_modal_slip_notsupported",{tokenSymbol:o}),tipEquation:h("wallet_swap_adjustslip_modal_slip_notsupported",{tokenSymbol:U(o)})}:{type:Zs.AdviseSlip,safeMoonSlippage:e,tip:h("swaptrade_card_errortip_autoadjust_to_less50",{slippageTolerance:e,tokenSymbol:o}),tipEquation:h("swaptrade_card_errortip_autoadjust_to_less50",{slippageTolerance:e,tokenSymbol:U(o)}),inputWarning:h("swaptrade_modal_errortip_adjust_to_suggested_range",{slippageTolerance:e})}}checkIsSafeMoon(t){return y(t,"isSafeMoonToken")===1}checkIsHoneypot(t){return y(t,"isHoneypot")===1}get computedInputVal(){let{computedIsExactIn:t,computedSwapAmount:e}=this.fromToStore;return!t&&this.computedHoneypot?"":e[C.FROM]}get computedInputFiatVal(){let{computedIsExactIn:t,computedFromLocalCostByUsd:e}=this.fromToStore;return!t&&this.computedHoneypot?"":e}get computedOutputVal(){let{computedIsExactIn:t,computedSwapAmount:e}=this.fromToStore;return t&&this.computedHoneypot?"":e[C.TO]}get computedOutputFiatVal(){let{computedIsExactIn:t,computedToLocalCostByUsd:e}=this.fromToStore;return t&&this.computedHoneypot?"":e}get computedOutputPopVal(){let{computedSwapAmount:t}=this.fromToStore;return this.computedHoneypot?"":t[C.TO]}};u();l();D();var Br=class{constructor(){r(this,"gasDropConfig",{gasDropShow:!1,gasDropSwitch:L.get(us)===Tn.OPEN,chainName:"",chainId:"",deduction:"",gasDrop:"",tokenLogoUrl:"",tokenSymbol:""});r(this,"setGasDropInfo",t=>{this.gasDropConfig={...this.gasDropConfig,...t}});r(this,"setGasDropSwitch",t=>{this.setGasDropInfo({gasDropSwitch:t}),L.set(us,`${Number(t)}`)});r(this,"resetGasDrop",()=>{this.setGasDropInfo({gasDropShow:!1})});x(this)}get computedGasDropSelected(){let{gasDropShow:t,gasDropSwitch:e}=this.gasDropConfig;return t&&e}};u();l();var ti=class{constructor(t){r(this,"isShowMev",!1);r(this,"setShowMev",t=>{this.isShowMev=t});r(this,"isMevUserSwitchOpen",Oe.DEFAULT);r(this,"setMevUserSwitchOpen",t=>{this.isMevUserSwitchOpen=t});r(this,"mevInfo",{});r(this,"setMevInfo",t=>{this.mevInfo=t});this.rootStore=t,this.quoteStore=this.rootStore.quoteStore,this.fromToStore=this.rootStore.fromToStore,x(this,{},{autoBind:!0})}get computedIsMevOpen(){return this.isMevUserSwitchOpen===Oe.DEFAULT?this.isShowMev:this.isMevUserSwitchOpen===Oe.ON}},Ur=ti;u();l();D();var ei=class{constructor(t){r(this,"feeConfig",{});r(this,"setFeeConfig",t=>{if(!this.isIframe)return;if(!X(t)){this.feeConfig=t,L.session.set("feeConfig",t);return}let e=L.session.get("feeConfig"),o=no(e,["referrerAddress","feePercent"]);X(o)?(this.feeConfig={},L.session.remove("feeConfig")):this.feeConfig=o});r(this,"receiveQuoteUrl",()=>this.isIframe?Pn:xn);r(this,"saveOrderUrl",()=>this.isIframe?Fn:jo);r(this,"extendFeeConfig",t=>{if(!this.computedHasFeeConfig)return t;let e=X(this.feeConfig)?L.session.get("feeConfig"):this.feeConfig;return{...t,...e}});x(this),this.rootStore=t,this.isIframe=!rt()&&xa()&&!Be}get computedHasFeeConfig(){return!!this.feeConfig?.referrerAddress&&!!this.feeConfig?.feePercent&&this.isIframe}get computedFeeConfigErrorTips(){if(!this.computedHasFeeConfig)return!1;let{BigNumber:t}=g;return!!(t(this.feeConfig?.feePercent).isNaN()||t(this.feeConfig?.feePercent).gt(yn)||t(this.feeConfig?.feePercent).lt(0))}},Wr=ei;u();l();D();u();l();var fl=()=>{let{swapStore:a,intentSwapStore:t,tradeModeStore:e,swapDappStore:o}=Bt();return!(a.isConfirmLoading||t.isConfirmLoading||!e.tradingModeType||o.computedSupportDappTradeByChain)};u();l();u();l();var Sl=a=>{let{fromToStore:t,quoteStore:e}=Bt(),{commonDexInfo:o,pathSelectionRouterList:s,singleChainSwapInfo:i}=a,{computedIsSingleChain:n}=t,c=Number(o?.code)===Ut.CROSS_CHAIN_INTERVAL,d=c?{crossMaxAmount:o?.crossMaxAmount,crossMiniAmount:o?.crossMiniAmount}:null;return e.setQuoteScope(d),{isAutoError:c||(n?!i:!s?.length)}};var Kd=({quoteStore:a,fromToStore:t})=>{a.setQuoteNumber(a.quoteNumber+1),a.quoteNumber===1&&a.checkQuoteScopeLtMin(a.quoteScope,t.from.amount)&&t.advanceSetTypedValue("")},$d=(a,{fromToStore:t,quoteStore:e})=>{let{commonDexInfo:o,pathSelectionRouterList:s,singleChainSwapInfo:i,swapType:n,intentCode:c,isSupportDappTrade:d,tradingModeType:m,supportSnapMode:p}=a,S={intentCode:c,tradingModeType:m,supportSnapMode:p,swapType:n},T=s?.map(A=>({...o,...A,...S,isSupportDappTrade:d}));return{bestRoute:t.computedIsSingleChain?{...i,...o,...S,intentInfo:a?.intentInfo||{},isSupportDappTrade:d}:e.pickBestRouterAccordingBridgeId(T)||{...o,...S,isSupportDappTrade:d},combineSelectionRouterList:T}},jd=({bestRoute:a,combineSelectionRouterList:t,isAutoError:e},{fromToStore:o,quoteStore:s})=>{s.updateSlippageInfoFetched(a),s.setQuote({...s.quote,bestRoute:a,quoteNull:e,quoteError:null,isFetchQuoting:!1}),o.quoteUpdateFromTo(a),o.computedIsSingleChain||s.setPathSelectionRouterList(t||[])},Yd=({isAutoError:a},{approveStore:t})=>{if(!a){t.isPendingNotCheck().catch(()=>{})}},Xd=({isAutoError:a},{quoteStore:t})=>{a&&(t.handleReverseQuoteErrorAndNull(),at(()=>{t.updateQuoteStatus(t.quoteScope?2:3)}))},zd=({snapModeQuote:a,tradingModeType:t,supportSnapMode:e},{intentSwapStore:o,tradeModeStore:s})=>{o.setCallDataInfo(a?{quote:a.quote,tradingModeType:t,unsignedTx:a.unsignedTx}:{}),s.tradingModeType===Vt.COMPARE_MODE&&e===Go.SUPPORT&&s.setBestPriceTag(t),s.tradingModeType===Vt.SNAP_MODE&&t===Vt.AUTO&&mc({title:h("swaptrade_trading_mode_toast_snap_quote_switch")}),s.setTradingModeType(t),s.setIsMetSnap(e)},Tl=a=>{let{fromToStore:t,quoteStore:e,approveStore:o,intentSwapStore:s,tradeModeStore:i}=Bt(),{isAutoError:n}=Sl(a);Kd({quoteStore:e,fromToStore:t});let{bestRoute:c,combineSelectionRouterList:d}=$d(a,{fromToStore:t,quoteStore:e});jd({bestRoute:c,combineSelectionRouterList:d,isAutoError:n},{fromToStore:t,quoteStore:e,approveStore:o}),zd(a,{intentSwapStore:s,tradeModeStore:i}),Yd({isAutoError:n},{approveStore:o}),Xd({isAutoError:n},{quoteStore:e})};u();l();var Eo=class{constructor(t){r(this,"allTimerAndQuoteState",{[tt.DEFAULT]:{isShowLoadingCpt:!1,quoteText:()=>""},[tt.QUOTING]:{isShowLoadingCpt:!0,quoteText:()=>h(Mo)},[tt.TIMER]:{isShowLoadingCpt:!0,quoteText:()=>h(Mo)},[tt.QUOTE_IS_HONEYPOT]:{isShowLoadingCpt:!1,quoteText:()=>h(Bo)},[tt.QUOTE_NULL]:{isShowLoadingCpt:!0,quoteText:()=>h(Bo)},[tt.QUOTE_NULL_AND_SECTION]:{isShowLoadingCpt:!0,quoteText:()=>h(Mo)},[tt.QUOTE_ERROR]:{isShowLoadingCpt:!1,quoteText:()=>h(Bo)}});Object.assign(this,t)}isValidRange(t){if(typeof t!="string")return!1;let{from:e}=this.fromToStore,o=t.split("-");if(o.length!==2)return!1;let{BigNumber:s}=g;return s(e.amount).lt(o[0])||s(e.amount).gt(o[1])}getCurrentTimerQuoteState(){let{quoteNull:t,isFetchQuoting:e,quoteError:o,bestRoute:s}=this.quote,i=this.fromToStore?.computedIfQuote,n=o!==null;return i?n?this.allTimerAndQuoteState[tt.QUOTE_ERROR]:this.rootStore.safeMoonStore.computedHoneypot?this.allTimerAndQuoteState[tt.QUOTE_IS_HONEYPOT]:t?s?.msg&&(e||this.isValidRange(s.msg))?this.allTimerAndQuoteState[tt.QUOTE_NULL_AND_SECTION]:this.allTimerAndQuoteState[tt.QUOTE_NULL]:e?e?this.allTimerAndQuoteState[tt.QUOTING]:this.allTimerAndQuoteState[tt.DEFAULT]:this.allTimerAndQuoteState[tt.TIMER]:this.allTimerAndQuoteState[tt.DEFAULT]}};var{FACET_TOKEN_ERROR_ONE:Jd,FACET_TOKEN_ERROR_TWO:Zd,FACET_TOKEN_ERROR_THREE:tm}=Ut,Ae=class{constructor(t){r(this,"dialogCloseFlag",!1);r(this,"slippageInfoFetched",!1);r(this,"setDialogCloseFlag",t=>{this.dialogCloseFlag=t});r(this,"dialogShowQuotationComparison",!1);r(this,"setDialogShowQuotationComparison",t=>{this.dialogShowQuotationComparison=t});r(this,"quoteNumber",0);r(this,"setQuoteNumber",t=>{this.quoteNumber=t});r(this,"isDialog",!1);r(this,"setIsDialog",t=>{this.isDialog=t});r(this,"initQuote",{bestRoute:null,quoteError:null,quoteNull:!1,isFetchQuoting:!1});r(this,"isFirstQuote",!0);r(this,"setIsFirstQuote",t=>{this.isFirstQuote=t});r(this,"isPickRouterFromWallet",!1);r(this,"setIsPickRouterFromWallet",t=>{this.isPickRouterFromWallet=t});r(this,"quoteScope",null);r(this,"setQuoteScope",t=>{this.quoteScope=t});r(this,"fetchQuoteStatus",0);r(this,"quote",{...this.initQuote});r(this,"setQuote",t=>{this.quote=t});r(this,"pathSelectionRouterList",[]);r(this,"setPathSelectionRouterList",t=>{this.pathSelectionRouterList=t});r(this,"pickRouter",{});r(this,"setPickRouter",(t,e)=>{this.pickRouter=t,e&&(this.setNoCurrentPathTipInfo({bridgeName:t?.bridge?.bridgeName}),this.updateBestRoute(t))});r(this,"showChainListModel",!1);r(this,"setShowChainListModel",t=>{this.showChainListModel=t});r(this,"noCurrentPathTipInfo",{visible:!1,bridgeName:""});r(this,"setNoCurrentPathTipInfo",t=>{this.noCurrentPathTipInfo={...this.noCurrentPathTipInfo,...t}});r(this,"currentBridgeId","");r(this,"setCurrentBridgeId",t=>{this.currentBridgeId=t});r(this,"updateBestRoute",t=>{this.setQuote({...this.quote,bestRoute:t}),this.rootStore.mevStore.setMevUserSwitchOpen(Oe.DEFAULT),this.rootStore.fromToStore?.quoteUpdateFromTo(t)});r(this,"pickBestRouterAccordingBridgeId",t=>{let{smartRouterStore:{showXRouteModal:e}}=this.rootStore;if(!t||t.length===0)return null;let o=t.find(s=>s?.bridge?.bridgeId===this.currentBridgeId);return this.currentBridgeId&&!o&&(this.setCurrentBridgeId(""),!this.showChainListModel&&e!==vn.ROUTER_SELECT&&this.setNoCurrentPathTipInfo({visible:!0})),o||t?.[0]});r(this,"quoteTimer",null);r(this,"clearQuote",()=>{this.cleanQuoteTimer(),this.setQuote(this.initQuote),this.setIsFirstQuote(!0),this.rootStore.fromToStore?.quoteUpdateFromTo(null),this.quotePending=!1});r(this,"cancelRef",null);r(this,"cleanQuoteTimer",()=>{clearTimeout(this.quoteTimer),this.quoteTimer=null,this.cancelRef&&this.cancelRef.abort()});r(this,"isClearQuote",()=>{let{currentTab:t}=this.commonStore,{computedTypedValue:e,from:o,to:s,computedIsSingleChain:i,computedIsExactIn:n}=this.fromToStore;return t===_.LIMIT_ORDER||!wt(e)||!s?.tokenContractAddress||!o?.tokenContractAddress||!n&&!i});r(this,"getQuoteData",t=>{let e=ce();return O(Cu(()=>k.get(this.outerStore.receiveQuoteUrl(),{params:e,signal:t}),as.NUM,as.TIMER))});r(this,"handleUpdateQuote",t=>{if(t){let{data:e}=t;Tl(e)}});r(this,"fetchQuote",async()=>{if(!fl())return this.quoteTimer=setTimeout(()=>{this.fetchQuote().catch(()=>{})},ls),Promise.resolve(!1);if(this.isClearQuote())return this.quoteScope=null,this.clearQuote(),Promise.resolve(!1);if(this.cleanQuoteTimer(),this.rootStore.outerStore.computedFeeConfigErrorTips)return this.handleQuoteError(),Promise.resolve(!1);this.setQuote({...this.quote,isFetchQuoting:!0}),this.cancelRef=yt();let[t,e]=await this.getQuoteData(this.cancelRef.signal);return this.quotePending=!1,!Ht(t)&&t&&this.handleQuoteError(t),this.handleUpdateQuote(e),this.setIsPickRouterFromWallet(!1),this.commonStore.setResetFromToByTabChange(!1),this.setIsFirstQuote(!1),!Ht(t)&&!this.dialogCloseFlag&&at(()=>{this.quoteTimer=setTimeout(()=>{this.fetchQuote().catch(()=>{})},ls)}),Promise.resolve(!0)});r(this,"quotePending",!1);r(this,"debounceQuote",Jo(this.fetchQuote,_n));r(this,"fetchQuoteDebounce",async()=>{let{computedIsCrossChain:t,computedIfQuote:e}=this.fromToStore;this.quotePending=!0,e&&t?await this.debounceQuote():e&&!t?this.debounceQuote():this.clearQuote()});r(this,"handleQuoteError",t=>{this.setQuote({...this.initQuote,quoteError:t}),this.handleReverseQuoteErrorAndNull()});r(this,"getGasTokenFeeLoading",!1);r(this,"getGasTokenFeeCancelRef",null);r(this,"cancelGasTokenGeeRequest",()=>{this.getGasTokenFeeCancelRef&&(this.getGasTokenFeeCancelRef.abort(),this.getGasTokenFeeCancelRef=null)});r(this,"cacheNativeGasFee","");r(this,"setCacheNativeGasFee",t=>{this.cacheNativeGasFee=t});r(this,"fetchGasTokenFee",async()=>{let{from:t}=this.rootStore.fromToStore,{computedReserveGas:e}=this.rootStore.commonStore,{decimals:o,balance:s}=t||{},i=ka(ce(),["dexIds"]);this.getGasTokenFeeCancelRef=yt();let n=this.rootStore.fromToStore?.computedIsExactIn?Nn:Dn;this.getGasTokenFeeLoading=!0;let c=this.getGasTokenFeeCancelRef.signal,d=e,[m,p]=await O(k.get(n,{params:{...i,amount:Ra(s,o)},signal:c}));if(this.getGasTokenFeeLoading=!1,!Ht(m)&&m)return-1;if(!m){let{data:S}=p||{},{commonDexInfo:T}=S||{};Number(T?.code)===0&&T?.estimateReserveGasTokenFee!==""&&(d=T.estimateReserveGasTokenFee)}return this.setCacheNativeGasFee(d),d});r(this,"transactionDetailExpanded",!1);r(this,"setTransactionDetailExpanded",t=>{this.transactionDetailExpanded=t});x(this,{},{autoBind:!0}),Object.assign(this,t),this.rootStore=t}initQuoteStatus(){this.fetchQuoteStatus=0}updateQuoteStatus(t){this.fetchQuoteStatus=t}get computedIsIntentType(){return this.rootStore.tradeModeStore.computedIsSnapType}get computedSlippage(){let{computedIsSingleChain:t,computedDefaultAutoSlippageInfo:e}=this.fromToStore,o=this.rootStore.slippageStore,s=Co({isSingleChain:t,autoSlippageInfo:e}),i=Jt.AUTO;return o&&(s=o.computedRealSlippageValue,i=o.getSlippageType()),!this.slippageInfoFetched&&i===Jt.AUTO&&(i=Jt.DEFAULT),{slippage:s,slippageType:i}}handleReverseQuoteErrorAndNull(){let{updateFromAmount:t,computedIsExactIn:e,updateTo:o}=this.fromToStore;e?o({amount:""}):t({amount:""})}getQuoteError(t){let{commonDexInfo:e,pathSelectionRouterList:o,singleChainSwapInfo:s}=t,{computedIsSingleChain:i}=this.fromToStore,n=Number(e?.code)===Ut.CROSS_CHAIN_INTERVAL,c=n?{crossMaxAmount:e?.crossMaxAmount,crossMiniAmount:e?.crossMiniAmount}:null;return this.setQuoteScope(c),{isAutoError:n||(i?!s:!o?.length)}}updateSlippageInfoFetched(t){let{autoSlippage:e,autoTotalSlippage:o}=t?.autoSlippageInfo||{};(e||o)&&(this.slippageInfoFetched=!0)}checkQuoteScopeLtMin(t,e){if(!t||!e)return!1;let{crossMiniAmount:o}=this.quoteScope||{};return!!g.BigNumber(e).lt(g.BigNumber(o))}get computedCurrentTimerQuoteState(){return new Eo(this).getCurrentTimerQuoteState()}get computedRouterForSmartRouterStore(){return this.computedMediaForChangeSmartRouterData&&!this.fromToStore?.computedIsSingleChain?this.pickRouter:this.quote?.bestRoute}get computedMediaForChangeSmartRouterData(){return hi()?.media==="sm"||this.isDialog}get computedQuoteAmount(){let{computedIsExactIn:t}=this.fromToStore;return t?this.quote?.bestRoute?.fromTokenAmount:this.quote?.bestRoute?.payAmount}get computedQuoteIntervalIsEmpty(){return this.computedQuoteInterval.type===lt.EMPTY}get computedQuoteInterval(){let{safeMoonStore:t,fromToStore:e,approveStore:o,swapBtnStore:s,swapDappStore:i}=this.rootStore;if(t.computedHoneypot||e.computedFormToTokenIsLeverageToken)return{type:lt.EMPTY};let n=oc.handleQuoteErrorState({quote:this.quote,honeypotToken:y(this,"rootStore.safeMoonStore.computedHoneypot",!1)})||this.accountStore.computedNonsupportChain,{from:c,computedNonsupportFacetToken:d}=this.fromToStore;if(n||d)return{type:lt.EMPTY};if(i.checkShouldJumpToDapp())return{type:lt.SHOULD_JUMP_DAPPS};if(this.computedNotSupportBtcAddress&&this.accountStore.isConnectedWallet)return{type:lt.NOT_SUPPORT_BTC_ADDRESS_TYPE,text:this.quote.bestRoute?.errorMsg};if((!this.quoteScope||!e.computedIfQuote)&&this.fetchQuoteStatus!==3&&!o.computedIsCancelApproveStatus)return{type:lt.EMPTY};if(this.computedCrossAccuracyLimit)return{type:lt.CROSS_CHAIN_ACCURACY,text:h("swaptrade_card_tooltips_adjust_pay_token_decimal",{fromToken:c.tokenSymbol,value:this.computedCrossAccuracyLimit}),equation:h("swaptrade_card_tooltips_adjust_pay_token_decimal",{fromToken:U(c.tokenSymbol),value:this.computedCrossAccuracyLimit})};if(this.computedFacetTokenTips)return{type:lt.FACET_TOKEN_SWAP_ERROR,text:this.computedFacetTokenTips};let{crossMiniAmount:p,crossMaxAmount:S}=this.quoteScope||{};if(g.BigNumber(c.amount).lt(g.BigNumber(p))){let T=j(p,{cutPriceText:!0,isFloor:!1});return{type:lt.CROSS_CHAIN_MIN,text:h("swaptrade_bridge_toast_min_amout_crosschain_swap",{value:T,symbol:c.tokenSymbol}),equation:h("swaptrade_bridge_toast_min_amout_crosschain_swap",{value:T,symbol:U(c.tokenSymbol)})}}if(g.BigNumber(c.amount).gt(g.BigNumber(S))){let T=j(S,{cutPriceText:!0});return{type:lt.CROSS_CHAIN_MAX,text:h("swaptrade_bridge_toast_max_amout_crosschain_swap",{value:T,symbol:c.tokenSymbol}),equation:h("swaptrade_bridge_toast_max_amout_crosschain_swap",{value:T,symbol:U(c.tokenSymbol)})}}return this.computedIsNoLiquidity?{type:lt.NOT_LIQUIDITY}:o.computedIsCancelApproveStatus&&!s.computedTooBalance?{type:lt.CANCEL_APPROVE_TIPS}:{type:lt.EMPTY}}get computedNotSupportFromBtcAddressType(){let t=this.quote?.bestRoute?.code;return Number(t)===Ut.NOT_SUPPORT_FROM_BTC_ADDRESS}get computedNotSupportToBtcAddressType(){let t=this.quote?.bestRoute?.code;return Number(t)===Ut.NOT_SUPPORT_TO_BTC_ADDRESS}get computedNotSupportBtcAddress(){return this.computedNotSupportFromBtcAddressType||this.computedNotSupportToBtcAddressType}get computedIsNoLiquidity(){let{from:t}=this.fromToStore,{crossMiniAmount:e,crossMaxAmount:o}=this.quoteScope||{};return this.fetchQuoteStatus===3&&this.quote.quoteNull||g.BigNumber(t.amount).lte(o)&&g.BigNumber(t.amount).gte(e)}get computedCrossAccuracyLimit(){let{crossAccuracyLimit:t,code:e}=this.quote.bestRoute||{};return Number(e)===Ut.CROSS_CHAIN_ACCURACY?t:""}get computedFacetTokenTips(){let{errorMsg:t,code:e}=this.quote.bestRoute||{};return[Jd,Zd,tm].includes(Number(e))&&t?t:""}get computedYouSaveVisible(){let{computedNowCurrencySymbol:t,currencyConversion:e,computedIsWalletEnv:o}=this.commonStore,{computedIsExactIn:s,computedIsCrossChain:i}=this.rootStore.fromToStore,{quoteError:n,quoteNull:c,bestRoute:d}=this.quote;if(!s||n||c||!d?.youSaveDTO||i)return{visible:!1};let{youSaveDTO:m,fromToken:p,toToken:S}=d,{topTenDexInfoList:T,youSaveMoney:I}=m,A=Number(I)>=.1&&T?.length>0&&!p.isHoneypot&&!S.isHoneypot,R=e(I).toString(),w=A?et(R,t,{isFloor:!1}):"",q=A?T?.[1]?.dexName:"";return o&&(!i&&this.computedTopTenDexInfoList.length>0?A=!0:A=!1),{visible:A,youSaveStr:w,dexName:q}}get computedHasYouSave(){let{computedIsCrossChain:t}=this.rootStore.fromToStore;return!!this.quote?.bestRoute?.youSaveDTO||t}get computedTopTenDexInfoList(){if(!this.rootStore.fromToStore?.computedIsExactIn||!this.computedHasYouSave)return[];let{computedNowCurrencySymbol:t,currencyConversion:e}=this.commonStore;return this.quote?.bestRoute?.youSaveDTO?.topTenDexInfoList?.map(({logoUrl:o,dexName:s,comparePercent:i,price:n,dexAmountOut:c,amountOutOfMoney:d,gasOfMoney:m,isOkxDex:p})=>{let S=e(d)?.toString(),T=e(m)?.toString();return{logoUrl:o,dexName:s,comparePercent:i,price:n,isOkxDex:p,formatPrice:j(n),dexAmountOut:g.BigNumber(c).toString(),formatDexAmountOut:j(c),amountOutOfMoney:S,formatAmountOutOfMoney:et(S,t,{needBillionMillionUnit:!1}),gasOfMoney:et(T,t),symbol:t||""}})??[]}get computedReferredFee(){let{bestRoute:t}=this.quote,{referredNetWorkFee:e,referredAmount:o}=t||{};if(!o||!e)return"";let{computedNowCurrencySymbol:s,currencyConversion:i}=this.commonStore,{from:n}=this.fromToStore;return h("swaptrade_modal_desc_crosschain_valuediff_variavle",{price:`${j(o)} ${n.tokenSymbol}`,fee:`${et(i(e).toString(),s)}`})}get computedMonitorSwapSaveOrderParams(){let{accountStore:t,liquidityChooseStore:e}=this.rootStore,{bestRoute:o}=this.quote;if(!o)return{};let{slippage:s,slippageType:i}=this.computedSlippage,{fromToken:n,fromTokenAmount:c,fromTokenPrice:d,toTokenPrice:m,receiveAmount:p,toToken:S,swapType:T,routerLabel:I}=o,A=Number(T)===0,R=A?{liquidity_source:e.computedMonitorLiquidSelectType}:{},w=A?{}:{bridge_selection:I?.includes(rc)?"overall best":"custom"};return{wallet_address:t.address,from_token_address:n?.tokenContractAddress,from_token_amount:c,from_amount_usdt:d,to_token_address:S?.tokenContractAddress,to_token_amount:p,to_amount_usdt:m,from_chain:n?.chainName,to_chain:S?.chainName,swap_type:A?"swap":"cross_chain_swap",slippage:{type:i===Jt.AUTO?"auto":"custom",amount:s},trading_mode:this.computedIsIntentType?"intent_mode":"auto_mode",...R,...w}}get computedIsUsingCentralizedBridge(){let t=["8"],e=String(this.quote.bestRoute?.bridge?.bridgeId);return t.includes(e)}get computedIsNoQuote(){return this.quote.quoteError||this.quote.quoteNull||!this.quote.bestRoute||this.rootStore.safeMoonStore?.computedHoneypot||this.fromToStore.computedFormToTokenIsLeverageToken||this.rootStore.outerStore.computedFeeConfigErrorTips||!this.fromToStore.computedTypedValueIsValid}get computedIsDexQuote(){let{bestRoute:t}=this.quote,{tradingModeType:e}=t||{};return String(e)===Ho}get computedSupportDappTradeByQuote(){return Number(this.quote?.bestRoute?.isSupportDappTrade)===1}};u();l();var sm="1",im="2",gl={minValue:.01,maxValue:.5},Cl={minValue:.03,maxValue:.5},_e=class{constructor(t){r(this,"slippageSetting",{autoIsSelected:!1,inputSlippage:""});r(this,"configSingle",gl);r(this,"configCross",Cl);r(this,"inputValue","");r(this,"inputCache","");r(this,"inputSlippageFocus",!1);r(this,"slippageNotice","");r(this,"hasSlippageError",!1);r(this,"hasSafeMoonWarning",!1);r(this,"isFrozen",!1);r(this,"frozenTooltip","");r(this,"clearNoticeAndError",()=>{this.slippageNotice="",this.hasSlippageError=!1});r(this,"setFrozenInfo",({computedSafeMoonNotSupport:t,isCrossBridgeOnly:e})=>{this.isFrozen=t||e,t?this.frozenTooltip=h("swaptrade_dialog_modal_current_notsupport"):e?this.frozenTooltip=h("swaptrade_dialog_modal_crosschain_notsupport"):this.frozenTooltip=""});r(this,"refreshInfo",()=>{let{inputSlippage:t}=this.slippageSetting;if(this.inputValue=t||"",this.computedSafeMoonTips||t!==""&&t!==void 0){let{computedSafeMoonTips:e,minSlippageShow:o,maxSlippageShow:s,computedAutoSlippage:i}=this,n=this.rootStore.fromToStore.computedIsSingleChain,{notice:c,isError:d,isWarning:m}=Pr({inputSlippageParams:this.computedSlippageValue,computedSafeMoonTips:e,minSlippageShow:o,maxSlippageShow:s,autoSlippageValue:i,isSingleChain:n});this.slippageNotice=c,this.hasSlippageError=d,this.hasSafeMoonWarning=m}});r(this,"onFocus",()=>{this.inputSlippageFocus=!0,this.hasSafeMoonWarning=!1,this.inputCache&&(this.onInput(null,this.inputCache),this.inputCache="")});r(this,"onInput",(t,e="")=>{let o=t||e;this.templeAutoSelected=!1;let{computedSafeMoonTips:s,minSlippageShow:i,maxSlippageShow:n,computedAutoSlippage:c}=this,d=this.rootStore.fromToStore.computedIsSingleChain,{notice:m,isError:p,isWarning:S}=Pr({inputSlippageParams:o,computedSafeMoonTips:s,minSlippageShow:i,maxSlippageShow:n,autoSlippageValue:c,isSingleChain:d});if(!se(J(o))){let I=/^0{2,}/gm;o=o.replace(I,"0"),this.inputValue=o}let T=o||this.computedSafeMoonTips;this.slippageNotice=T?m:"",this.hasSlippageError=p,this.hasSafeMoonWarning=S});r(this,"onBlur",()=>{this.inputSlippageFocus=!1});r(this,"onSelectCustom",()=>{let t=this.inputValue,{computedSafeMoonTips:e,minSlippageShow:o,maxSlippageShow:s,computedAutoSlippage:i}=this,n=this.rootStore.fromToStore.computedIsSingleChain,{slippage:c,inputValue:d,notice:m,isError:p}=Pr({inputSlippageParams:t,computedSafeMoonTips:e,minSlippageShow:o,maxSlippageShow:s,autoSlippageValue:i,isSingleChain:n}),S=this.getSafeMoonStore();if(S.checkIsChanged&&S.checkIsChanged(t),e?this.inputValue=Gt(c):this.inputValue&&(this.inputValue=Gt(c),this.slippageNotice=m,this.hasSlippageError=p,this.hasSafeMoonWarning=!!e),(Number(t)===0||se(t))&&(this.slippageNotice=""),p){this.onSelectAuto(),this.inputSlippageFocus=!1;return}ys({custom_or_auto:d?"custom":"auto"}),this.setSlippageSetting({autoIsSelected:!d,inputSlippage:d}),this.rootStore.quoteStore.fetchQuoteDebounce()});r(this,"onReset",()=>{let{inputSlippage:t}=this.slippageSetting;this.inputValue=t,this.clearNoticeAndError(),this.inputSlippageFocus=!1});this.rootStore=t,this.commonStore=t.commonStore,this.fromToStore=t.fromToStore,this.smartRouterStore=t.smartRouterStore,x(this,{},{autoBind:!0})}getSafeMoonStore(){return this.rootStore.safeMoonStore}getOrderSlippageInfo(){let{autoIsSelected:t}=this.slippageSetting,e=js(this.rootStore);return t||this.isFrozen?{autoSlippageInfo:e}:{customSlippage:String(this.computedRealSlippageValue),autoSlippageInfo:e}}get minSlippage(){let t=this.rootStore.fromToStore.computedIsSingleChain,{computedSafeMoonToken:e}=this.getSafeMoonStore();if(e){let o=g.BigNumber.max(this.configCross.minValue,this.configSingle.minValue);return o.isNaN()?.011:o.toString()}return t?this.configSingle.minValue:this.configCross.minValue}get maxSlippage(){return this.rootStore.fromToStore.computedIsSingleChain?this.configSingle.maxValue:this.configCross.maxValue}get minSlippageShow(){return g.mul(this.minSlippage,100)}get maxSlippageShow(){return g.mul(this.maxSlippage,100)}get computedAutoSlippage(){let{computedHoneypot:t}=this.getSafeMoonStore();if(t){let e=y(this,"rootStore.quoteStore.quote.bestRoute.realSlippage",0);return g.mul(e,100)}return Nr(this.rootStore)}get computedSafeMoonNotSupport(){let{computedHoneypot:t,computedSlippageTips:e}=this.getSafeMoonStore();return!!(t||e?.overLimit||e?.equalLimit)}get computedSafeMoonSlippage(){return this.getSafeMoonStore().computedSlippage}get computedSafeMoonTips(){return this.getSafeMoonStore().computedSlippageTips}get computedSafeMoonTip(){return this.getSafeMoonStore().computedSlippageTips?.tip}get computedSafeMoonPairSlippage(){return this.getSafeMoonStore().computedPairSlippage}get computedSlippageValue(){return this.getSlippageValue()}get computedRealSlippageValue(){let t=this.getSlippageValue();return Number(g.div(t,100))||0}isValidVolatilityTip(){if(Number(this.computedSlippageValue)>this.computedAutoSlippage)return!1;let t=this.getSafeMoonStore(),e=this.smartRouterStore;return t.computedSafeMoonToken===null&&!e?.isCrossBridgeOnly}get computedVolatilityTips(){if(!this.isValidVolatilityTip())return null;let{computedAutoSlippage:t}=this,e=this.rootStore?.quoteStore?.quote?.bestRoute||{},{priceFluctuationMonitorTime:o,priceFluctuationThreshold:s,fromPriceFluctuation:i,toPriceFluctuation:n,rateFluctuationThreshold:c,slippageFluctuationhold:d,rateFluctuation:m}=e,{from:p,to:S}=this.fromToStore,T=S?.tokenSymbol||"",I=p?.tokenSymbol||"",A=g.mul(d,100),R=g.mul(s,100),w=g.mul(c,100),q=Number(m),K=Number(c);if(t>A){if(q<K)return null;let nt=this.slippageSetting.autoIsSelected;return{tip:h("swaptrade_settings_alert_both_exchange_tips",{payToken:I,receiveToken:T,value:w,min:o}),tipEquation:h("swaptrade_settings_alert_both_exchange_tips",{payToken:U(I),receiveToken:U(T),value:w,min:o}),swapInterceptorType:nt?$.VOLATILITY_SLIPPAGE:null}}else if(t===A){let nt=Math.abs(i),mt=Math.abs(n),V=Number(s);if(nt>V&&mt>V)return{tip:h("swaptrade_placeorder_alert_both_volatility",{payToken:I,receiveToken:T,value:R,min:o}),tipEquation:h("swaptrade_placeorder_alert_both_volatility",{payToken:U(I),receiveToken:U(T),value:R,min:o})};if(nt>V)return{tip:h("swaptrade_placeorder_alert_pay_receive_volatility",{token:I,value:R,min:o}),tipEquation:h("swaptrade_placeorder_alert_pay_receive_volatility",{token:U(I),value:R,min:o})};if(mt>V)return{tip:h("swaptrade_placeorder_alert_pay_receive_volatility",{token:T,value:R,min:o}),tipEquation:h("swaptrade_placeorder_alert_pay_receive_volatility",{token:U(T),value:R,min:o})};if(q>=K)return{tip:h("swaptrade_settings_alert_both_exchange",{payToken:I,receiveToken:T,value:w,min:o}),tipEquation:h("swaptrade_settings_alert_both_exchange",{payToken:U(I),receiveToken:U(T),value:w,min:o})}}return null}getDefaultSetting(){let t={inputSlippage:"",autoIsSelected:!0},e=this.getSafeMoonStore();if(e.computedSafeMoonToken){let o=e.computedSlippage,s=Gt(o);e.isChanged&&s&&(t.inputSlippage=s,t.autoIsSelected=!1)}return t}getSlippageType(){return this.slippageSetting.autoIsSelected||this.isFrozen?Jt.AUTO:Jt.CUSTOM}getSlippageValue(t){let{autoIsSelected:e,inputSlippage:o}=t||this.slippageSetting;return e||this.isFrozen?this.computedAutoSlippage:o||this.computedAutoSlippage}setSlippageSetting(t){let e={...t},o=this.getSafeMoonStore(),{computedSafeMoonToken:s}=o;if(!s){this.slippageSetting=e;return}let i=this.getSlippageValue(e);if(i===this.getSlippageValue(this.slippageSetting)||o.isAccessSlippage(i)||!o.getSafemoonIsChangedLocal()){e.inputSlippage="",e.autoIsSelected=!0;let n=Gt(i);o.isChanged&&n&&(e.inputSlippage=n,e.autoIsSelected=!1),o.setSafeMoonPairSlippage(i),this.slippageSetting=e}}async initSlippageConfigs(){try{let{data:t}=await k.get(ra),e=t?.find(({configId:s})=>sm===s),o=t?.find(({configId:s})=>im===s);e&&(this.configSingle=e),o&&(this.configCross=o)}catch{this.configSingle=gl,this.configCross=Cl}}initSlippageSetting(){let t=this.getDefaultSetting(),e;t?e={...t}:e={autoIsSelected:!0,inputSlippage:""},this.setSlippageSetting(e)}initReactions(){Ct(()=>{let{from:t,to:e}=this.fromToStore;return{chainId:t.chainId,toChainId:e.chainId,fromTokenAddress:t.tokenContractAddress,toTokenAddress:e.tokenContractAddress}},({fromTokenAddress:t,toTokenAddress:e})=>t&&e?(this.rootStore.quoteStore.slippageInfoFetched=!1,this.clearNoticeAndError(),this.initSlippageSetting()):!1,{equals:Ft.shallow}),Ct(()=>{let t=this.fromToStore.from.chainId,{computedSafeMoonSlippage:e}=this;return{fromId:t,computedSafeMoonSlippage:e}},this.clearNoticeAndError,{equals:Ft.shallow}),Ct(()=>{let{computedSafeMoonPairSlippage:t}=this;return{computedSafeMoonPairSlippage:t}},()=>{this.initSlippageSetting()},{equals:Ft.shallow}),Ct(()=>{let{isCrossBridgeOnly:t}=this.smartRouterStore,{computedSafeMoonNotSupport:e}=this;return{computedSafeMoonNotSupport:e,isCrossBridgeOnly:t}},this.setFrozenInfo,{equals:Ft.shallow}),Ct(()=>{let{slippageSetting:t,isFrozen:e,computedSafeMoonTip:o}=this;return{slippageSetting:t,isFrozen:e,computedSafeMoonTip:o}},this.refreshInfo,{equals:Ft.shallow})}onSelectAuto(t){ys({custom_or_auto:"auto"}),!this.hasSlippageError&&!this.hasSafeMoonWarning&&this.inputValue?this.inputCache=this.inputValue:this.inputCache="";let e={autoIsSelected:!0,inputSlippage:""};if(this.inputValue="",this.slippageNotice="",this.hasSlippageError=!1,this.hasSafeMoonWarning=!1,!t){let o=this.getSafeMoonStore();o.computedSafeMoonToken&&o.setSafeMoonIsChanged(!1),this.setSlippageSetting(e),this.rootStore.quoteStore.fetchQuoteDebounce()}}get computedMinimumNum(){let{quote:t}=this.rootStore.quoteStore,e=t?.bestRoute?.receiveAmount,o=t?.bestRoute?.minimumReceived,s=this.fromToStore.to?.tokenSymbol,{computedIsSnapType:i}=this.rootStore.tradeModeStore,n=this.inputValue?g.div(this.inputValue,100):this.computedRealSlippageValue;if(this.hasSlippageError||!wt(this.rootStore.quoteStore.quote?.bestRoute?.receiveAmount)||!wt(e))return{text:"--",equation:"--"};let c=i?o:g.mul(e,1-(wt(n)?n:0));return{text:`${j(c)} ${s}`,equation:`${j(c)} ${U(s)}`}}};u();l();D();var oi=class{constructor(t){r(this,"checkCrossChainParams",()=>{let{quoteStore:t,receiveAddressStore:e}=this.rootStore,{quote:o}=t,s=this.checkCommonParams(),{receiveAddrObj:i}=e,n=y(o.bestRoute,"quoteNetWorkFeeOfMoney"),c=o?.bestRoute?.bridge?.bridgeId,d=i?.specifiedAddress;return{...s,fromSwapFeeUsd:n,bridgeId:c,receiveWalletAddress:d}});r(this,"checkCommonParams",()=>{let{accountStore:t,fromToStore:e,quoteStore:o}=this.rootStore,{from:s,to:i}=e;return{fromChainId:s.chainId,fromTokenAddress:s.tokenContractAddress,amount:o?.computedQuoteAmount,toChainId:i.chainId,toTokenAddress:i.tokenContractAddress,userWalletAddress:t.address,accountId:t.computedAccountId}});r(this,"repeatOrder",null);r(this,"checkRepeatOrder",async()=>{this.repeatOrder=null;let{fromChainId:t,...e}=this.checkCommonParams(),{quoteStore:{quote:o}}=this.rootStore,s=y(o.bestRoute,"fromSwapFeeUsd"),i={...e,chainId:t,fromSwapFeeUsd:s},[n,c]=await O(k.get(Vn,{params:i}));!n&&[oe.COMMON_REPEAT,oe.BTC_REPEAT,oe.FACET_REPEAT].includes(c?.data.repeatFlag)&&at(()=>{let{orderId:d,enoughFlag:m}=c?.data??{};this.repeatOrder={enoughFlag:m,repeatFlag:c?.data.repeatFlag,id:d}})});r(this,"checkSwapMoreInfo",null);r(this,"checkCrossChainSwap",async()=>{this.checkSwapMoreInfo=null;let t=this.checkCrossChainParams(),[e,o]=await O(k.post(qn,{...t}));e||at(()=>{this.checkSwapMoreInfo=o?.data})});x(this),this.rootStore=t}},Vr=oi;u();l();D();var ye=class{constructor(t){r(this,"swapOnDappBtnLoading",!1);r(this,"setSwapOnDappBtnLoading",t=>{this.swapOnDappBtnLoading=t});r(this,"refreshing",!1);r(this,"setRefreshing",t=>{this.refreshing=t});r(this,"dappListContainerVisible",!1);r(this,"setDappListContainerVisible",t=>{this.dappListContainerVisible=t});r(this,"fetchDappListError",!1);r(this,"setFetchDappListError",t=>{this.fetchDappListError=t});r(this,"availableNoticeVisible",!1);r(this,"setAvailableNoticeVisible",t=>{this.availableNoticeVisible=t});r(this,"dappList",[]);r(this,"setDappList",t=>{this.dappList=t});r(this,"getFetchParam",()=>{let{from:t,to:e,computedIsSingleChain:o}=this.fromToStore||{},s={},i="";return o?(i=pa,s={chainId:t?.chainId,tokenAddress:e?.tokenContractAddress}):(i=ha,s={fromChainId:t?.chainId,fromTokenAddress:t?.tokenContractAddress,toChainId:e?.chainId,toTokenAddress:e?.tokenContractAddress}),{url:i,params:s}});r(this,"fetchDappList",async t=>{t?(this.setFetchDappListError(!1),this.setRefreshing(!0)):this.setSwapOnDappBtnLoading(!0);let{url:e,params:o}=this.getFetchParam(),[s,i]=await O(k.get(e,{params:o}));if(this.setRefreshing(!1),this.setSwapOnDappBtnLoading(!1),s){if(Number(s.code)===40008){this.setAvailableNoticeVisible(!0);return}this.setFetchDappListError(!0),this.setDappListContainerVisible(!0);return}this.setDappList(i.data),this.setDappListContainerVisible(!0)});r(this,"getSupportDetail",(t={},e)=>{let o=this.chainIsSupportMarket(t),s=this.chainIsSupportDappTrade(t),i=!!this.quoteStore?.computedSupportDappTradeByQuote,n=!o&&s,c=o&&s,d=o&&!s;return{chainSupportMarket:o,chainSupportDappTrade:s,quoteSupportDappTrade:i,balance:c||d,kline:c||d,klineJumpMarket:c||d,costValue:e&&c||d,valueDifference:d,liquidity:d,disableInput:n||c,showMax:d,showAddFund:d}});r(this,"mergeCurrencyInputProps",(t,e)=>({balanceStatus:e.balance?t.balanceStatus:Z.BALANCE_NOT_SHOW,costValue:e.costValue?t.costValue:"",valueDifference:e.valueDifference?t.valueDifference:{},disableInput:e.disableInput,showMax:e.showMax?t.showMax:!1,showMaxIcon:e.showMax?t.showMaxIcon:!1,showAddFund:e.showAddFund?t.showAddFund:!1}));r(this,"getCurrentFromToChainConfig",()=>{let t=this.fromToStore.from.chainId,e=this.fromToStore.to.chainId,o=this.commonStore.getChainByID(t),s=this.commonStore.getChainByID(e);return[o,s]});r(this,"chainIsSupportMarket",t=>Number(t?.isSupportMarket)===1);r(this,"chainIsSupportDappTrade",t=>Number(t?.isSupportDappTrade)===1);r(this,"bridgeSupportDappTrade",t=>Number(t?.supportLinkDapp)===1);r(this,"getSupportDappTradeByToken",()=>{let t=this.quoteStore?.computedSupportDappTradeByQuote,e=this.liquidityChooseStore?.computedIsSelectedAllDex;return this.fromToStore.computedIsSingleChain&&t&&e});r(this,"checkShouldJumpToDapp",()=>this.fromToStore.computedFormToTokenIsLeverageToken?!1:this.computedSupportDappTradeByChain?!0:this.getSupportDappTradeByToken());this.rootStore=t,this.commonStore=t.commonStore,this.fromToStore=t.fromToStore,this.quoteStore=t.quoteStore,this.liquidityChooseStore=t.liquidityChooseStore,x(this,{},{autoBind:!0})}get computedFromToSupportMarketAndDappTrade(){let[t,e]=this.getCurrentFromToChainConfig();return{from:{...this.getSupportDetail(t,!0)},to:{...this.getSupportDetail(e)}}}get computedFromToSupportMarket(){let[t,e]=this.getCurrentFromToChainConfig();return this.chainIsSupportMarket(t)&&this.chainIsSupportMarket(e)}get computedSupportDappTradeByChain(){let t=this.fromToStore.from.chainId,e=this.fromToStore.to.chainId,o=this.commonStore.getChainByID(t);if(this.fromToStore.computedIsSingleChain)return this.chainIsSupportDappTrade(o);let s=o?.bridgeSupportChainInfoList,i=Array.isArray(s)&&s.find(n=>Number(n.chainId)===Number(e));return this.bridgeSupportDappTrade(i)}};var We=class extends ne{constructor(){L.init({project:$o});super();r(this,"reset",()=>{this.receiveAddressStore=new vr(this),this.outerStore=new Wr(this),this.fromToStore=new fe(this),this.approveStore=new ae(this),this.quoteStore=new Ae(this),this.tokenModalStore=new xr(this),this.safeMoonStore=new Ie(this),this.walletContractStore=new Lr(this),this.sendTransactionStore=new Rr(this),this.intentSwapStore=new br(this),this.swapCheckStore=new Vr(this),this.swapStore=new Te(this),this.swapBtnStore=new Se(this),this.mevStore=new Ur(this),this.recentTransactionStore=new ur(this),this.facetStore=new Fr(this),this.liquidityChooseStore=new Ce(this),this.swapDappStore=new ye(this),this.smartRouterStore=new sr(this),this.slippageStore=new _e(this),this.oneMoreOrderStore=new Mr(this),this.gasDropStore=new Br});this.reset()}},ko=We;r(ko,"instance",null),r(ko,"getInstance",()=>(We.instance||(We.instance=new We),We.instance));var Il=ko;u();l();D();u();l();u();l();var Al=Tt(["searchValue","fromTokenList","toTokenList","searchTokenList","error","tokenModalVisible","tokenModalFromState","loading","importTokenInfo","toSelectedChainId","fromSelectedChainId","hideCollectCancelConfirm","hideTokenGuide","tokenPageChainList","searchChainKeywords","dialogIndex"],["computedTokenList","computedSearchTokenList","computedFromChain","computedToChain","computedCurrentToChainId","computedCurrentChainId","computedIsCollectChain","computedTokenGuideVisible","computedIsNotSupportToChain","computedAllChainList","computedIsSearchChainStatus","computedSearchedChainList"]);var wo=class extends ge{constructor(t){super(t),ct(this,{...Al})}};var Ve=class extends ne{constructor(){L.init({project:$o});super();r(this,"reset",()=>{this.receiveAddressStore=new vr(this),this.outerStore=new Wr(this),this.fromToStore=new fe(this),this.approveStore=new ae(this),this.quoteStore=new Ae(this),this.tokenModalStore=new wo(this),this.safeMoonStore=new Ie(this),this.walletContractStore=new Lr(this),this.sendTransactionStore=new Rr(this),this.intentSwapStore=new br(this),this.swapCheckStore=new Vr(this),this.swapStore=new Te(this),this.swapBtnStore=new Se(this),this.mevStore=new Ur(this),this.recentTransactionStore=new ur(this),this.facetStore=new Fr(this),this.liquidityChooseStore=new Ce(this),this.swapDappStore=new ye(this),this.smartRouterStore=new sr(this),this.slippageStore=new _e(this),this.oneMoreOrderStore=new Mr(this)});this.reset()}},Lo=Ve;r(Lo,"instance",null),r(Lo,"getInstance",()=>(Ve.instance||(Ve.instance=new Ve),Ve.instance));var _l=Lo;var nm=({localeData:a,...t})=>{let e=(0,yl.useLocation)(),o;return e.pathname.includes(it)?o=_.BRIDGE:e.pathname.includes(Sa)?o=_.LIMIT_ORDER:e.pathname===st&&(o=_.SWAP),qr.default.createElement(Rs,{localeData:a,isDev:!0,noRemoteData:!0},qr.default.createElement(cu,{swapRootStore:_l,bridgeRootStore:Il,initTab:o},qr.default.createElement(Wu,{currentTab:o,...t})))};var El=kt(nm);jl();Ei();te();td();zl();Xl();u();l();var ri=E(W());D();te();var kl=({visible:a,onClose:t,onChange:e,walletId:o})=>ri.default.createElement(vs,{visible:a,onClose:t,onChange:e,coinId:Ai,walletId:o},ri.default.createElement(vs.Header,{title:Rt("extension_defi_top_header_title_select_address_type"),subTitle:Rt("extension_defi_popup_desc_new_address_default")}));u();l();var wl=E(W()),Ll=E(Yc());te();jr();var bl=E($r());var am=({walletId:a,txParams:t,onConfirm:e,onCancel:o})=>{let s=fc(a),i=Ac(Et,s?.walletId),n=Ec({coinAmount:0,localType:Et,coinId:_i,fromAddr:i,walletId:s?.walletId,txSource:Do.DAPP}),c={localType:Et,params:{transaction:t},walletId:s?.walletId},d=Yi(async({networkFee:m})=>{let{raw_data:p,raw_data_hex:S,txID:T,visible:I}=t||{};try{let A=await pt().signCommonMessage(i,{type:"protobuf",message:JSON.stringify({txID:T,visible:I,raw_data:p,raw_data_hex:S})},Et),R=Ll.default.address.fromHex((0,bl.get)(p,"contract[0].parameter.value.contract_address",i)),w=await Ic(Et,A);await n(A,{toAdr:R,txHash:w,serviceCharge:m}),e?.({txHash:w})}catch(A){e({error:A})}});return wl.default.createElement(zc,{unapproved:c,onCancel:o,onConfirm:d})},vl=am;u();l();var bt=E(W()),ql=E(Di());var Gl=E(od());D();u();l();var Rl=E(W());var si=E(Yl());te();var cm=async(a={})=>{let{contractAddress:t,contractName:e,functionName:o,functionArgs:s}=a,{getRawTransaction:i}=await Zr(),n={data:{type:ts.CONTRACT_CALL,data:{contract:t,contractName:e,functionName:o,functionArgs:s}}};return await i(si.Currency.Stx,n)},um=async(a={})=>{let{recipient:t,amount:e,memo:o}=a,{getRawTransaction:s}=await Zr(),i={data:{type:ts.TRANSFER,data:{to:t,amount:e,memo:o}}};return await s(si.Currency.Stx,i)},lm=async(a={})=>a.txType===es.CONTRACT_CALL?cm(a):a.txType===es.STX_TRANSFER?um(a):"",Ol=async({transaction:a={},fromAddress:t,value:e})=>{let o=await lm(a);return(await Zc({coinId:yi,fromAddress:t,value:e,inputData:o}))?.gasLimit||"0"};u();l();var dm=E(W());var Nl=E(sd());te();jr();async function Pl(a,t){let e=async()=>await lr({coinId:Xr,address:a},{fromAddr:a,toAddr:""}),o=async d=>{let m=(0,Nl.default)(d,"info.nonce",0),p={type:Ui.MULTI_CONTRACT_CALL,nonce:m,maxFee:0,chainId:Dc.StarknetChainId.SN_MAIN,multiContractCallData:{from:a,calls:t}};return(await pt().signTransaction(p,a,Oo))?.signature},s=async d=>{let{data:m}=await dr({coinId:Xr,address:a,inputData:d});return m?.gasLimit},i=await e(),n=await o(i);return await s(n)}Zl();Jl();te();Oi();jr();u();l();var Dl=E(nd()),xl=E(rd()),bo=E($r()),Fl=E(Yc());Ei();te();Oi();function Ml(a,t){return Fl.default.address.fromHex((0,bo.get)(a,"raw_data.contract[0].parameter.value.contract_address",t))}function Bl(a){return(0,bo.get)(a,"raw_data.contract[0].parameter.value.data","")}function Ul(a){let t=(0,bo.get)(a,"raw_data.contract[0].parameter.value.call_value"),e=(0,bo.get)(a,"raw_data.contract[0].parameter.value.amount","");return t||e}async function mm(a){let{data:t={}}=await ws({coinId:No,address:a},{fromAddr:a}),{info:e={}}=t;return e}async function pm(a,t){let{transaction:e,bizType:o,bizId:s=[],notReplaceBlockhash:i=!1}=a;if(!i){let{recentBlockhash:n,lastValidBlockHeight:c}=await mm(t);e.message.recentBlockhash=n,e.lastValidBlockHeight=c,s.forEach(d=>{let m=(0,Dl.mnemonicToSeed)(o,d),p=sn.fromSeed(m.slice(0,32));e.sign([p])})}return e}async function Wl(a,t){let e=await pm(a,t);return xl.default.encode(e.serialize())}function qe(a){let t=Qe({netWorkId:String(a)}),e=t?.baseChain||"",o=t?.localType||"",s=t?.coinId||3,i=t?.realChainIdHex;return{baseCoinId:s,networkType:o,chainId:i,baseChain:e}}async function ii({networkId:a,address:t,data:e,tokenAddress:o}){let s={},{baseCoinId:i}=qe(a),n={coinId:i,address:t},c={fromAddr:t,value:"0"},d={address:t,inputData:e,coinId:i,value:"0",tokenAddress:o},{data:m}=await dr(d),{gasLimit:p}=m,{data:{info:S}}=await ws(n,c),T=S?.needExtFee||!1,I=S?.gasPrice||{},{normal:A,proposePriorityFee:R,supportEip1559:w}=I;if(!T)return s={maxFeePerGas:A,maxPriorityFeePerGas:R,gasPrice:A,gasLimit:p,supportEip1559:w,networkFee:Ke(A,p)},s;let q={from:t,to:o,data:e,value:Fo(0),gasPrice:Fo(A),gasLimit:Fo(p)},K=Pi(q),nt=kc(K),mt=await pc({coinId:i},{inputData:nt}),V=Po(Ke(A,p),mt);return s.networkFee=V,s.extFee=mt,s}function Zt(a,t){return Ri(bi(a,10**t))}var hm=({code:a,data:t,error_message:e,error:o})=>{if(a!==0||!t||t.queryGasLimitErrorUseDefault||o)return{fee:0,error:e};let{gasLimit:s="0"}=t;return{...t,fee:s,error:!1}};async function ni({walletId:a,coinId:t,fromAddr:e,tx:o}){let s=o[0],i=s?.messages||[],n=s?.network||1,c=i?.valid_until||Math.floor(Date.now()/1e3)+600,{address:d}=i[0]||{},m=await lr({coinId:t,address:e,toAddr:d,fromAddr:e}),p=m?.chainId,S=m?.info?.nonce,T=await su({nonce:S,localType:we,fromAddr:e,walletId:a,messages:i,network:n,validUntil:c}),I=JSON.stringify(T.stringInputParams),A=await iu({fromAddr:e,chainId:p,coinId:t,inputData:I}),R=hm(A),w={coinId:t,coinAmount:0,inputData:I,fromAdr:e,toAdr:d,serviceCharge:R?.fee,extJson:JSON.stringify({nonce:S}),txSource:Do.DEX,accountId:a,walletType:Vi.IMPORT,transactionParams:T?.transactionParams};return{feeInfo:R,extParams:w}}var Vl=-42412,fm=-42418,Sm=(0,Gl.default)(Lc,500);function Hl(a,t){let{baseCoinId:e}=qe(a),o=Sc(t?void 0:e,void 0,t?{chainId:+a,address:t}:void 0),s=(0,bt.useRef)({coinAmount:0,coinAmountInt:0,currencyAmount:0,currencyAmountUSD:0});return Tc(o?.coinId)||s.current}async function Tm({coinId:a=3},{gasInfo:t={},calldata:e}){let{networkFee:o,isNetworkFeeLoading:s,isGasLimitLoading:i}=t,n=s||i,{minGasFee:c}=wc(t),d=vi(c),m=bs(t,"swap"),p=await Sm(a,e),S=m||p;return S===!0&&(S=Rt("swaptrade_extension_cinteraction_might_error")),{fee:d,feeInt:c,maxFeeInt:o,loading:n,error:S}}async function gm(a,{decimals:t},{calldata:e}){let{transaction:o}=e,{fee:s}=await hc({coinId:No,address:a}),i;if(o){let m=ou(o);i=eu(o,m)}let n=await ru([i]),c=Po(s,n);return{fee:Zt(c,t),feeInt:c}}async function Cm(a,{decimals:t},{calldata:e}){let o=await tu({address:a,transaction:e});return{fee:Zt(o,t),feeInt:o}}async function Im(a,{decimals:t},{calldata:e}){let o=await Xc({address:a,inputData:Bl(e),toAddr:Ml(e,a),value:Ul(e)});return{fee:Zt(o,t),feeInt:o}}async function Am(a,{decimals:t},{calldata:e}){let o=Jc.from(e.transactionBlock);o.setSenderIfNotSet(a);let s=o?.blockData?.gasConfig?.budget||"0";return{fee:Zt(s,t),feeInt:s}}async function _m(a,{decimals:t},{calldata:e}){let o=await Ol({transaction:e,fromAddress:a,value:"0"});return{fee:Zt(o,t),feeInt:o}}async function ym(a,{decimals:t},{calldata:e}){let o=await Pl(a,e);return{fee:Zt(o,t),feeInt:o}}async function Em(a,{decimals:t,coinId:e,chainId:o},s,{calldata:i}){let n=await ni({walletId:s,fromAddr:a,coinId:e,chainId:o,tx:i}),c=n.feeInfo.fee,d=n.feeInfo.error;return{fee:Zt(c,t),feeInt:c,error:d}}function Ql(a,t){let e=un(),{baseChain:o,baseCoinId:s}=qe(a),{baseCoin:i}=gc(s,!0),n=Ls(o),{symbol:c}=(0,ql.useSelector)(xo),d=ln(s)||0,[m,p]=(0,bt.useState)(0),[S,T]=(0,bt.useState)(0),[I,A]=(0,bt.useState)(0),[R,w]=(0,bt.useState)(!1),[q,K]=(0,bt.useState)(!1),nt=(0,bt.useMemo)(()=>{let mt=Ke(m,d);return{estimatedGasFeeInt:S,maxGasFeeInt:I,decimals:i?.decimals,currencyAmount:mt,currencySymbol:c,coinSymbol:i?.symbol,loading:R,error:q}},[i.decimals,i.symbol,c,q,S,I,R,d,a,t,t?.gasInfo?.isNetworkFeeLoading,t?.gasInfo?.isGasLimitLoading]);return zi(()=>{async function mt(){let V={fee:0,feeInt:0};w(!0),K(!1);try{o===Yr?V=await Tm(i,t):o===ke?V=await gm(n,i,t):o===gi?V=await Cm(n,i,t):o===Ci?V=await Am(n,i,t):o===Et?V=await Im(n,i,t):o===Ii?V=await _m(n,i,t):o===Oo?V=await ym(n,i,t):o===we&&(V=await Em(n,i,e,t)),p(V.fee),T(V.feeInt),A(V.maxFeeInt||V.feeInt)}catch{p(0),T(0)}finally{w(!!V.loading),K(V.error)}}mt()},[a,t]),nt}async function km({networkId:a,tx:t,hardwareExtParams:e,checkTxBeforePublish:o,currentWallet:s}){let i=t,{baseChain:n,chainId:c,baseCoinId:d}=qe(a);if(n===ke){let{account:m}=s,p=m[ke];return i.transaction=await Wl(t,p),{target:i}}if(n===Yr){if(bs(t?.gasInfo,"swap"))throw new Error(Rt("wallet_home_toast_network_error"));let p=i.value||i.amount||0,S=qe(a).baseCoinId;i={...i,...i.gasInfo};let T=await o({...i,userGasInfo:i.gasInfo,coinId:S,amount:p,baseCoinAmountUse:p}),{nonce:I,updateGasInfo:A={}}=T||{};i.nonce=I,i.maxFeePerGas=A.maxFeePerGas||i.maxFeePerGas,i.maxPriorityFeePerGas=A.maxPriorityFeePerGas||i.maxPriorityFeePerGas,i.gasPrice=A.gasPrice||i.gasPrice;let R=await pt().getSelectedWallet(),w=await pt().generateFormatedTxParams(a,i),{dispatch:q}=e||{};return q&&(await q(nn({txParams:w,walletId:R})),i.result=w.result,i.walletId=R),{target:i}}if(n===Ti){let m=await pt().getSelectedWallet(),p=await pt().generateFormatedTxParams(a,i),S=await an(p,p.address,n,m);return i.result=S,i.walletId=m,{target:i}}if(n===we){let{walletId:m,account:p}=s,S=p[we],{extParams:T}=await ni({walletId:m,fromAddr:S,coinId:d,chainId:c,tx:t});return{target:i,extParams:T}}return{target:i}}async function ai({networkId:a,tx:t,hardwareExtParams:e,checkTxBeforePublish:o,currentWallet:s}){if(!t)throw new Error("tx is required");let i=t;try{let{target:n,extParams:c}=await km({networkId:a,tx:t,hardwareExtParams:e,checkTxBeforePublish:o,currentWallet:s});return i=n,await pt().dexSignAndSubmitTransaction(a,i,c)}catch(n){throw n?.data?.originalError?(n.message=n?.data?.originalError?.error_message,n.code=Vl):n?.message===en?(n.message=Rt("wallet_extension_swap_error_hardware_not_support"),n.code=Vl):n.code=fm,n}finally{Jr()===zr&&pt().focusLastOkPopupWithCache()}}async function Kl(a,t){let e=t;try{return typeof t=="string"&&(e=JSON.parse(t)),await pt().dexSignTypedDataV4(a,e)}finally{Jr()===zr&&pt().focusLastOkPopupWithCache()}}var $l=a=>{let t=qi(a),e=os(a).some(m=>on(m.coinId)),o=e?ji(a):os(a),s;e?s=o.find(m=>m.realChainIdHex===t)||{}:s=o[0]||{};let i=Number(e?s.netWorkId:s.chainId),n=Gi(a),c=Qi(a);return{walletType:{isMNEMONIC:c[n].keyringIdentityType===ee.MNEMONIC,isPRIVATE:c[n].keyringIdentityType===ee.PRIVATE_KEY,isHARDWARE:c[n].keyringIdentityType===ee.HARDWARE,isMPC:c[n].keyringIdentityType===ee.MPC},chainId:i}};v.initSentry(di,li,process.env.APP_VERSION);v.setGlobal({HARDWALLETERROR:tn,getApiHostname:ki,getStaticHostname:wi,LocalStore:ui,interceptorHeaders:Li,urlConfig:Ni,FeeTypeEnum:Wi,netWorkIdToLocalType:new Proxy({},{get(a,t){return Qe({netWorkId:String(t)})?.localType}}),localTypeToBaseCoinId:new Proxy({},{get(a,t){return Qe({localType:t})?.coinId}}),KeyringIdentityTypeEnum:ee,RegisterLocalStatusEnum:Bi,hexToDecimal:rn,signAndSubmitTransaction:ai,signTypedDataV4:Kl,getGasPrice:ii,checkMPCStatus:vc,hooks:{useCoin:Hl,useUtxoListFn:Rc,useFeeDisplay:Ql,useRegisterStatus:xc,useGasReturnActivity:Cc,useSignInfo:yc,useUtxoEstimateFee:Nc,useUtxoCheckBeforePublishFn:Oc,useUtxoSignAndPublishTransactionFn:Pc},components:{EvmConfirm:$c,TronConfirm:vl,EthereumNetworkFee:bc,SupplyGas:_c,StarknetRegister:Gc,Affix:cn,InteractiveAddress:Vc,NetworkFeeEnter:Wc,ViewData:Kc,SectionWrap:Uc,ModuleWrap:Mc,TipMessage:qc,CoinSummary:Bc,UtxoNetworkFeePanel:jc,Mev:Qc,Layout:Mi,SwitchAddress:kl}});var wm=()=>{let a=(0,Hr.useHistory)(),{pathname:t}=(0,Hr.useLocation)(),e=(0,vt.useSelector)($i);return(0,Gr.useCallback)((o,s)=>{if(e&&s){a.replace(Ji);return}o()},[e,t])},SO=()=>{let a=(0,vt.useDispatch)(),t=(0,vt.useSelector)(xo),e=(0,vt.useSelector)(Ki),o=(0,vt.useSelector)(xi),s=Fc(),i=(0,vt.useSelector)(Hi),n=(0,vt.useSelector)(Fi),c=(0,vt.useSelector)($l),d=i.map(S=>{if(Zi(S.initialType)){S=(0,Qr.cloneDeep)(S);try{delete S.account[ke],delete S.account[Et]}catch{(0,Qr.noop)()}}return S}),m=wm(),p=Hc();return Xi(()=>{v.updateGlobal({signAndSubmitTransaction:async(S,T,I)=>await ai({networkId:S,tx:T,hardwareExtParams:I,checkTxBeforePublish:p,currentWallet:e})})}),Gr.default.createElement(El,{t:Rt,dispatch:a,onBack:m,currency:t,currentWallet:e,localeData:o,addressBookList:s,walletList:d,locale:n,walletInfo:c})};export{SO as default};

window.inOKXExtension = true;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=dex-N22ILUFA.js.map
